var ya=Object.defineProperty;var wa=(t,e,s)=>e in t?ya(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var Ve=(t,e,s)=>wa(t,typeof e!="symbol"?e+"":e,s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function ba(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const Sa={},Ea=()=>{},Ta=Object.assign,ka=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},Ca=Object.prototype.hasOwnProperty,Qs=(t,e)=>Ca.call(t,e),nt=Array.isArray,as=t=>ir(t)==="[object Map]",Aa=t=>ir(t)==="[object Set]",Fr=t=>typeof t=="function",Pa=t=>typeof t=="string",Ps=t=>typeof t=="symbol",xs=t=>t!==null&&typeof t=="object",xa=Object.prototype.toString,ir=t=>xa.call(t),Oa=t=>ir(t).slice(8,-1),Ra=t=>ir(t)==="[object Object]",un=t=>Pa(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,_t=(t,e)=>!Object.is(t,e),ja=(t,e,s,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:s})};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ve;class Ni{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ve,!e&&ve&&(this.index=(ve.scopes||(ve.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].pause();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].resume();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].resume()}}run(e){if(this._active){const s=ve;try{return ve=this,e()}finally{ve=s}}}on(){++this._on===1&&(this.prevScope=ve,ve=this)}off(){this._on>0&&--this._on===0&&(ve=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let s,r;for(s=0,r=this.effects.length;s<r;s++)this.effects[s].stop();for(this.effects.length=0,s=0,r=this.cleanups.length;s<r;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,r=this.scopes.length;s<r;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function Ia(t){return new Ni(t)}function Fi(){return ve}function $a(t,e=!1){ve&&ve.cleanups.push(t)}let ae;const br=new WeakSet;class qi{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ve&&ve.active&&ve.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,br.has(this)&&(br.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Bi(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Bn(this),Hi(this);const e=ae,s=Fe;ae=this,Fe=!0;try{return this.fn()}finally{Wi(this),ae=e,Fe=s,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)fn(e);this.deps=this.depsTail=void 0,Bn(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?br.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){qr(this)&&this.run()}get dirty(){return qr(this)}}let Mi=0,cs,ls;function Bi(t,e=!1){if(t.flags|=8,e){t.next=ls,ls=t;return}t.next=cs,cs=t}function hn(){Mi++}function dn(){if(--Mi>0)return;if(ls){let e=ls;for(ls=void 0;e;){const s=e.next;e.next=void 0,e.flags&=-9,e=s}}let t;for(;cs;){let e=cs;for(cs=void 0;e;){const s=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){t||(t=r)}e=s}}if(t)throw t}function Hi(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Wi(t){let e,s=t.depsTail,r=s;for(;r;){const n=r.prevDep;r.version===-1?(r===s&&(s=n),fn(r),Ua(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=n}t.deps=e,t.depsTail=s}function qr(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Ki(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Ki(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===bs)||(t.globalVersion=bs,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!qr(t))))return;t.flags|=2;const e=t.dep,s=ae,r=Fe;ae=t,Fe=!0;try{Hi(t);const n=t.fn(t._value);(e.version===0||_t(n,t._value))&&(t.flags|=128,t._value=n,e.version++)}catch(n){throw e.version++,n}finally{ae=s,Fe=r,Wi(t),t.flags&=-3}}function fn(t,e=!1){const{dep:s,prevSub:r,nextSub:n}=t;if(r&&(r.nextSub=n,t.prevSub=void 0),n&&(n.prevSub=r,t.nextSub=void 0),s.subs===t&&(s.subs=r,!r&&s.computed)){s.computed.flags&=-5;for(let i=s.computed.deps;i;i=i.nextDep)fn(i,!0)}!e&&!--s.sc&&s.map&&s.map.delete(s.key)}function Ua(t){const{prevDep:e,nextDep:s}=t;e&&(e.nextDep=s,t.prevDep=void 0),s&&(s.prevDep=e,t.nextDep=void 0)}let Fe=!0;const Vi=[];function ot(){Vi.push(Fe),Fe=!1}function at(){const t=Vi.pop();Fe=t===void 0?!0:t}function Bn(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const s=ae;ae=void 0;try{e()}finally{ae=s}}}let bs=0;class Da{constructor(e,s){this.sub=e,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class gn{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!ae||!Fe||ae===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==ae)s=this.activeLink=new Da(ae,this),ae.deps?(s.prevDep=ae.depsTail,ae.depsTail.nextDep=s,ae.depsTail=s):ae.deps=ae.depsTail=s,zi(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const r=s.nextDep;r.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=r),s.prevDep=ae.depsTail,s.nextDep=void 0,ae.depsTail.nextDep=s,ae.depsTail=s,ae.deps===s&&(ae.deps=r)}return s}trigger(e){this.version++,bs++,this.notify(e)}notify(e){hn();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{dn()}}}function zi(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)zi(r)}const s=t.dep.subs;s!==t&&(t.prevSub=s,s&&(s.nextSub=t)),t.dep.subs=t}}const Js=new WeakMap,Pt=Symbol(""),Mr=Symbol(""),Ss=Symbol("");function _e(t,e,s){if(Fe&&ae){let r=Js.get(t);r||Js.set(t,r=new Map);let n=r.get(s);n||(r.set(s,n=new gn),n.map=r,n.key=s),n.track()}}function rt(t,e,s,r,n,i){const o=Js.get(t);if(!o){bs++;return}const a=c=>{c&&c.trigger()};if(hn(),e==="clear")o.forEach(a);else{const c=nt(t),u=c&&un(s);if(c&&s==="length"){const l=Number(r);o.forEach((h,g)=>{(g==="length"||g===Ss||!Ps(g)&&g>=l)&&a(h)})}else switch((s!==void 0||o.has(void 0))&&a(o.get(s)),u&&a(o.get(Ss)),e){case"add":c?u&&a(o.get("length")):(a(o.get(Pt)),as(t)&&a(o.get(Mr)));break;case"delete":c||(a(o.get(Pt)),as(t)&&a(o.get(Mr)));break;case"set":as(t)&&a(o.get(Pt));break}}dn()}function La(t,e){const s=Js.get(t);return s&&s.get(e)}function It(t){const e=ee(t);return e===t?e:(_e(e,"iterate",Ss),qe(t)?e:e.map(we))}function pn(t){return _e(t=ee(t),"iterate",Ss),t}const Na={__proto__:null,[Symbol.iterator](){return Sr(this,Symbol.iterator,we)},concat(...t){return It(this).concat(...t.map(e=>nt(e)?It(e):e))},entries(){return Sr(this,"entries",t=>(t[1]=we(t[1]),t))},every(t,e){return Ye(this,"every",t,e,void 0,arguments)},filter(t,e){return Ye(this,"filter",t,e,s=>s.map(we),arguments)},find(t,e){return Ye(this,"find",t,e,we,arguments)},findIndex(t,e){return Ye(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Ye(this,"findLast",t,e,we,arguments)},findLastIndex(t,e){return Ye(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Ye(this,"forEach",t,e,void 0,arguments)},includes(...t){return Er(this,"includes",t)},indexOf(...t){return Er(this,"indexOf",t)},join(t){return It(this).join(t)},lastIndexOf(...t){return Er(this,"lastIndexOf",t)},map(t,e){return Ye(this,"map",t,e,void 0,arguments)},pop(){return es(this,"pop")},push(...t){return es(this,"push",t)},reduce(t,...e){return Hn(this,"reduce",t,e)},reduceRight(t,...e){return Hn(this,"reduceRight",t,e)},shift(){return es(this,"shift")},some(t,e){return Ye(this,"some",t,e,void 0,arguments)},splice(...t){return es(this,"splice",t)},toReversed(){return It(this).toReversed()},toSorted(t){return It(this).toSorted(t)},toSpliced(...t){return It(this).toSpliced(...t)},unshift(...t){return es(this,"unshift",t)},values(){return Sr(this,"values",we)}};function Sr(t,e,s){const r=pn(t),n=r[e]();return r!==t&&!qe(t)&&(n._next=n.next,n.next=()=>{const i=n._next();return i.value&&(i.value=s(i.value)),i}),n}const Fa=Array.prototype;function Ye(t,e,s,r,n,i){const o=pn(t),a=o!==t&&!qe(t),c=o[e];if(c!==Fa[e]){const h=c.apply(t,i);return a?we(h):h}let u=s;o!==t&&(a?u=function(h,g){return s.call(this,we(h),g,t)}:s.length>2&&(u=function(h,g){return s.call(this,h,g,t)}));const l=c.call(o,u,r);return a&&n?n(l):l}function Hn(t,e,s,r){const n=pn(t);let i=s;return n!==t&&(qe(t)?s.length>3&&(i=function(o,a,c){return s.call(this,o,a,c,t)}):i=function(o,a,c){return s.call(this,o,we(a),c,t)}),n[e](i,...r)}function Er(t,e,s){const r=ee(t);_e(r,"iterate",Ss);const n=r[e](...s);return(n===-1||n===!1)&&mn(s[0])?(s[0]=ee(s[0]),r[e](...s)):n}function es(t,e,s=[]){ot(),hn();const r=ee(t)[e].apply(t,s);return dn(),at(),r}const qa=ba("__proto__,__v_isRef,__isVue"),Gi=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Ps));function Ma(t){Ps(t)||(t=String(t));const e=ee(this);return _e(e,"has",t),e.hasOwnProperty(t)}class Qi{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,r){if(s==="__v_skip")return e.__v_skip;const n=this._isReadonly,i=this._isShallow;if(s==="__v_isReactive")return!n;if(s==="__v_isReadonly")return n;if(s==="__v_isShallow")return i;if(s==="__v_raw")return r===(n?i?Ya:Zi:i?Xi:Yi).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=nt(e);if(!n){let c;if(o&&(c=Na[s]))return c;if(s==="hasOwnProperty")return Ma}const a=Reflect.get(e,s,ue(e)?e:r);return(Ps(s)?Gi.has(s):qa(s))||(n||_e(e,"get",s),i)?a:ue(a)?o&&un(s)?a:a.value:xs(a)?n?eo(a):or(a):a}}class Ji extends Qi{constructor(e=!1){super(!1,e)}set(e,s,r,n){let i=e[s];if(!this._isShallow){const c=Rt(i);if(!qe(r)&&!Rt(r)&&(i=ee(i),r=ee(r)),!nt(e)&&ue(i)&&!ue(r))return c?!1:(i.value=r,!0)}const o=nt(e)&&un(s)?Number(s)<e.length:Qs(e,s),a=Reflect.set(e,s,r,ue(e)?e:n);return e===ee(n)&&(o?_t(r,i)&&rt(e,"set",s,r):rt(e,"add",s,r)),a}deleteProperty(e,s){const r=Qs(e,s);e[s];const n=Reflect.deleteProperty(e,s);return n&&r&&rt(e,"delete",s,void 0),n}has(e,s){const r=Reflect.has(e,s);return(!Ps(s)||!Gi.has(s))&&_e(e,"has",s),r}ownKeys(e){return _e(e,"iterate",nt(e)?"length":Pt),Reflect.ownKeys(e)}}class Ba extends Qi{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const Ha=new Ji,Wa=new Ba,Ka=new Ji(!0);const Br=t=>t,Ns=t=>Reflect.getPrototypeOf(t);function Va(t,e,s){return function(...r){const n=this.__v_raw,i=ee(n),o=as(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=n[t](...r),l=s?Br:e?Hr:we;return!e&&_e(i,"iterate",c?Mr:Pt),{next(){const{value:h,done:g}=u.next();return g?{value:h,done:g}:{value:a?[l(h[0]),l(h[1])]:l(h),done:g}},[Symbol.iterator](){return this}}}}function Fs(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function za(t,e){const s={get(n){const i=this.__v_raw,o=ee(i),a=ee(n);t||(_t(n,a)&&_e(o,"get",n),_e(o,"get",a));const{has:c}=Ns(o),u=e?Br:t?Hr:we;if(c.call(o,n))return u(i.get(n));if(c.call(o,a))return u(i.get(a));i!==o&&i.get(n)},get size(){const n=this.__v_raw;return!t&&_e(ee(n),"iterate",Pt),Reflect.get(n,"size",n)},has(n){const i=this.__v_raw,o=ee(i),a=ee(n);return t||(_t(n,a)&&_e(o,"has",n),_e(o,"has",a)),n===a?i.has(n):i.has(n)||i.has(a)},forEach(n,i){const o=this,a=o.__v_raw,c=ee(a),u=e?Br:t?Hr:we;return!t&&_e(c,"iterate",Pt),a.forEach((l,h)=>n.call(i,u(l),u(h),o))}};return Ta(s,t?{add:Fs("add"),set:Fs("set"),delete:Fs("delete"),clear:Fs("clear")}:{add(n){!e&&!qe(n)&&!Rt(n)&&(n=ee(n));const i=ee(this);return Ns(i).has.call(i,n)||(i.add(n),rt(i,"add",n,n)),this},set(n,i){!e&&!qe(i)&&!Rt(i)&&(i=ee(i));const o=ee(this),{has:a,get:c}=Ns(o);let u=a.call(o,n);u||(n=ee(n),u=a.call(o,n));const l=c.call(o,n);return o.set(n,i),u?_t(i,l)&&rt(o,"set",n,i):rt(o,"add",n,i),this},delete(n){const i=ee(this),{has:o,get:a}=Ns(i);let c=o.call(i,n);c||(n=ee(n),c=o.call(i,n)),a&&a.call(i,n);const u=i.delete(n);return c&&rt(i,"delete",n,void 0),u},clear(){const n=ee(this),i=n.size!==0,o=n.clear();return i&&rt(n,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(n=>{s[n]=Va(n,t,e)}),s}function vn(t,e){const s=za(t,e);return(r,n,i)=>n==="__v_isReactive"?!t:n==="__v_isReadonly"?t:n==="__v_raw"?r:Reflect.get(Qs(s,n)&&n in r?s:r,n,i)}const Ga={get:vn(!1,!1)},Qa={get:vn(!1,!0)},Ja={get:vn(!0,!1)};const Yi=new WeakMap,Xi=new WeakMap,Zi=new WeakMap,Ya=new WeakMap;function Xa(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Za(t){return t.__v_skip||!Object.isExtensible(t)?0:Xa(Oa(t))}function or(t){return Rt(t)?t:_n(t,!1,Ha,Ga,Yi)}function ec(t){return _n(t,!1,Ka,Qa,Xi)}function eo(t){return _n(t,!0,Wa,Ja,Zi)}function _n(t,e,s,r,n){if(!xs(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=Za(t);if(i===0)return t;const o=n.get(t);if(o)return o;const a=new Proxy(t,i===2?r:s);return n.set(t,a),a}function xt(t){return Rt(t)?xt(t.__v_raw):!!(t&&t.__v_isReactive)}function Rt(t){return!!(t&&t.__v_isReadonly)}function qe(t){return!!(t&&t.__v_isShallow)}function mn(t){return t?!!t.__v_raw:!1}function ee(t){const e=t&&t.__v_raw;return e?ee(e):t}function to(t){return!Qs(t,"__v_skip")&&Object.isExtensible(t)&&ja(t,"__v_skip",!0),t}const we=t=>xs(t)?or(t):t,Hr=t=>xs(t)?eo(t):t;function ue(t){return t?t.__v_isRef===!0:!1}function G(t){return tc(t,!1)}function tc(t,e){return ue(t)?t:new sc(t,e)}class sc{constructor(e,s){this.dep=new gn,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?e:ee(e),this._value=s?e:we(e),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(e){const s=this._rawValue,r=this.__v_isShallow||qe(e)||Rt(e);e=r?e:ee(e),_t(e,s)&&(this._rawValue=e,this._value=r?e:we(e),this.dep.trigger())}}function rc(t){return ue(t)?t.value:t}const nc={get:(t,e,s)=>e==="__v_raw"?t:rc(Reflect.get(t,e,s)),set:(t,e,s,r)=>{const n=t[e];return ue(n)&&!ue(s)?(n.value=s,!0):Reflect.set(t,e,s,r)}};function so(t){return xt(t)?t:new Proxy(t,nc)}function ic(t){const e=nt(t)?new Array(t.length):{};for(const s in t)e[s]=ac(t,s);return e}class oc{constructor(e,s,r){this._object=e,this._key=s,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return La(ee(this._object),this._key)}}function ac(t,e,s){const r=t[e];return ue(r)?r:new oc(t,e,s)}class cc{constructor(e,s,r){this.fn=e,this.setter=s,this._value=void 0,this.dep=new gn(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=bs-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&ae!==this)return Bi(this,!0),!0}get value(){const e=this.dep.track();return Ki(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function lc(t,e,s=!1){let r,n;return Fr(t)?r=t:(r=t.get,n=t.set),new cc(r,n,s)}const qs={},Ys=new WeakMap;let kt;function uc(t,e=!1,s=kt){if(s){let r=Ys.get(s);r||Ys.set(s,r=[]),r.push(t)}}function hc(t,e,s=Sa){const{immediate:r,deep:n,once:i,scheduler:o,augmentJob:a,call:c}=s,u=C=>n?C:qe(C)||n===!1||n===0?pt(C,1):pt(C);let l,h,g,p,S=!1,w=!1;if(ue(t)?(h=()=>t.value,S=qe(t)):xt(t)?(h=()=>u(t),S=!0):nt(t)?(w=!0,S=t.some(C=>xt(C)||qe(C)),h=()=>t.map(C=>{if(ue(C))return C.value;if(xt(C))return u(C);if(Fr(C))return c?c(C,2):C()})):Fr(t)?e?h=c?()=>c(t,2):t:h=()=>{if(g){ot();try{g()}finally{at()}}const C=kt;kt=l;try{return c?c(t,3,[p]):t(p)}finally{kt=C}}:h=Ea,e&&n){const C=h,N=n===!0?1/0:n;h=()=>pt(C(),N)}const x=Fi(),O=()=>{l.stop(),x&&x.active&&ka(x.effects,l)};if(i&&e){const C=e;e=(...N)=>{C(...N),O()}}let P=w?new Array(t.length).fill(qs):qs;const v=C=>{if(!(!(l.flags&1)||!l.dirty&&!C))if(e){const N=l.run();if(n||S||(w?N.some((W,K)=>_t(W,P[K])):_t(N,P))){g&&g();const W=kt;kt=l;try{const K=[N,P===qs?void 0:w&&P[0]===qs?[]:P,p];P=N,c?c(e,3,K):e(...K)}finally{kt=W}}}else l.run()};return a&&a(v),l=new qi(h),l.scheduler=o?()=>o(v,!1):v,p=C=>uc(C,!1,l),g=l.onStop=()=>{const C=Ys.get(l);if(C){if(c)c(C,4);else for(const N of C)N();Ys.delete(l)}},e?r?v(!0):P=l.run():o?o(v.bind(null,!0),!0):l.run(),O.pause=l.pause.bind(l),O.resume=l.resume.bind(l),O.stop=O,O}function pt(t,e=1/0,s){if(e<=0||!xs(t)||t.__v_skip||(s=s||new Set,s.has(t)))return t;if(s.add(t),e--,ue(t))pt(t.value,e,s);else if(nt(t))for(let r=0;r<t.length;r++)pt(t[r],e,s);else if(Aa(t)||as(t))t.forEach(r=>{pt(r,e,s)});else if(Ra(t)){for(const r in t)pt(t[r],e,s);for(const r of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,r)&&pt(t[r],e,s)}return t}/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function dc(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const le={},Wt=[],it=()=>{},fc=()=>!1,yn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),ro=t=>t.startsWith("onUpdate:"),Pe=Object.assign,no=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},gc=Object.prototype.hasOwnProperty,ce=(t,e)=>gc.call(t,e),te=Array.isArray,J=t=>typeof t=="function",Ie=t=>typeof t=="string",Se=t=>t!==null&&typeof t=="object",io=t=>(Se(t)||J(t))&&J(t.then)&&J(t.catch),us=dc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ar=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},pc=/-(\w)/g,Me=ar(t=>t.replace(pc,(e,s)=>s?s.toUpperCase():"")),vc=/\B([A-Z])/g,Os=ar(t=>t.replace(vc,"-$1").toLowerCase()),wn=ar(t=>t.charAt(0).toUpperCase()+t.slice(1)),Tr=ar(t=>t?`on${wn(t)}`:""),kr=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},Wn=(t,e,s,r=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:r,value:s})},_c=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Kn;const cr=()=>Kn||(Kn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function bn(t){if(te(t)){const e={};for(let s=0;s<t.length;s++){const r=t[s],n=Ie(r)?bc(r):bn(r);if(n)for(const i in n)e[i]=n[i]}return e}else if(Ie(t)||Se(t))return t}const mc=/;(?![^(]*\))/g,yc=/:([^]+)/,wc=/\/\*[^]*?\*\//g;function bc(t){const e={};return t.replace(wc,"").split(mc).forEach(s=>{if(s){const r=s.split(yc);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Sn(t){let e="";if(Ie(t))e=t;else if(te(t))for(let s=0;s<t.length;s++){const r=Sn(t[s]);r&&(e+=r+" ")}else if(Se(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Rs(t,e,s,r){try{return r?t(...r):t()}catch(n){lr(n,e,s)}}function Je(t,e,s,r){if(J(t)){const n=Rs(t,e,s,r);return n&&io(n)&&n.catch(i=>{lr(i,e,s)}),n}if(te(t)){const n=[];for(let i=0;i<t.length;i++)n.push(Je(t[i],e,s,r));return n}}function lr(t,e,s,r=!0){const n=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||le;if(e){let a=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${s}`;for(;a;){const l=a.ec;if(l){for(let h=0;h<l.length;h++)if(l[h](t,c,u)===!1)return}a=a.parent}if(i){ot(),Rs(i,null,10,[t,c,u]),at();return}}Sc(t,s,n,r,o)}function Sc(t,e,s,r=!0,n=!1){if(n)throw t;console.error(t)}const be=[];let Ge=-1;const Kt=[];let ft=null,Mt=0;const oo=Promise.resolve();let Xs=null;function ao(t){const e=Xs||oo;return t?e.then(this?t.bind(this):t):e}function Ec(t){let e=Ge+1,s=be.length;for(;e<s;){const r=e+s>>>1,n=be[r],i=Es(n);i<t||i===t&&n.flags&2?e=r+1:s=r}return e}function En(t){if(!(t.flags&1)){const e=Es(t),s=be[be.length-1];!s||!(t.flags&2)&&e>=Es(s)?be.push(t):be.splice(Ec(e),0,t),t.flags|=1,co()}}function co(){Xs||(Xs=oo.then(uo))}function Tc(t){te(t)?Kt.push(...t):ft&&t.id===-1?ft.splice(Mt+1,0,t):t.flags&1||(Kt.push(t),t.flags|=1),co()}function Vn(t,e,s=Ge+1){for(;s<be.length;s++){const r=be[s];if(r&&r.flags&2){if(t&&r.id!==t.uid)continue;be.splice(s,1),s--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function lo(t){if(Kt.length){const e=[...new Set(Kt)].sort((s,r)=>Es(s)-Es(r));if(Kt.length=0,ft){ft.push(...e);return}for(ft=e,Mt=0;Mt<ft.length;Mt++){const s=ft[Mt];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}ft=null,Mt=0}}const Es=t=>t.id==null?t.flags&2?-1:1/0:t.id;function uo(t){try{for(Ge=0;Ge<be.length;Ge++){const e=be[Ge];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Rs(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ge<be.length;Ge++){const e=be[Ge];e&&(e.flags&=-2)}Ge=-1,be.length=0,lo(),Xs=null,(be.length||Kt.length)&&uo()}}let Ne=null,ho=null;function Zs(t){const e=Ne;return Ne=t,ho=t&&t.type.__scopeId||null,e}function kc(t,e=Ne,s){if(!e||t._n)return t;const r=(...n)=>{r._d&&si(-1);const i=Zs(e);let o;try{o=t(...n)}finally{Zs(i),r._d&&si(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function bt(t,e,s,r){const n=t.dirs,i=e&&e.dirs;for(let o=0;o<n.length;o++){const a=n[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(ot(),Je(c,s,8,[t.el,a,t,e]),at())}}const Cc=Symbol("_vte"),Ac=t=>t.__isTeleport;function Tn(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Tn(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}/*! #__NO_SIDE_EFFECTS__ */function Pc(t,e){return J(t)?Pe({name:t.name},e,{setup:t}):t}function fo(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function hs(t,e,s,r,n=!1){if(te(t)){t.forEach((S,w)=>hs(S,e&&(te(e)?e[w]:e),s,r,n));return}if(ds(r)&&!n){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&hs(t,e,s,r.component.subTree);return}const i=r.shapeFlag&4?xn(r.component):r.el,o=n?null:i,{i:a,r:c}=t,u=e&&e.r,l=a.refs===le?a.refs={}:a.refs,h=a.setupState,g=ee(h),p=h===le?()=>!1:S=>ce(g,S);if(u!=null&&u!==c&&(Ie(u)?(l[u]=null,p(u)&&(h[u]=null)):ue(u)&&(u.value=null)),J(c))Rs(c,a,12,[o,l]);else{const S=Ie(c),w=ue(c);if(S||w){const x=()=>{if(t.f){const O=S?p(c)?h[c]:l[c]:c.value;n?te(O)&&no(O,i):te(O)?O.includes(i)||O.push(i):S?(l[c]=[i],p(c)&&(h[c]=l[c])):(c.value=[i],t.k&&(l[t.k]=c.value))}else S?(l[c]=o,p(c)&&(h[c]=o)):w&&(c.value=o,t.k&&(l[t.k]=o))};o?(x.id=-1,Oe(x,s)):x()}}}cr().requestIdleCallback;cr().cancelIdleCallback;const ds=t=>!!t.type.__asyncLoader,go=t=>t.type.__isKeepAlive;function xc(t,e){po(t,"a",e)}function Oc(t,e){po(t,"da",e)}function po(t,e,s=me){const r=t.__wdc||(t.__wdc=()=>{let n=s;for(;n;){if(n.isDeactivated)return;n=n.parent}return t()});if(ur(e,r,s),s){let n=s.parent;for(;n&&n.parent;)go(n.parent.vnode)&&Rc(r,e,s,n),n=n.parent}}function Rc(t,e,s,r){const n=ur(e,t,r,!0);kn(()=>{no(r[e],n)},s)}function ur(t,e,s=me,r=!1){if(s){const n=s[t]||(s[t]=[]),i=e.__weh||(e.__weh=(...o)=>{ot();const a=js(s),c=Je(e,s,t,o);return a(),at(),c});return r?n.unshift(i):n.push(i),i}}const ct=t=>(e,s=me)=>{(!ks||t==="sp")&&ur(t,(...r)=>e(...r),s)},jc=ct("bm"),vo=ct("m"),Ic=ct("bu"),$c=ct("u"),Uc=ct("bum"),kn=ct("um"),Dc=ct("sp"),Lc=ct("rtg"),Nc=ct("rtc");function Fc(t,e=me){ur("ec",t,e)}const qc="components";function Mc(t,e){return Hc(qc,t,!0,e)||t}const Bc=Symbol.for("v-ndc");function Hc(t,e,s=!0,r=!1){const n=Ne||me;if(n){const i=n.type;{const a=Ul(i,!1);if(a&&(a===e||a===Me(e)||a===wn(Me(e))))return i}const o=zn(n[t]||i[t],e)||zn(n.appContext[t],e);return!o&&r?i:o}}function zn(t,e){return t&&(t[e]||t[Me(e)]||t[wn(Me(e))])}const Wr=t=>t?No(t)?xn(t):Wr(t.parent):null,fs=Pe(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Wr(t.parent),$root:t=>Wr(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>mo(t),$forceUpdate:t=>t.f||(t.f=()=>{En(t.update)}),$nextTick:t=>t.n||(t.n=ao.bind(t.proxy)),$watch:t=>dl.bind(t)}),Cr=(t,e)=>t!==le&&!t.__isScriptSetup&&ce(t,e),Wc={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:r,data:n,props:i,accessCache:o,type:a,appContext:c}=t;let u;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return r[e];case 2:return n[e];case 4:return s[e];case 3:return i[e]}else{if(Cr(r,e))return o[e]=1,r[e];if(n!==le&&ce(n,e))return o[e]=2,n[e];if((u=t.propsOptions[0])&&ce(u,e))return o[e]=3,i[e];if(s!==le&&ce(s,e))return o[e]=4,s[e];Kr&&(o[e]=0)}}const l=fs[e];let h,g;if(l)return e==="$attrs"&&_e(t.attrs,"get",""),l(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(s!==le&&ce(s,e))return o[e]=4,s[e];if(g=c.config.globalProperties,ce(g,e))return g[e]},set({_:t},e,s){const{data:r,setupState:n,ctx:i}=t;return Cr(n,e)?(n[e]=s,!0):r!==le&&ce(r,e)?(r[e]=s,!0):ce(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:r,appContext:n,propsOptions:i}},o){let a;return!!s[o]||t!==le&&ce(t,o)||Cr(e,o)||(a=i[0])&&ce(a,o)||ce(r,o)||ce(fs,o)||ce(n.config.globalProperties,o)},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:ce(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};function Gn(t){return te(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}let Kr=!0;function Kc(t){const e=mo(t),s=t.proxy,r=t.ctx;Kr=!1,e.beforeCreate&&Qn(e.beforeCreate,t,"bc");const{data:n,computed:i,methods:o,watch:a,provide:c,inject:u,created:l,beforeMount:h,mounted:g,beforeUpdate:p,updated:S,activated:w,deactivated:x,beforeDestroy:O,beforeUnmount:P,destroyed:v,unmounted:C,render:N,renderTracked:W,renderTriggered:K,errorCaptured:m,serverPrefetch:A,expose:I,inheritAttrs:R,components:y,directives:F,filters:L}=e;if(u&&Vc(u,r,null),o)for(const H in o){const Z=o[H];J(Z)&&(r[H]=Z.bind(s))}if(n){const H=n.call(s,s);Se(H)&&(t.data=or(H))}if(Kr=!0,i)for(const H in i){const Z=i[H],Ue=J(Z)?Z.bind(s,s):J(Z.get)?Z.get.bind(s,s):it,lt=!J(Z)&&J(Z.set)?Z.set.bind(s):it,wt=pe({get:Ue,set:lt});Object.defineProperty(r,H,{enumerable:!0,configurable:!0,get:()=>wt.value,set:Be=>wt.value=Be})}if(a)for(const H in a)_o(a[H],r,s,H);if(c){const H=J(c)?c.call(s):c;Reflect.ownKeys(H).forEach(Z=>{Xc(Z,H[Z])})}l&&Qn(l,t,"c");function M(H,Z){te(Z)?Z.forEach(Ue=>H(Ue.bind(s))):Z&&H(Z.bind(s))}if(M(jc,h),M(vo,g),M(Ic,p),M($c,S),M(xc,w),M(Oc,x),M(Fc,m),M(Nc,W),M(Lc,K),M(Uc,P),M(kn,C),M(Dc,A),te(I))if(I.length){const H=t.exposed||(t.exposed={});I.forEach(Z=>{Object.defineProperty(H,Z,{get:()=>s[Z],set:Ue=>s[Z]=Ue,enumerable:!0})})}else t.exposed||(t.exposed={});N&&t.render===it&&(t.render=N),R!=null&&(t.inheritAttrs=R),y&&(t.components=y),F&&(t.directives=F),A&&fo(t)}function Vc(t,e,s=it){te(t)&&(t=Vr(t));for(const r in t){const n=t[r];let i;Se(n)?"default"in n?i=gs(n.from||r,n.default,!0):i=gs(n.from||r):i=gs(n),ue(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function Qn(t,e,s){Je(te(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,s)}function _o(t,e,s,r){let n=r.includes(".")?Ro(s,r):()=>s[r];if(Ie(t)){const i=e[t];J(i)&&Vs(n,i)}else if(J(t))Vs(n,t.bind(s));else if(Se(t))if(te(t))t.forEach(i=>_o(i,e,s,r));else{const i=J(t.handler)?t.handler.bind(s):e[t.handler];J(i)&&Vs(n,i,t)}}function mo(t){const e=t.type,{mixins:s,extends:r}=e,{mixins:n,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!n.length&&!s&&!r?c=e:(c={},n.length&&n.forEach(u=>er(c,u,o,!0)),er(c,e,o)),Se(e)&&i.set(e,c),c}function er(t,e,s,r=!1){const{mixins:n,extends:i}=e;i&&er(t,i,s,!0),n&&n.forEach(o=>er(t,o,s,!0));for(const o in e)if(!(r&&o==="expose")){const a=zc[o]||s&&s[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const zc={data:Jn,props:Yn,emits:Yn,methods:is,computed:is,beforeCreate:ye,created:ye,beforeMount:ye,mounted:ye,beforeUpdate:ye,updated:ye,beforeDestroy:ye,beforeUnmount:ye,destroyed:ye,unmounted:ye,activated:ye,deactivated:ye,errorCaptured:ye,serverPrefetch:ye,components:is,directives:is,watch:Qc,provide:Jn,inject:Gc};function Jn(t,e){return e?t?function(){return Pe(J(t)?t.call(this,this):t,J(e)?e.call(this,this):e)}:e:t}function Gc(t,e){return is(Vr(t),Vr(e))}function Vr(t){if(te(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function ye(t,e){return t?[...new Set([].concat(t,e))]:e}function is(t,e){return t?Pe(Object.create(null),t,e):e}function Yn(t,e){return t?te(t)&&te(e)?[...new Set([...t,...e])]:Pe(Object.create(null),Gn(t),Gn(e??{})):e}function Qc(t,e){if(!t)return e;if(!e)return t;const s=Pe(Object.create(null),t);for(const r in e)s[r]=ye(t[r],e[r]);return s}function yo(){return{app:null,config:{isNativeTag:fc,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Jc=0;function Yc(t,e){return function(r,n=null){J(r)||(r=Pe({},r)),n!=null&&!Se(n)&&(n=null);const i=yo(),o=new WeakSet,a=[];let c=!1;const u=i.app={_uid:Jc++,_component:r,_props:n,_container:null,_context:i,_instance:null,version:Ll,get config(){return i.config},set config(l){},use(l,...h){return o.has(l)||(l&&J(l.install)?(o.add(l),l.install(u,...h)):J(l)&&(o.add(l),l(u,...h))),u},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),u},component(l,h){return h?(i.components[l]=h,u):i.components[l]},directive(l,h){return h?(i.directives[l]=h,u):i.directives[l]},mount(l,h,g){if(!c){const p=u._ceVNode||mt(r,n);return p.appContext=i,g===!0?g="svg":g===!1&&(g=void 0),t(p,l,g),c=!0,u._container=l,l.__vue_app__=u,xn(p.component)}},onUnmount(l){a.push(l)},unmount(){c&&(Je(a,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(l,h){return i.provides[l]=h,u},runWithContext(l){const h=Ot;Ot=u;try{return l()}finally{Ot=h}}};return u}}let Ot=null;function Xc(t,e){if(me){let s=me.provides;const r=me.parent&&me.parent.provides;r===s&&(s=me.provides=Object.create(r)),s[t]=e}}function gs(t,e,s=!1){const r=Lo();if(r||Ot){let n=Ot?Ot._context.provides:r?r.parent==null||r.ce?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(n&&t in n)return n[t];if(arguments.length>1)return s&&J(e)?e.call(r&&r.proxy):e}}function Zc(){return!!(Lo()||Ot)}const wo={},bo=()=>Object.create(wo),So=t=>Object.getPrototypeOf(t)===wo;function el(t,e,s,r=!1){const n={},i=bo();t.propsDefaults=Object.create(null),Eo(t,e,n,i);for(const o in t.propsOptions[0])o in n||(n[o]=void 0);s?t.props=r?n:ec(n):t.type.props?t.props=n:t.props=i,t.attrs=i}function tl(t,e,s,r){const{props:n,attrs:i,vnode:{patchFlag:o}}=t,a=ee(n),[c]=t.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const l=t.vnode.dynamicProps;for(let h=0;h<l.length;h++){let g=l[h];if(hr(t.emitsOptions,g))continue;const p=e[g];if(c)if(ce(i,g))p!==i[g]&&(i[g]=p,u=!0);else{const S=Me(g);n[S]=zr(c,a,S,p,t,!1)}else p!==i[g]&&(i[g]=p,u=!0)}}}else{Eo(t,e,n,i)&&(u=!0);let l;for(const h in a)(!e||!ce(e,h)&&((l=Os(h))===h||!ce(e,l)))&&(c?s&&(s[h]!==void 0||s[l]!==void 0)&&(n[h]=zr(c,a,h,void 0,t,!0)):delete n[h]);if(i!==a)for(const h in i)(!e||!ce(e,h))&&(delete i[h],u=!0)}u&&rt(t.attrs,"set","")}function Eo(t,e,s,r){const[n,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(us(c))continue;const u=e[c];let l;n&&ce(n,l=Me(c))?!i||!i.includes(l)?s[l]=u:(a||(a={}))[l]=u:hr(t.emitsOptions,c)||(!(c in r)||u!==r[c])&&(r[c]=u,o=!0)}if(i){const c=ee(s),u=a||le;for(let l=0;l<i.length;l++){const h=i[l];s[h]=zr(n,c,h,u[h],t,!ce(u,h))}}return o}function zr(t,e,s,r,n,i){const o=t[s];if(o!=null){const a=ce(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&J(c)){const{propsDefaults:u}=n;if(s in u)r=u[s];else{const l=js(n);r=u[s]=c.call(null,e),l()}}else r=c;n.ce&&n.ce._setProp(s,r)}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Os(s))&&(r=!0))}return r}const sl=new WeakMap;function To(t,e,s=!1){const r=s?sl:e.propsCache,n=r.get(t);if(n)return n;const i=t.props,o={},a=[];let c=!1;if(!J(t)){const l=h=>{c=!0;const[g,p]=To(h,e,!0);Pe(o,g),p&&a.push(...p)};!s&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}if(!i&&!c)return Se(t)&&r.set(t,Wt),Wt;if(te(i))for(let l=0;l<i.length;l++){const h=Me(i[l]);Xn(h)&&(o[h]=le)}else if(i)for(const l in i){const h=Me(l);if(Xn(h)){const g=i[l],p=o[h]=te(g)||J(g)?{type:g}:Pe({},g),S=p.type;let w=!1,x=!0;if(te(S))for(let O=0;O<S.length;++O){const P=S[O],v=J(P)&&P.name;if(v==="Boolean"){w=!0;break}else v==="String"&&(x=!1)}else w=J(S)&&S.name==="Boolean";p[0]=w,p[1]=x,(w||ce(p,"default"))&&a.push(h)}}const u=[o,a];return Se(t)&&r.set(t,u),u}function Xn(t){return t[0]!=="$"&&!us(t)}const Cn=t=>t==="_"||t==="__"||t==="_ctx"||t==="$stable",An=t=>te(t)?t.map(Qe):[Qe(t)],rl=(t,e,s)=>{if(e._n)return e;const r=kc((...n)=>An(e(...n)),s);return r._c=!1,r},ko=(t,e,s)=>{const r=t._ctx;for(const n in t){if(Cn(n))continue;const i=t[n];if(J(i))e[n]=rl(n,i,r);else if(i!=null){const o=An(i);e[n]=()=>o}}},Co=(t,e)=>{const s=An(e);t.slots.default=()=>s},Ao=(t,e,s)=>{for(const r in e)(s||!Cn(r))&&(t[r]=e[r])},nl=(t,e,s)=>{const r=t.slots=bo();if(t.vnode.shapeFlag&32){const n=e.__;n&&Wn(r,"__",n,!0);const i=e._;i?(Ao(r,e,s),s&&Wn(r,"_",i,!0)):ko(e,r)}else e&&Co(t,e)},il=(t,e,s)=>{const{vnode:r,slots:n}=t;let i=!0,o=le;if(r.shapeFlag&32){const a=e._;a?s&&a===1?i=!1:Ao(n,e,s):(i=!e.$stable,ko(e,n)),o=e}else e&&(Co(t,e),o={default:1});if(i)for(const a in n)!Cn(a)&&o[a]==null&&delete n[a]},Oe=yl;function ol(t){return al(t)}function al(t,e){const s=cr();s.__VUE__=!0;const{insert:r,remove:n,patchProp:i,createElement:o,createText:a,createComment:c,setText:u,setElementText:l,parentNode:h,nextSibling:g,setScopeId:p=it,insertStaticContent:S}=t,w=(d,f,_,T=null,b=null,E=null,U=void 0,$=null,j=!!f.dynamicChildren)=>{if(d===f)return;d&&!ts(d,f)&&(T=Ls(d),Be(d,b,E,!0),d=null),f.patchFlag===-2&&(j=!1,f.dynamicChildren=null);const{type:k,ref:B,shapeFlag:D}=f;switch(k){case dr:x(d,f,_,T);break;case Vt:O(d,f,_,T);break;case Pr:d==null&&P(f,_,T,U);break;case st:y(d,f,_,T,b,E,U,$,j);break;default:D&1?N(d,f,_,T,b,E,U,$,j):D&6?F(d,f,_,T,b,E,U,$,j):(D&64||D&128)&&k.process(d,f,_,T,b,E,U,$,j,Xt)}B!=null&&b?hs(B,d&&d.ref,E,f||d,!f):B==null&&d&&d.ref!=null&&hs(d.ref,null,E,d,!0)},x=(d,f,_,T)=>{if(d==null)r(f.el=a(f.children),_,T);else{const b=f.el=d.el;f.children!==d.children&&u(b,f.children)}},O=(d,f,_,T)=>{d==null?r(f.el=c(f.children||""),_,T):f.el=d.el},P=(d,f,_,T)=>{[d.el,d.anchor]=S(d.children,f,_,T,d.el,d.anchor)},v=({el:d,anchor:f},_,T)=>{let b;for(;d&&d!==f;)b=g(d),r(d,_,T),d=b;r(f,_,T)},C=({el:d,anchor:f})=>{let _;for(;d&&d!==f;)_=g(d),n(d),d=_;n(f)},N=(d,f,_,T,b,E,U,$,j)=>{f.type==="svg"?U="svg":f.type==="math"&&(U="mathml"),d==null?W(f,_,T,b,E,U,$,j):A(d,f,b,E,U,$,j)},W=(d,f,_,T,b,E,U,$)=>{let j,k;const{props:B,shapeFlag:D,transition:q,dirs:V}=d;if(j=d.el=o(d.type,E,B&&B.is,B),D&8?l(j,d.children):D&16&&m(d.children,j,null,T,b,Ar(d,E),U,$),V&&bt(d,null,T,"created"),K(j,d,d.scopeId,U,T),B){for(const ie in B)ie!=="value"&&!us(ie)&&i(j,ie,null,B[ie],E,T);"value"in B&&i(j,"value",null,B.value,E),(k=B.onVnodeBeforeMount)&&ze(k,T,d)}V&&bt(d,null,T,"beforeMount");const X=cl(b,q);X&&q.beforeEnter(j),r(j,f,_),((k=B&&B.onVnodeMounted)||X||V)&&Oe(()=>{k&&ze(k,T,d),X&&q.enter(j),V&&bt(d,null,T,"mounted")},b)},K=(d,f,_,T,b)=>{if(_&&p(d,_),T)for(let E=0;E<T.length;E++)p(d,T[E]);if(b){let E=b.subTree;if(f===E||Io(E.type)&&(E.ssContent===f||E.ssFallback===f)){const U=b.vnode;K(d,U,U.scopeId,U.slotScopeIds,b.parent)}}},m=(d,f,_,T,b,E,U,$,j=0)=>{for(let k=j;k<d.length;k++){const B=d[k]=$?gt(d[k]):Qe(d[k]);w(null,B,f,_,T,b,E,U,$)}},A=(d,f,_,T,b,E,U)=>{const $=f.el=d.el;let{patchFlag:j,dynamicChildren:k,dirs:B}=f;j|=d.patchFlag&16;const D=d.props||le,q=f.props||le;let V;if(_&&St(_,!1),(V=q.onVnodeBeforeUpdate)&&ze(V,_,f,d),B&&bt(f,d,_,"beforeUpdate"),_&&St(_,!0),(D.innerHTML&&q.innerHTML==null||D.textContent&&q.textContent==null)&&l($,""),k?I(d.dynamicChildren,k,$,_,T,Ar(f,b),E):U||Z(d,f,$,null,_,T,Ar(f,b),E,!1),j>0){if(j&16)R($,D,q,_,b);else if(j&2&&D.class!==q.class&&i($,"class",null,q.class,b),j&4&&i($,"style",D.style,q.style,b),j&8){const X=f.dynamicProps;for(let ie=0;ie<X.length;ie++){const se=X[ie],Ee=D[se],Te=q[se];(Te!==Ee||se==="value")&&i($,se,Ee,Te,b,_)}}j&1&&d.children!==f.children&&l($,f.children)}else!U&&k==null&&R($,D,q,_,b);((V=q.onVnodeUpdated)||B)&&Oe(()=>{V&&ze(V,_,f,d),B&&bt(f,d,_,"updated")},T)},I=(d,f,_,T,b,E,U)=>{for(let $=0;$<f.length;$++){const j=d[$],k=f[$],B=j.el&&(j.type===st||!ts(j,k)||j.shapeFlag&198)?h(j.el):_;w(j,k,B,null,T,b,E,U,!0)}},R=(d,f,_,T,b)=>{if(f!==_){if(f!==le)for(const E in f)!us(E)&&!(E in _)&&i(d,E,f[E],null,b,T);for(const E in _){if(us(E))continue;const U=_[E],$=f[E];U!==$&&E!=="value"&&i(d,E,$,U,b,T)}"value"in _&&i(d,"value",f.value,_.value,b)}},y=(d,f,_,T,b,E,U,$,j)=>{const k=f.el=d?d.el:a(""),B=f.anchor=d?d.anchor:a("");let{patchFlag:D,dynamicChildren:q,slotScopeIds:V}=f;V&&($=$?$.concat(V):V),d==null?(r(k,_,T),r(B,_,T),m(f.children||[],_,B,b,E,U,$,j)):D>0&&D&64&&q&&d.dynamicChildren?(I(d.dynamicChildren,q,_,b,E,U,$),(f.key!=null||b&&f===b.subTree)&&Po(d,f,!0)):Z(d,f,_,B,b,E,U,$,j)},F=(d,f,_,T,b,E,U,$,j)=>{f.slotScopeIds=$,d==null?f.shapeFlag&512?b.ctx.activate(f,_,T,U,j):L(f,_,T,b,E,U,j):Y(d,f,j)},L=(d,f,_,T,b,E,U)=>{const $=d.component=Ol(d,T,b);if(go(d)&&($.ctx.renderer=Xt),Rl($,!1,U),$.asyncDep){if(b&&b.registerDep($,M,U),!d.el){const j=$.subTree=mt(Vt);O(null,j,f,_),d.placeholder=j.el}}else M($,d,f,_,b,E,U)},Y=(d,f,_)=>{const T=f.component=d.component;if(_l(d,f,_))if(T.asyncDep&&!T.asyncResolved){H(T,f,_);return}else T.next=f,T.update();else f.el=d.el,T.vnode=f},M=(d,f,_,T,b,E,U)=>{const $=()=>{if(d.isMounted){let{next:D,bu:q,u:V,parent:X,vnode:ie}=d;{const We=xo(d);if(We){D&&(D.el=ie.el,H(d,D,U)),We.asyncDep.then(()=>{d.isUnmounted||$()});return}}let se=D,Ee;St(d,!1),D?(D.el=ie.el,H(d,D,U)):D=ie,q&&kr(q),(Ee=D.props&&D.props.onVnodeBeforeUpdate)&&ze(Ee,X,D,ie),St(d,!0);const Te=ei(d),He=d.subTree;d.subTree=Te,w(He,Te,h(He.el),Ls(He),d,b,E),D.el=Te.el,se===null&&ml(d,Te.el),V&&Oe(V,b),(Ee=D.props&&D.props.onVnodeUpdated)&&Oe(()=>ze(Ee,X,D,ie),b)}else{let D;const{el:q,props:V}=f,{bm:X,m:ie,parent:se,root:Ee,type:Te}=d,He=ds(f);St(d,!1),X&&kr(X),!He&&(D=V&&V.onVnodeBeforeMount)&&ze(D,se,f),St(d,!0);{Ee.ce&&Ee.ce._def.shadowRoot!==!1&&Ee.ce._injectChildStyle(Te);const We=d.subTree=ei(d);w(null,We,_,T,d,b,E),f.el=We.el}if(ie&&Oe(ie,b),!He&&(D=V&&V.onVnodeMounted)){const We=f;Oe(()=>ze(D,se,We),b)}(f.shapeFlag&256||se&&ds(se.vnode)&&se.vnode.shapeFlag&256)&&d.a&&Oe(d.a,b),d.isMounted=!0,f=_=T=null}};d.scope.on();const j=d.effect=new qi($);d.scope.off();const k=d.update=j.run.bind(j),B=d.job=j.runIfDirty.bind(j);B.i=d,B.id=d.uid,j.scheduler=()=>En(B),St(d,!0),k()},H=(d,f,_)=>{f.component=d;const T=d.vnode.props;d.vnode=f,d.next=null,tl(d,f.props,T,_),il(d,f.children,_),ot(),Vn(d),at()},Z=(d,f,_,T,b,E,U,$,j=!1)=>{const k=d&&d.children,B=d?d.shapeFlag:0,D=f.children,{patchFlag:q,shapeFlag:V}=f;if(q>0){if(q&128){lt(k,D,_,T,b,E,U,$,j);return}else if(q&256){Ue(k,D,_,T,b,E,U,$,j);return}}V&8?(B&16&&Yt(k,b,E),D!==k&&l(_,D)):B&16?V&16?lt(k,D,_,T,b,E,U,$,j):Yt(k,b,E,!0):(B&8&&l(_,""),V&16&&m(D,_,T,b,E,U,$,j))},Ue=(d,f,_,T,b,E,U,$,j)=>{d=d||Wt,f=f||Wt;const k=d.length,B=f.length,D=Math.min(k,B);let q;for(q=0;q<D;q++){const V=f[q]=j?gt(f[q]):Qe(f[q]);w(d[q],V,_,null,b,E,U,$,j)}k>B?Yt(d,b,E,!0,!1,D):m(f,_,T,b,E,U,$,j,D)},lt=(d,f,_,T,b,E,U,$,j)=>{let k=0;const B=f.length;let D=d.length-1,q=B-1;for(;k<=D&&k<=q;){const V=d[k],X=f[k]=j?gt(f[k]):Qe(f[k]);if(ts(V,X))w(V,X,_,null,b,E,U,$,j);else break;k++}for(;k<=D&&k<=q;){const V=d[D],X=f[q]=j?gt(f[q]):Qe(f[q]);if(ts(V,X))w(V,X,_,null,b,E,U,$,j);else break;D--,q--}if(k>D){if(k<=q){const V=q+1,X=V<B?f[V].el:T;for(;k<=q;)w(null,f[k]=j?gt(f[k]):Qe(f[k]),_,X,b,E,U,$,j),k++}}else if(k>q)for(;k<=D;)Be(d[k],b,E,!0),k++;else{const V=k,X=k,ie=new Map;for(k=X;k<=q;k++){const xe=f[k]=j?gt(f[k]):Qe(f[k]);xe.key!=null&&ie.set(xe.key,k)}let se,Ee=0;const Te=q-X+1;let He=!1,We=0;const Zt=new Array(Te);for(k=0;k<Te;k++)Zt[k]=0;for(k=V;k<=D;k++){const xe=d[k];if(Ee>=Te){Be(xe,b,E,!0);continue}let Ke;if(xe.key!=null)Ke=ie.get(xe.key);else for(se=X;se<=q;se++)if(Zt[se-X]===0&&ts(xe,f[se])){Ke=se;break}Ke===void 0?Be(xe,b,E,!0):(Zt[Ke-X]=k+1,Ke>=We?We=Ke:He=!0,w(xe,f[Ke],_,null,b,E,U,$,j),Ee++)}const Fn=He?ll(Zt):Wt;for(se=Fn.length-1,k=Te-1;k>=0;k--){const xe=X+k,Ke=f[xe],qn=f[xe+1],Mn=xe+1<B?qn.el||qn.placeholder:T;Zt[k]===0?w(null,Ke,_,Mn,b,E,U,$,j):He&&(se<0||k!==Fn[se]?wt(Ke,_,Mn,2):se--)}}},wt=(d,f,_,T,b=null)=>{const{el:E,type:U,transition:$,children:j,shapeFlag:k}=d;if(k&6){wt(d.component.subTree,f,_,T);return}if(k&128){d.suspense.move(f,_,T);return}if(k&64){U.move(d,f,_,Xt);return}if(U===st){r(E,f,_);for(let D=0;D<j.length;D++)wt(j[D],f,_,T);r(d.anchor,f,_);return}if(U===Pr){v(d,f,_);return}if(T!==2&&k&1&&$)if(T===0)$.beforeEnter(E),r(E,f,_),Oe(()=>$.enter(E),b);else{const{leave:D,delayLeave:q,afterLeave:V}=$,X=()=>{d.ctx.isUnmounted?n(E):r(E,f,_)},ie=()=>{D(E,()=>{X(),V&&V()})};q?q(E,X,ie):ie()}else r(E,f,_)},Be=(d,f,_,T=!1,b=!1)=>{const{type:E,props:U,ref:$,children:j,dynamicChildren:k,shapeFlag:B,patchFlag:D,dirs:q,cacheIndex:V}=d;if(D===-2&&(b=!1),$!=null&&(ot(),hs($,null,_,d,!0),at()),V!=null&&(f.renderCache[V]=void 0),B&256){f.ctx.deactivate(d);return}const X=B&1&&q,ie=!ds(d);let se;if(ie&&(se=U&&U.onVnodeBeforeUnmount)&&ze(se,f,d),B&6)ma(d.component,_,T);else{if(B&128){d.suspense.unmount(_,T);return}X&&bt(d,null,f,"beforeUnmount"),B&64?d.type.remove(d,f,_,Xt,T):k&&!k.hasOnce&&(E!==st||D>0&&D&64)?Yt(k,f,_,!1,!0):(E===st&&D&384||!b&&B&16)&&Yt(j,f,_),T&&Ln(d)}(ie&&(se=U&&U.onVnodeUnmounted)||X)&&Oe(()=>{se&&ze(se,f,d),X&&bt(d,null,f,"unmounted")},_)},Ln=d=>{const{type:f,el:_,anchor:T,transition:b}=d;if(f===st){_a(_,T);return}if(f===Pr){C(d);return}const E=()=>{n(_),b&&!b.persisted&&b.afterLeave&&b.afterLeave()};if(d.shapeFlag&1&&b&&!b.persisted){const{leave:U,delayLeave:$}=b,j=()=>U(_,E);$?$(d.el,E,j):j()}else E()},_a=(d,f)=>{let _;for(;d!==f;)_=g(d),n(d),d=_;n(f)},ma=(d,f,_)=>{const{bum:T,scope:b,job:E,subTree:U,um:$,m:j,a:k,parent:B,slots:{__:D}}=d;Zn(j),Zn(k),T&&kr(T),B&&te(D)&&D.forEach(q=>{B.renderCache[q]=void 0}),b.stop(),E&&(E.flags|=8,Be(U,d,f,_)),$&&Oe($,f),Oe(()=>{d.isUnmounted=!0},f),f&&f.pendingBranch&&!f.isUnmounted&&d.asyncDep&&!d.asyncResolved&&d.suspenseId===f.pendingId&&(f.deps--,f.deps===0&&f.resolve())},Yt=(d,f,_,T=!1,b=!1,E=0)=>{for(let U=E;U<d.length;U++)Be(d[U],f,_,T,b)},Ls=d=>{if(d.shapeFlag&6)return Ls(d.component.subTree);if(d.shapeFlag&128)return d.suspense.next();const f=g(d.anchor||d.el),_=f&&f[Cc];return _?g(_):f};let wr=!1;const Nn=(d,f,_)=>{d==null?f._vnode&&Be(f._vnode,null,null,!0):w(f._vnode||null,d,f,null,null,null,_),f._vnode=d,wr||(wr=!0,Vn(),lo(),wr=!1)},Xt={p:w,um:Be,m:wt,r:Ln,mt:L,mc:m,pc:Z,pbc:I,n:Ls,o:t};return{render:Nn,hydrate:void 0,createApp:Yc(Nn)}}function Ar({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function St({effect:t,job:e},s){s?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function cl(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Po(t,e,s=!1){const r=t.children,n=e.children;if(te(r)&&te(n))for(let i=0;i<r.length;i++){const o=r[i];let a=n[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=n[i]=gt(n[i]),a.el=o.el),!s&&a.patchFlag!==-2&&Po(o,a)),a.type===dr&&(a.el=o.el),a.type===Vt&&!a.el&&(a.el=o.el)}}function ll(t){const e=t.slice(),s=[0];let r,n,i,o,a;const c=t.length;for(r=0;r<c;r++){const u=t[r];if(u!==0){if(n=s[s.length-1],t[n]<u){e[r]=n,s.push(r);continue}for(i=0,o=s.length-1;i<o;)a=i+o>>1,t[s[a]]<u?i=a+1:o=a;u<t[s[i]]&&(i>0&&(e[r]=s[i-1]),s[i]=r)}}for(i=s.length,o=s[i-1];i-- >0;)s[i]=o,o=e[o];return s}function xo(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:xo(e)}function Zn(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const ul=Symbol.for("v-scx"),hl=()=>gs(ul);function Vs(t,e,s){return Oo(t,e,s)}function Oo(t,e,s=le){const{immediate:r,deep:n,flush:i,once:o}=s,a=Pe({},s),c=e&&r||!e&&i!=="post";let u;if(ks){if(i==="sync"){const p=hl();u=p.__watcherHandles||(p.__watcherHandles=[])}else if(!c){const p=()=>{};return p.stop=it,p.resume=it,p.pause=it,p}}const l=me;a.call=(p,S,w)=>Je(p,l,S,w);let h=!1;i==="post"?a.scheduler=p=>{Oe(p,l&&l.suspense)}:i!=="sync"&&(h=!0,a.scheduler=(p,S)=>{S?p():En(p)}),a.augmentJob=p=>{e&&(p.flags|=4),h&&(p.flags|=2,l&&(p.id=l.uid,p.i=l))};const g=hc(t,e,a);return ks&&(u?u.push(g):c&&g()),g}function dl(t,e,s){const r=this.proxy,n=Ie(t)?t.includes(".")?Ro(r,t):()=>r[t]:t.bind(r,r);let i;J(e)?i=e:(i=e.handler,s=e);const o=js(this),a=Oo(n,i.bind(r),s);return o(),a}function Ro(t,e){const s=e.split(".");return()=>{let r=t;for(let n=0;n<s.length&&r;n++)r=r[s[n]];return r}}const fl=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Me(e)}Modifiers`]||t[`${Os(e)}Modifiers`];function gl(t,e,...s){if(t.isUnmounted)return;const r=t.vnode.props||le;let n=s;const i=e.startsWith("update:"),o=i&&fl(r,e.slice(7));o&&(o.trim&&(n=s.map(l=>Ie(l)?l.trim():l)),o.number&&(n=s.map(_c)));let a,c=r[a=Tr(e)]||r[a=Tr(Me(e))];!c&&i&&(c=r[a=Tr(Os(e))]),c&&Je(c,t,6,n);const u=r[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Je(u,t,6,n)}}function jo(t,e,s=!1){const r=e.emitsCache,n=r.get(t);if(n!==void 0)return n;const i=t.emits;let o={},a=!1;if(!J(t)){const c=u=>{const l=jo(u,e,!0);l&&(a=!0,Pe(o,l))};!s&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(Se(t)&&r.set(t,null),null):(te(i)?i.forEach(c=>o[c]=null):Pe(o,i),Se(t)&&r.set(t,o),o)}function hr(t,e){return!t||!yn(e)?!1:(e=e.slice(2).replace(/Once$/,""),ce(t,e[0].toLowerCase()+e.slice(1))||ce(t,Os(e))||ce(t,e))}function ei(t){const{type:e,vnode:s,proxy:r,withProxy:n,propsOptions:[i],slots:o,attrs:a,emit:c,render:u,renderCache:l,props:h,data:g,setupState:p,ctx:S,inheritAttrs:w}=t,x=Zs(t);let O,P;try{if(s.shapeFlag&4){const C=n||r,N=C;O=Qe(u.call(N,C,l,h,p,g,S)),P=a}else{const C=e;O=Qe(C.length>1?C(h,{attrs:a,slots:o,emit:c}):C(h,null)),P=e.props?a:pl(a)}}catch(C){ps.length=0,lr(C,t,1),O=mt(Vt)}let v=O;if(P&&w!==!1){const C=Object.keys(P),{shapeFlag:N}=v;C.length&&N&7&&(i&&C.some(ro)&&(P=vl(P,i)),v=zt(v,P,!1,!0))}return s.dirs&&(v=zt(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(s.dirs):s.dirs),s.transition&&Tn(v,s.transition),O=v,Zs(x),O}const pl=t=>{let e;for(const s in t)(s==="class"||s==="style"||yn(s))&&((e||(e={}))[s]=t[s]);return e},vl=(t,e)=>{const s={};for(const r in t)(!ro(r)||!(r.slice(9)in e))&&(s[r]=t[r]);return s};function _l(t,e,s){const{props:r,children:n,component:i}=t,{props:o,children:a,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&c>=0){if(c&1024)return!0;if(c&16)return r?ti(r,o,u):!!o;if(c&8){const l=e.dynamicProps;for(let h=0;h<l.length;h++){const g=l[h];if(o[g]!==r[g]&&!hr(u,g))return!0}}}else return(n||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?ti(r,o,u):!0:!!o;return!1}function ti(t,e,s){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let n=0;n<r.length;n++){const i=r[n];if(e[i]!==t[i]&&!hr(s,i))return!0}return!1}function ml({vnode:t,parent:e},s){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=e.vnode).el=s,e=e.parent;else break}}const Io=t=>t.__isSuspense;function yl(t,e){e&&e.pendingBranch?te(t)?e.effects.push(...t):e.effects.push(t):Tc(t)}const st=Symbol.for("v-fgt"),dr=Symbol.for("v-txt"),Vt=Symbol.for("v-cmt"),Pr=Symbol.for("v-stc"),ps=[];let Re=null;function wl(t=!1){ps.push(Re=t?null:[])}function bl(){ps.pop(),Re=ps[ps.length-1]||null}let Ts=1;function si(t,e=!1){Ts+=t,t<0&&Re&&e&&(Re.hasOnce=!0)}function Sl(t){return t.dynamicChildren=Ts>0?Re||Wt:null,bl(),Ts>0&&Re&&Re.push(t),t}function El(t,e,s,r,n,i){return Sl(Do(t,e,s,r,n,i,!0))}function $o(t){return t?t.__v_isVNode===!0:!1}function ts(t,e){return t.type===e.type&&t.key===e.key}const Uo=({key:t})=>t??null,zs=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?Ie(t)||ue(t)||J(t)?{i:Ne,r:t,k:e,f:!!s}:t:null);function Do(t,e=null,s=null,r=0,n=null,i=t===st?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Uo(e),ref:e&&zs(e),scopeId:ho,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Ne};return a?(Pn(c,s),i&128&&t.normalize(c)):s&&(c.shapeFlag|=Ie(s)?8:16),Ts>0&&!o&&Re&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&Re.push(c),c}const mt=Tl;function Tl(t,e=null,s=null,r=0,n=null,i=!1){if((!t||t===Bc)&&(t=Vt),$o(t)){const a=zt(t,e,!0);return s&&Pn(a,s),Ts>0&&!i&&Re&&(a.shapeFlag&6?Re[Re.indexOf(t)]=a:Re.push(a)),a.patchFlag=-2,a}if(Dl(t)&&(t=t.__vccOpts),e){e=kl(e);let{class:a,style:c}=e;a&&!Ie(a)&&(e.class=Sn(a)),Se(c)&&(mn(c)&&!te(c)&&(c=Pe({},c)),e.style=bn(c))}const o=Ie(t)?1:Io(t)?128:Ac(t)?64:Se(t)?4:J(t)?2:0;return Do(t,e,s,r,n,o,i,!0)}function kl(t){return t?mn(t)||So(t)?Pe({},t):t:null}function zt(t,e,s=!1,r=!1){const{props:n,ref:i,patchFlag:o,children:a,transition:c}=t,u=e?Al(n||{},e):n,l={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&Uo(u),ref:e&&e.ref?s&&i?te(i)?i.concat(zs(e)):[i,zs(e)]:zs(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==st?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&zt(t.ssContent),ssFallback:t.ssFallback&&zt(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&r&&Tn(l,c.clone(l)),l}function Cl(t=" ",e=0){return mt(dr,null,t,e)}function Qe(t){return t==null||typeof t=="boolean"?mt(Vt):te(t)?mt(st,null,t.slice()):$o(t)?gt(t):mt(dr,null,String(t))}function gt(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:zt(t)}function Pn(t,e){let s=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(te(e))s=16;else if(typeof e=="object")if(r&65){const n=e.default;n&&(n._c&&(n._d=!1),Pn(t,n()),n._c&&(n._d=!0));return}else{s=32;const n=e._;!n&&!So(e)?e._ctx=Ne:n===3&&Ne&&(Ne.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else J(e)?(e={default:e,_ctx:Ne},s=32):(e=String(e),r&64?(s=16,e=[Cl(e)]):s=8);t.children=e,t.shapeFlag|=s}function Al(...t){const e={};for(let s=0;s<t.length;s++){const r=t[s];for(const n in r)if(n==="class")e.class!==r.class&&(e.class=Sn([e.class,r.class]));else if(n==="style")e.style=bn([e.style,r.style]);else if(yn(n)){const i=e[n],o=r[n];o&&i!==o&&!(te(i)&&i.includes(o))&&(e[n]=i?[].concat(i,o):o)}else n!==""&&(e[n]=r[n])}return e}function ze(t,e,s,r=null){Je(t,e,7,[s,r])}const Pl=yo();let xl=0;function Ol(t,e,s){const r=t.type,n=(e?e.appContext:t.appContext)||Pl,i={uid:xl++,vnode:t,type:r,parent:e,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ni(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(n.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:To(r,n),emitsOptions:jo(r,n),emit:null,emitted:null,propsDefaults:le,inheritAttrs:r.inheritAttrs,ctx:le,data:le,props:le,attrs:le,slots:le,refs:le,setupState:le,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=gl.bind(null,i),t.ce&&t.ce(i),i}let me=null;const Lo=()=>me||Ne;let tr,Gr;{const t=cr(),e=(s,r)=>{let n;return(n=t[s])||(n=t[s]=[]),n.push(r),i=>{n.length>1?n.forEach(o=>o(i)):n[0](i)}};tr=e("__VUE_INSTANCE_SETTERS__",s=>me=s),Gr=e("__VUE_SSR_SETTERS__",s=>ks=s)}const js=t=>{const e=me;return tr(t),t.scope.on(),()=>{t.scope.off(),tr(e)}},ri=()=>{me&&me.scope.off(),tr(null)};function No(t){return t.vnode.shapeFlag&4}let ks=!1;function Rl(t,e=!1,s=!1){e&&Gr(e);const{props:r,children:n}=t.vnode,i=No(t);el(t,r,i,e),nl(t,n,s||e);const o=i?jl(t,e):void 0;return e&&Gr(!1),o}function jl(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Wc);const{setup:r}=s;if(r){ot();const n=t.setupContext=r.length>1?$l(t):null,i=js(t),o=Rs(r,t,0,[t.props,n]),a=io(o);if(at(),i(),(a||t.sp)&&!ds(t)&&fo(t),a){if(o.then(ri,ri),e)return o.then(c=>{ni(t,c)}).catch(c=>{lr(c,t,0)});t.asyncDep=o}else ni(t,o)}else Fo(t)}function ni(t,e,s){J(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Se(e)&&(t.setupState=so(e)),Fo(t)}function Fo(t,e,s){const r=t.type;t.render||(t.render=r.render||it);{const n=js(t);ot();try{Kc(t)}finally{at(),n()}}}const Il={get(t,e){return _e(t,"get",""),t[e]}};function $l(t){const e=s=>{t.exposed=s||{}};return{attrs:new Proxy(t.attrs,Il),slots:t.slots,emit:t.emit,expose:e}}function xn(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(so(to(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in fs)return fs[s](t)},has(e,s){return s in e||s in fs}})):t.proxy}function Ul(t,e=!0){return J(t)?t.displayName||t.name:t.name||e&&t.__name}function Dl(t){return J(t)&&"__vccOpts"in t}const pe=(t,e)=>lc(t,e,ks),Ll="3.5.18";/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Nl(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const Fl=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),ql=t=>t.startsWith("onUpdate:"),Ml=Object.assign,qo=Array.isArray,Mo=t=>typeof t=="function",Cs=t=>typeof t=="string",Bl=t=>typeof t=="symbol",On=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},Hl=/-(\w)/g,Wl=On(t=>t.replace(Hl,(e,s)=>s?s.toUpperCase():"")),Kl=/\B([A-Z])/g,Bo=On(t=>t.replace(Kl,"-$1").toLowerCase()),Vl=On(t=>t.charAt(0).toUpperCase()+t.slice(1)),zl="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Gl=Nl(zl);function Ho(t){return!!t||t===""}/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Qr;const ii=typeof window<"u"&&window.trustedTypes;if(ii)try{Qr=ii.createPolicy("vue",{createHTML:t=>t})}catch{}const Wo=Qr?t=>Qr.createHTML(t):t=>t,Ql="http://www.w3.org/2000/svg",Jl="http://www.w3.org/1998/Math/MathML",Ze=typeof document<"u"?document:null,oi=Ze&&Ze.createElement("template"),Yl={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,r)=>{const n=e==="svg"?Ze.createElementNS(Ql,t):e==="mathml"?Ze.createElementNS(Jl,t):s?Ze.createElement(t,{is:s}):Ze.createElement(t);return t==="select"&&r&&r.multiple!=null&&n.setAttribute("multiple",r.multiple),n},createText:t=>Ze.createTextNode(t),createComment:t=>Ze.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ze.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,r,n,i){const o=s?s.previousSibling:e.lastChild;if(n&&(n===i||n.nextSibling))for(;e.insertBefore(n.cloneNode(!0),s),!(n===i||!(n=n.nextSibling)););else{oi.innerHTML=Wo(r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t);const a=oi.content;if(r==="svg"||r==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,s)}return[o?o.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},Xl=Symbol("_vtc");function Zl(t,e,s){const r=t[Xl];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const ai=Symbol("_vod"),eu=Symbol("_vsh"),tu=Symbol(""),su=/(^|;)\s*display\s*:/;function ru(t,e,s){const r=t.style,n=Cs(s);let i=!1;if(s&&!n){if(e)if(Cs(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();s[a]==null&&Gs(r,a,"")}else for(const o in e)s[o]==null&&Gs(r,o,"");for(const o in s)o==="display"&&(i=!0),Gs(r,o,s[o])}else if(n){if(e!==s){const o=r[tu];o&&(s+=";"+o),r.cssText=s,i=su.test(s)}}else e&&t.removeAttribute("style");ai in t&&(t[ai]=i?r.display:"",t[eu]&&(r.display="none"))}const ci=/\s*!important$/;function Gs(t,e,s){if(qo(s))s.forEach(r=>Gs(t,e,r));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const r=nu(t,e);ci.test(s)?t.setProperty(Bo(r),s.replace(ci,""),"important"):t[r]=s}}const li=["Webkit","Moz","ms"],xr={};function nu(t,e){const s=xr[e];if(s)return s;let r=Me(e);if(r!=="filter"&&r in t)return xr[e]=r;r=Vl(r);for(let n=0;n<li.length;n++){const i=li[n]+r;if(i in t)return xr[e]=i}return e}const ui="http://www.w3.org/1999/xlink";function hi(t,e,s,r,n,i=Gl(e)){r&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(ui,e.slice(6,e.length)):t.setAttributeNS(ui,e,s):s==null||i&&!Ho(s)?t.removeAttribute(e):t.setAttribute(e,i?"":Bl(s)?String(s):s)}function di(t,e,s,r,n){if(e==="innerHTML"||e==="textContent"){s!=null&&(t[e]=e==="innerHTML"?Wo(s):s);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,c=s==null?t.type==="checkbox"?"on":"":String(s);(a!==c||!("_value"in t))&&(t.value=c),s==null&&t.removeAttribute(e),t._value=s;return}let o=!1;if(s===""||s==null){const a=typeof t[e];a==="boolean"?s=Ho(s):s==null&&a==="string"?(s="",o=!0):a==="number"&&(s=0,o=!0)}try{t[e]=s}catch{}o&&t.removeAttribute(n||e)}function iu(t,e,s,r){t.addEventListener(e,s,r)}function ou(t,e,s,r){t.removeEventListener(e,s,r)}const fi=Symbol("_vei");function au(t,e,s,r,n=null){const i=t[fi]||(t[fi]={}),o=i[e];if(r&&o)o.value=r;else{const[a,c]=cu(e);if(r){const u=i[e]=hu(r,n);iu(t,a,u,c)}else o&&(ou(t,a,o,c),i[e]=void 0)}}const gi=/(?:Once|Passive|Capture)$/;function cu(t){let e;if(gi.test(t)){e={};let r;for(;r=t.match(gi);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Bo(t.slice(2)),e]}let Or=0;const lu=Promise.resolve(),uu=()=>Or||(lu.then(()=>Or=0),Or=Date.now());function hu(t,e){const s=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=s.attached)return;Je(du(r,s.value),e,5,[r])};return s.value=t,s.attached=uu(),s}function du(t,e){if(qo(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(r=>n=>!n._stopped&&r&&r(n))}else return e}const pi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,fu=(t,e,s,r,n,i)=>{const o=n==="svg";e==="class"?Zl(t,r,o):e==="style"?ru(t,s,r):Fl(e)?ql(e)||au(t,e,s,r,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):gu(t,e,r,o))?(di(t,e,r),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&hi(t,e,r,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Cs(r))?di(t,Wl(e),r,i,e):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),hi(t,e,r,o))};function gu(t,e,s,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in t&&pi(e)&&Mo(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const n=t.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return pi(e)&&Cs(s)?!1:e in t}const pu=Ml({patchProp:fu},Yl);let vi;function vu(){return vi||(vi=ol(pu))}const _u=(...t)=>{const e=vu().createApp(...t),{mount:s}=e;return e.mount=r=>{const n=yu(r);if(!n)return;const i=e._component;!Mo(i)&&!i.render&&!i.template&&(i.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const o=s(n,!1,mu(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},e};function mu(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function yu(t){return Cs(t)?document.querySelector(t):t}/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let Ko;const Rn=t=>Ko=t,wu=Symbol();function Jr(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var vs;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(vs||(vs={}));const Vo=()=>{};function _i(t,e,s,r=Vo){t.push(e);const n=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),r())};return!s&&Fi()&&$a(n),n}function $t(t,...e){t.slice().forEach(s=>{s(...e)})}const bu=t=>t(),mi=Symbol(),Rr=Symbol();function Yr(t,e){t instanceof Map&&e instanceof Map?e.forEach((s,r)=>t.set(r,s)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const s in e){if(!e.hasOwnProperty(s))continue;const r=e[s],n=t[s];Jr(n)&&Jr(r)&&t.hasOwnProperty(s)&&!ue(r)&&!xt(r)?t[s]=Yr(n,r):t[s]=r}return t}const Su=Symbol();function Eu(t){return!Jr(t)||!t.hasOwnProperty(Su)}const{assign:ht}=Object;function Tu(t){return!!(ue(t)&&t.effect)}function ku(t,e,s,r){const{state:n,actions:i,getters:o}=e,a=s.state.value[t];let c;function u(){a||(s.state.value[t]=n?n():{});const l=ic(s.state.value[t]);return ht(l,i,Object.keys(o||{}).reduce((h,g)=>(h[g]=to(pe(()=>{Rn(s);const p=s._s.get(t);return o[g].call(p,p)})),h),{}))}return c=zo(t,u,e,s,r,!0),c}function zo(t,e,s={},r,n,i){let o;const a=ht({actions:{}},s),c={deep:!0};let u,l,h=[],g=[],p;const S=r.state.value[t];!i&&!S&&(r.state.value[t]={}),G({});let w;function x(m){let A;u=l=!1,typeof m=="function"?(m(r.state.value[t]),A={type:vs.patchFunction,storeId:t,events:p}):(Yr(r.state.value[t],m),A={type:vs.patchObject,payload:m,storeId:t,events:p});const I=w=Symbol();ao().then(()=>{w===I&&(u=!0)}),l=!0,$t(h,A,r.state.value[t])}const O=i?function(){const{state:A}=s,I=A?A():{};this.$patch(R=>{ht(R,I)})}:Vo;function P(){o.stop(),h=[],g=[],r._s.delete(t)}const v=(m,A="")=>{if(mi in m)return m[Rr]=A,m;const I=function(){Rn(r);const R=Array.from(arguments),y=[],F=[];function L(H){y.push(H)}function Y(H){F.push(H)}$t(g,{args:R,name:I[Rr],store:N,after:L,onError:Y});let M;try{M=m.apply(this&&this.$id===t?this:N,R)}catch(H){throw $t(F,H),H}return M instanceof Promise?M.then(H=>($t(y,H),H)).catch(H=>($t(F,H),Promise.reject(H))):($t(y,M),M)};return I[mi]=!0,I[Rr]=A,I},C={_p:r,$id:t,$onAction:_i.bind(null,g),$patch:x,$reset:O,$subscribe(m,A={}){const I=_i(h,m,A.detached,()=>R()),R=o.run(()=>Vs(()=>r.state.value[t],y=>{(A.flush==="sync"?l:u)&&m({storeId:t,type:vs.direct,events:p},y)},ht({},c,A)));return I},$dispose:P},N=or(C);r._s.set(t,N);const K=(r._a&&r._a.runWithContext||bu)(()=>r._e.run(()=>(o=Ia()).run(()=>e({action:v}))));for(const m in K){const A=K[m];if(ue(A)&&!Tu(A)||xt(A))i||(S&&Eu(A)&&(ue(A)?A.value=S[m]:Yr(A,S[m])),r.state.value[t][m]=A);else if(typeof A=="function"){const I=v(A,m);K[m]=I,a.actions[m]=A}}return ht(N,K),ht(ee(N),K),Object.defineProperty(N,"$state",{get:()=>r.state.value[t],set:m=>{x(A=>{ht(A,m)})}}),r._p.forEach(m=>{ht(N,o.run(()=>m({store:N,app:r._a,pinia:r,options:a})))}),S&&i&&s.hydrate&&s.hydrate(N.$state,S),u=!0,l=!0,N}/*! #__NO_SIDE_EFFECTS__ */function Is(t,e,s){let r,n;const i=typeof e=="function";typeof t=="string"?(r=t,n=i?s:e):(n=t,r=t.id);function o(a,c){const u=Zc();return a=a||(u?gs(wu,null):null),a&&Rn(a),a=Ko,a._s.has(r)||(i?zo(r,e,n,a):ku(r,n,a)),a._s.get(r)}return o.$id=r,o}const Cu="modulepreload",Au=function(t){return"/"+t},yi={},$s=function(e,s,r){let n=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(s.map(c=>{if(c=Au(c),c in yi)return;yi[c]=!0;const u=c.endsWith(".css"),l=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${l}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Cu,u||(h.as="script"),h.crossOrigin="",h.href=c,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((g,p)=>{h.addEventListener("load",g),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},Pu=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...s)=>$s(async()=>{const{default:r}=await Promise.resolve().then(()=>Qt);return{default:r}},void 0).then(({default:r})=>r(...s)):e=fetch,(...s)=>e(...s)};class jn extends Error{constructor(e,s="FunctionsError",r){super(e),this.name=s,this.context=r}}class xu extends jn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class wi extends jn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class bi extends jn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Xr;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Xr||(Xr={}));var Ou=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(h){o(h)}}function c(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})};class Ru{constructor(e,{headers:s={},customFetch:r,region:n=Xr.Any}={}){this.url=e,this.headers=s,this.region=n,this.fetch=Pu(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,s={}){var r;return Ou(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=s;let a={},{region:c}=s;c||(c=this.region);const u=new URL(`${this.url}/${e}`);c&&c!=="any"&&(a["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let l;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",l=o):typeof o=="string"?(a["Content-Type"]="text/plain",l=o):typeof FormData<"u"&&o instanceof FormData?l=o:(a["Content-Type"]="application/json",l=JSON.stringify(o)));const h=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:l}).catch(w=>{throw new xu(w)}),g=h.headers.get("x-relay-error");if(g&&g==="true")throw new wi(h);if(!h.ok)throw new bi(h);let p=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),S;return p==="application/json"?S=yield h.json():p==="application/octet-stream"?S=yield h.blob():p==="text/event-stream"?S=h:p==="multipart/form-data"?S=yield h.formData():S=yield h.text(),{data:S,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof bi||n instanceof wi?n.context:void 0}}})}}var $e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ju(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var s=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};s.prototype=e.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(s,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}),s}var Ae={},In={},fr={},Us={},gr={},pr={},Iu=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Gt=Iu();const $u=Gt.fetch,Go=Gt.fetch.bind(Gt),Qo=Gt.Headers,Uu=Gt.Request,Du=Gt.Response,Qt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Qo,Request:Uu,Response:Du,default:Go,fetch:$u},Symbol.toStringTag,{value:"Module"})),Lu=ju(Qt);var vr={};Object.defineProperty(vr,"__esModule",{value:!0});let Nu=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};vr.default=Nu;var Jo=$e&&$e.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(pr,"__esModule",{value:!0});const Fu=Jo(Lu),qu=Jo(vr);let Mu=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Fu.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,s){return this.headers=Object.assign({},this.headers),this.headers[e]=s,this}then(e,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let n=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,a,c;let u=null,l=null,h=null,g=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const O=await i.text();O===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?l=O:l=JSON.parse(O))}const w=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),x=(a=i.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");w&&x&&x.length>1&&(h=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(l)&&(l.length>1?(u={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,h=null,g=406,p="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{const w=await i.text();try{u=JSON.parse(w),Array.isArray(u)&&i.status===404&&(l=[],u=null,g=200,p="OK")}catch{i.status===404&&w===""?(g=204,p="No Content"):u={message:w}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,g=200,p="OK"),u&&this.shouldThrowOnError)throw new qu.default(u)}return{error:u,data:l,count:h,status:g,statusText:p}});return this.shouldThrowOnError||(n=n.catch(i=>{var o,a,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(a=i==null?void 0:i.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(e,s)}returns(){return this}overrideTypes(){return this}};pr.default=Mu;var Bu=$e&&$e.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(gr,"__esModule",{value:!0});const Hu=Bu(pr);let Wu=class extends Hu.default{select(e){let s=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!s?"":(n==='"'&&(s=!s),n)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:s=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const o=i?`${i}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${s?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:s,referencedTable:r=s}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,s,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${s-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:s=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:o="text"}={}){var a;const c=[e?"analyze":null,s?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};gr.default=Wu;var Ku=$e&&$e.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Us,"__esModule",{value:!0});const Vu=Ku(gr);let zu=class extends Vu.default{eq(e,s){return this.url.searchParams.append(e,`eq.${s}`),this}neq(e,s){return this.url.searchParams.append(e,`neq.${s}`),this}gt(e,s){return this.url.searchParams.append(e,`gt.${s}`),this}gte(e,s){return this.url.searchParams.append(e,`gte.${s}`),this}lt(e,s){return this.url.searchParams.append(e,`lt.${s}`),this}lte(e,s){return this.url.searchParams.append(e,`lte.${s}`),this}like(e,s){return this.url.searchParams.append(e,`like.${s}`),this}likeAllOf(e,s){return this.url.searchParams.append(e,`like(all).{${s.join(",")}}`),this}likeAnyOf(e,s){return this.url.searchParams.append(e,`like(any).{${s.join(",")}}`),this}ilike(e,s){return this.url.searchParams.append(e,`ilike.${s}`),this}ilikeAllOf(e,s){return this.url.searchParams.append(e,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(e,s){return this.url.searchParams.append(e,`ilike(any).{${s.join(",")}}`),this}is(e,s){return this.url.searchParams.append(e,`is.${s}`),this}in(e,s){const r=Array.from(new Set(s)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,s){return typeof s=="string"?this.url.searchParams.append(e,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(e,`cs.{${s.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(s)}`),this}containedBy(e,s){return typeof s=="string"?this.url.searchParams.append(e,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(e,`cd.{${s.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(s)}`),this}rangeGt(e,s){return this.url.searchParams.append(e,`sr.${s}`),this}rangeGte(e,s){return this.url.searchParams.append(e,`nxl.${s}`),this}rangeLt(e,s){return this.url.searchParams.append(e,`sl.${s}`),this}rangeLte(e,s){return this.url.searchParams.append(e,`nxr.${s}`),this}rangeAdjacent(e,s){return this.url.searchParams.append(e,`adj.${s}`),this}overlaps(e,s){return typeof s=="string"?this.url.searchParams.append(e,`ov.${s}`):this.url.searchParams.append(e,`ov.{${s.join(",")}}`),this}textSearch(e,s,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${s}`),this}match(e){return Object.entries(e).forEach(([s,r])=>{this.url.searchParams.append(s,`eq.${r}`)}),this}not(e,s,r){return this.url.searchParams.append(e,`not.${s}.${r}`),this}or(e,{foreignTable:s,referencedTable:r=s}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,s,r){return this.url.searchParams.append(e,`${s}.${r}`),this}};Us.default=zu;var Gu=$e&&$e.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fr,"__esModule",{value:!0});const ss=Gu(Us);let Qu=class{constructor(e,{headers:s={},schema:r,fetch:n}){this.url=e,this.headers=s,this.schema=r,this.fetch=n}select(e,{head:s=!1,count:r}={}){const n=s?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new ss.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:s,defaultToNull:r=!0}={}){const n="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),s&&i.push(`count=${s}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(o.length>0){const a=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",a.join(","))}}return new ss.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:s,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){const o="POST",a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const c=e.reduce((u,l)=>u.concat(Object.keys(l)),[]);if(c.length>0){const u=[...new Set(c)].map(l=>`"${l}"`);this.url.searchParams.set("columns",u.join(","))}}return new ss.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:s}={}){const r="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),s&&n.push(`count=${s}`),this.headers.Prefer=n.join(","),new ss.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const s="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ss.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};fr.default=Qu;var _r={},mr={};Object.defineProperty(mr,"__esModule",{value:!0});mr.version=void 0;mr.version="0.0.0-automated";Object.defineProperty(_r,"__esModule",{value:!0});_r.DEFAULT_HEADERS=void 0;const Ju=mr;_r.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Ju.version}`};var Yo=$e&&$e.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(In,"__esModule",{value:!0});const Yu=Yo(fr),Xu=Yo(Us),Zu=_r;let eh=class Xo{constructor(e,{headers:s={},schema:r,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},Zu.DEFAULT_HEADERS),s),this.schemaName=r,this.fetch=n}from(e){const s=new URL(`${this.url}/${e}`);return new Yu.default(s,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Xo(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,s={},{head:r=!1,get:n=!1,count:i}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let c;r||n?(o=r?"HEAD":"GET",Object.entries(s).filter(([l,h])=>h!==void 0).map(([l,h])=>[l,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([l,h])=>{a.searchParams.append(l,h)})):(o="POST",c=s);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new Xu.default({method:o,url:a,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};In.default=eh;var Jt=$e&&$e.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ae,"__esModule",{value:!0});Ae.PostgrestError=Ae.PostgrestBuilder=Ae.PostgrestTransformBuilder=Ae.PostgrestFilterBuilder=Ae.PostgrestQueryBuilder=Ae.PostgrestClient=void 0;const Zo=Jt(In);Ae.PostgrestClient=Zo.default;const ea=Jt(fr);Ae.PostgrestQueryBuilder=ea.default;const ta=Jt(Us);Ae.PostgrestFilterBuilder=ta.default;const sa=Jt(gr);Ae.PostgrestTransformBuilder=sa.default;const ra=Jt(pr);Ae.PostgrestBuilder=ra.default;const na=Jt(vr);Ae.PostgrestError=na.default;var th=Ae.default={PostgrestClient:Zo.default,PostgrestQueryBuilder:ea.default,PostgrestFilterBuilder:ta.default,PostgrestTransformBuilder:sa.default,PostgrestBuilder:ra.default,PostgrestError:na.default};const{PostgrestClient:sh,PostgrestQueryBuilder:hf,PostgrestFilterBuilder:df,PostgrestTransformBuilder:ff,PostgrestBuilder:gf,PostgrestError:pf}=th;class rh{static dynamicRequire(e){try{return typeof process<"u"&&process.versions&&process.versions.node&&typeof require<"u"?require(e):null}catch{return null}}static detectEnvironment(){var e,s;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);if(r>=22)try{if(typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};const n=this.dynamicRequire("undici");if(n&&n.WebSocket)return{type:"native",constructor:n.WebSocket};throw new Error("undici not available")}catch{return{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{const n=this.dynamicRequire("ws");if(n)return{type:"ws",constructor:(s=n.WebSocket)!==null&&s!==void 0?s:n};throw new Error("ws package not available")}catch{return{type:"unsupported",error:`Node.js ${r} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let s=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(s+=`

Suggested solution: ${e.workaround}`),new Error(s)}static createWebSocket(e,s){const r=this.getWebSocketConstructor();return new r(e,s)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const nh="2.15.0",ih=`realtime-js/${nh}`,oh="1.0.0",Zr=1e4,ah=1e3,ch=100;var _s;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(_s||(_s={}));var de;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(de||(de={}));var Le;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Le||(Le={}));var en;(function(t){t.websocket="websocket"})(en||(en={}));var At;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(At||(At={}));class lh{constructor(){this.HEADER_LENGTH=1}decode(e,s){return e.constructor===ArrayBuffer?s(this._binaryDecode(e)):s(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const s=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,s,r)}_decodeBroadcast(e,s,r){const n=s.getUint8(1),i=s.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+n));o=o+n;const c=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:c,payload:u}}}class ia{constructor(e,s){this.callback=e,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var oe;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(oe||(oe={}));const Si=(t,e,s={})=>{var r;const n=(r=s.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=uh(o,t,e,n),i),{})},uh=(t,e,s,r)=>{const n=e.find(a=>a.name===t),i=n==null?void 0:n.type,o=s[t];return i&&!r.includes(i)?oa(i,o):tn(o)},oa=(t,e)=>{if(t.charAt(0)==="_"){const s=t.slice(1,t.length);return gh(e,s)}switch(t){case oe.bool:return hh(e);case oe.float4:case oe.float8:case oe.int2:case oe.int4:case oe.int8:case oe.numeric:case oe.oid:return dh(e);case oe.json:case oe.jsonb:return fh(e);case oe.timestamp:return ph(e);case oe.abstime:case oe.date:case oe.daterange:case oe.int4range:case oe.int8range:case oe.money:case oe.reltime:case oe.text:case oe.time:case oe.timestamptz:case oe.timetz:case oe.tsrange:case oe.tstzrange:return tn(e);default:return tn(e)}},tn=t=>t,hh=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},dh=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},fh=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},gh=(t,e)=>{if(typeof t!="string")return t;const s=t.length-1,r=t[s];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,s);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>oa(e,a))}return t},ph=t=>typeof t=="string"?t.replace(" ","T"):t,aa=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class jr{constructor(e,s,r={},n=Zr){this.channel=e,this.event=s,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,s){var r;return this._hasReceived(e)&&s((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:s}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ei;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Ei||(Ei={}));class ms{constructor(e,s){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ms.syncState(this.state,n,i,o),this.pendingDiffs.forEach(c=>{this.state=ms.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ms.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,s,r,n){const i=this.cloneDeep(e),o=this.transformState(s),a={},c={};return this.map(i,(u,l)=>{o[u]||(c[u]=l)}),this.map(o,(u,l)=>{const h=i[u];if(h){const g=l.map(x=>x.presence_ref),p=h.map(x=>x.presence_ref),S=l.filter(x=>p.indexOf(x.presence_ref)<0),w=h.filter(x=>g.indexOf(x.presence_ref)<0);S.length>0&&(a[u]=S),w.length>0&&(c[u]=w)}else a[u]=l}),this.syncDiff(i,{joins:a,leaves:c},r,n)}static syncDiff(e,s,r,n){const{joins:i,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(a,c)=>{var u;const l=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(c),l.length>0){const h=e[a].map(p=>p.presence_ref),g=l.filter(p=>h.indexOf(p.presence_ref)<0);e[a].unshift(...g)}r(a,l,c)}),this.map(o,(a,c)=>{let u=e[a];if(!u)return;const l=c.map(h=>h.presence_ref);u=u.filter(h=>l.indexOf(h.presence_ref)<0),e[a]=u,n(a,u,c),u.length===0&&delete e[a]}),e}static map(e,s){return Object.getOwnPropertyNames(e).map(r=>s(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((s,r)=>{const n=e[r];return"metas"in n?s[r]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[r]=n,s},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ti;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ti||(Ti={}));var ys;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(ys||(ys={}));var et;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(et||(et={}));class $n{constructor(e,s={config:{}},r){this.topic=e,this.params=s,this.socket=r,this.bindings={},this.state=de.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new jr(this,Le.join,this.params,this.timeout),this.rejoinTimer=new ia(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=de.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=de.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=de.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=de.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=de.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Le.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new ms(this),this.broadcastEndpointURL=aa(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,s=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.state==de.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params,c=(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&n!==void 0?n:[],u=!!this.bindings[ys.PRESENCE]&&this.bindings[ys.PRESENCE].length>0,l={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this._onError(g=>e==null?void 0:e(et.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(et.CLOSED)),this.updateJoinPayload(Object.assign({config:h},l)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:g})=>{var p;if(this.socket.setAuth(),g===void 0){e==null||e(et.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,w=(p=S==null?void 0:S.length)!==null&&p!==void 0?p:0,x=[];for(let O=0;O<w;O++){const P=S[O],{filter:{event:v,schema:C,table:N,filter:W}}=P,K=g&&g[O];if(K&&K.event===v&&K.schema===C&&K.table===N&&K.filter===W)x.push(Object.assign(Object.assign({},P),{id:K.id}));else{this.unsubscribe(),this.state=de.errored,e==null||e(et.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(et.SUBSCRIBED);return}}).receive("error",g=>{this.state=de.errored,e==null||e(et.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(et.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,s={}){return await this.send({type:"presence",event:"track",payload:e},s.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,s,r){return this.state===de.joined&&e===ys.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,s,r)}async send(e,s={}){var r,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=u.body)===null||n===void 0?void 0:n.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,c;const u=this._push(e.type,e,s.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=de.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Le.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new jr(this,Le.leave,{},e),r.receive("ok",()=>{s(),n("ok")}).receive("timeout",()=>{s(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=de.closed,this.bindings={}}async _fetchWithTimeout(e,s,r){const n=new AbortController,i=setTimeout(()=>n.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},s),{signal:n.signal}));return clearTimeout(i),o}_push(e,s,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new jr(this,e,s,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>ch){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(e,s,r){return s}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,s,r){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:c,leave:u,join:l}=Le;if(r&&[a,c,u,l].indexOf(o)>=0&&r!==this._joinRef())return;let g=this._onMessage(o,s,r);if(s&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var S,w,x;return((S=p.filter)===null||S===void 0?void 0:S.event)==="*"||((x=(w=p.filter)===null||w===void 0?void 0:w.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(p=>p.callback(g,r)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var S,w,x,O,P,v;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const C=p.id,N=(S=p.filter)===null||S===void 0?void 0:S.event;return C&&((w=s.ids)===null||w===void 0?void 0:w.includes(C))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((x=s.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const C=(P=(O=p==null?void 0:p.filter)===null||O===void 0?void 0:O.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return C==="*"||C===((v=s==null?void 0:s.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof g=="object"&&"ids"in g){const S=g.data,{schema:w,table:x,commit_timestamp:O,type:P,errors:v}=S;g=Object.assign(Object.assign({},{schema:w,table:x,commit_timestamp:O,eventType:P,new:{},old:{},errors:v}),this._getPayloadRecords(S))}p.callback(g,r)})}_isClosed(){return this.state===de.closed}_isJoined(){return this.state===de.joined}_isJoining(){return this.state===de.joining}_isLeaving(){return this.state===de.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,s,r){const n=e.toLocaleLowerCase(),i={type:n,filter:s,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,s){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&$n.isEqual(n.filter,s))})),this}static isEqual(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const r in e)if(e[r]!==s[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Le.close,{},e)}_onError(e){this._on(Le.error,{},s=>e(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=de.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const s={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(s.new=Si(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(s.old=Si(e.columns,e.old_record)),s}}const ki=()=>{},Ms={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},vh=[1e3,2e3,5e3,1e4],_h=1e4,mh=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class yh{constructor(e,s){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Zr,this.transport=null,this.heartbeatIntervalMs=Ms.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ki,this.ref=0,this.reconnectTimer=null,this.logger=ki,this.conn=null,this.sendBuffer=[],this.serializer=new lh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let i;return n?i=n:typeof fetch>"u"?i=(...o)=>$s(async()=>{const{default:a}=await Promise.resolve().then(()=>Qt);return{default:a}},void 0).then(({default:a})=>a(...o)).catch(a=>{throw new Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((r=s==null?void 0:s.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${e}/${en.websocket}`,this.httpEndpoint=aa(e),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s==null?void 0:s.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rh.createWebSocket(this.endpointURL())}catch(e){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${e.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:oh}))}disconnect(e,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,s??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const s=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const e=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,s,r){this.logger(e,s,r)}connectionState(){switch(this.conn&&this.conn.readyState){case _s.connecting:return At.Connecting;case _s.open:return At.Open;case _s.closing:return At.Closing;default:return At.Closed}}isConnected(){return this.connectionState()===At.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,s={config:{}}){const r=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===r);if(n)return n;{const i=new $n(`realtime:${e}`,s,this);return this.channels.push(i),i}}push(e){const{topic:s,event:r,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${s} ${r} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(ah,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Ms.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let s=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${e}"`),s.unsubscribe())}_remove(e){this.channels=this.channels.filter(s=>s.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,s=>{s.topic==="phoenix"&&s.event==="phx_reply"&&this.heartbeatCallback(s.payload.status==="ok"?"ok":"error"),s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:n,payload:i,ref:o}=s,a=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${n} ${a}`.trim(),i),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(n,i,o)),this._triggerStateCallbacks("message",s)})}_clearTimer(e){var s;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var s;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Le.error))}_appendParams(e,s){if(Object.keys(s).length===0)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(s);return`${e}${r}${n}`}_workerObjectUrl(e){let s;if(e)s=e;else{const r=new Blob([mh],{type:"application/javascript"});s=URL.createObjectURL(r)}return s}_setConnectionState(e,s=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(e=null){let s;e?s=e:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(r=>{const n={access_token:s,version:ih};s&&r.updateJoinPayload(n),r.joinedOnce&&r._isJoined()&&r._push(Le.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${e}`,s)})}_triggerStateCallbacks(e,s){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(s)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new ia(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ms.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var s,r,n,i,o,a,c,u;if(this.transport=(s=e==null?void 0:e.transport)!==null&&s!==void 0?s:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Zr,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:Ms.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(a=e==null?void 0:e.reconnectAfterMs)!==null&&a!==void 0?a:l=>vh[l-1]||_h,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(l,h)=>h(JSON.stringify(l)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Un extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function fe(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class wh extends Un{constructor(e,s,r){super(e),this.name="StorageApiError",this.status=s,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class sn extends Un{constructor(e,s){super(e),this.name="StorageUnknownError",this.originalError=s}}var bh=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(h){o(h)}}function c(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})};const ca=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...s)=>$s(async()=>{const{default:r}=await Promise.resolve().then(()=>Qt);return{default:r}},void 0).then(({default:r})=>r(...s)):e=fetch,(...s)=>e(...s)},Sh=()=>bh(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $s(()=>Promise.resolve().then(()=>Qt),void 0)).Response:Response}),rn=t=>{if(Array.isArray(t))return t.map(s=>rn(s));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([s,r])=>{const n=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=rn(r)}),e},Eh=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var jt=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(h){o(h)}}function c(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})};const Ir=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Th=(t,e,s)=>jt(void 0,void 0,void 0,function*(){const r=yield Sh();t instanceof r&&!(s!=null&&s.noResolveJson)?t.json().then(n=>{const i=t.status||500,o=(n==null?void 0:n.statusCode)||i+"";e(new wh(Ir(n),i,o))}).catch(n=>{e(new sn(Ir(n),n))}):e(new sn(Ir(t),t))}),kh=(t,e,s,r)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?n:(Eh(r)?(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(r)):n.body=r,Object.assign(Object.assign({},n),s))};function Ds(t,e,s,r,n,i){return jt(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(s,kh(e,r,n,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Th(c,a,r))})})}function sr(t,e,s,r){return jt(this,void 0,void 0,function*(){return Ds(t,"GET",e,s,r)})}function tt(t,e,s,r,n){return jt(this,void 0,void 0,function*(){return Ds(t,"POST",e,r,n,s)})}function nn(t,e,s,r,n){return jt(this,void 0,void 0,function*(){return Ds(t,"PUT",e,r,n,s)})}function Ch(t,e,s,r){return jt(this,void 0,void 0,function*(){return Ds(t,"HEAD",e,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}function la(t,e,s,r,n){return jt(this,void 0,void 0,function*(){return Ds(t,"DELETE",e,r,n,s)})}var ke=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(h){o(h)}}function c(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})};const Ah={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ci={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ph{constructor(e,s={},r,n){this.url=e,this.headers=s,this.bucketId=r,this.fetch=ca(n)}uploadOrUpdate(e,s,r,n){return ke(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ci),n);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,c&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(a=Object.assign(Object.assign({},a),n.headers));const u=this._removeEmptyFolders(s),l=this._getFinalPath(u),h=yield(e=="PUT"?nn:tt)(this.fetch,`${this.url}/object/${l}`,i,Object.assign({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(fe(i))return{data:null,error:i};throw i}})}upload(e,s,r){return ke(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,s,r)})}uploadToSignedUrl(e,s,r,n){return ke(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",s);try{let c;const u=Object.assign({upsert:Ci.upsert},n),l=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,l["cache-control"]=`max-age=${u.cacheControl}`,l["content-type"]=u.contentType);const h=yield nn(this.fetch,a.toString(),c,{headers:l});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(fe(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,s){return ke(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);s!=null&&s.upsert&&(n["x-upsert"]="true");const i=yield tt(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Un("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}})}update(e,s,r){return ke(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,s,r)})}move(e,s,r){return ke(this,void 0,void 0,function*(){try{return{data:yield tt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}})}copy(e,s,r){return ke(this,void 0,void 0,function*(){try{return{data:{path:(yield tt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}})}createSignedUrl(e,s,r){return ke(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield tt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:s},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}})}createSignedUrls(e,s,r){return ke(this,void 0,void 0,function*(){try{const n=yield tt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}})}download(e,s){return ke(this,void 0,void 0,function*(){const n=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield sr(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(fe(a))return{data:null,error:a};throw a}})}info(e){return ke(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{const r=yield sr(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:rn(r),error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}})}exists(e){return ke(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{return yield Ch(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(fe(r)&&r instanceof sn){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,s){const r=this._getFinalPath(e),n=[],i=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";i!==""&&n.push(i);const a=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});c!==""&&n.push(c);let u=n.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${u}`)}}}remove(e){return ke(this,void 0,void 0,function*(){try{return{data:yield la(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(s){if(fe(s))return{data:null,error:s};throw s}})}list(e,s,r){return ke(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Ah),s),{prefix:e||""});return{data:yield tt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(fe(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const s=[];return e.width&&s.push(`width=${e.width}`),e.height&&s.push(`height=${e.height}`),e.resize&&s.push(`resize=${e.resize}`),e.format&&s.push(`format=${e.format}`),e.quality&&s.push(`quality=${e.quality}`),s.join("&")}}const xh="2.10.4",Oh={"X-Client-Info":`storage-js/${xh}`};var Ut=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(h){o(h)}}function c(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})};class Rh{constructor(e,s={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},Oh),s),this.fetch=ca(r)}listBuckets(){return Ut(this,void 0,void 0,function*(){try{return{data:yield sr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(fe(e))return{data:null,error:e};throw e}})}getBucket(e){return Ut(this,void 0,void 0,function*(){try{return{data:yield sr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(s){if(fe(s))return{data:null,error:s};throw s}})}createBucket(e,s={public:!1}){return Ut(this,void 0,void 0,function*(){try{return{data:yield tt(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}})}updateBucket(e,s){return Ut(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(fe(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Ut(this,void 0,void 0,function*(){try{return{data:yield tt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(fe(s))return{data:null,error:s};throw s}})}deleteBucket(e){return Ut(this,void 0,void 0,function*(){try{return{data:yield la(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(s){if(fe(s))return{data:null,error:s};throw s}})}}class jh extends Rh{constructor(e,s={},r,n){super(e,s,r,n)}from(e){return new Ph(this.url,this.headers,e,this.fetch)}}const Ih="2.54.0";let os="";typeof Deno<"u"?os="deno":typeof document<"u"?os="web":typeof navigator<"u"&&navigator.product==="ReactNative"?os="react-native":os="node";const $h={"X-Client-Info":`supabase-js-${os}/${Ih}`},Uh={headers:$h},Dh={schema:"public"},Lh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Nh={};var Fh=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(h){o(h)}}function c(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})};const qh=t=>{let e;return t?e=t:typeof fetch>"u"?e=Go:e=fetch,(...s)=>e(...s)},Mh=()=>typeof Headers>"u"?Qo:Headers,Bh=(t,e,s)=>{const r=qh(s),n=Mh();return(i,o)=>Fh(void 0,void 0,void 0,function*(){var a;const c=(a=yield e())!==null&&a!==void 0?a:t;let u=new n(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var Hh=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(h){o(h)}}function c(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})};function Wh(t){return t.endsWith("/")?t:t+"/"}function Kh(t,e){var s,r;const{db:n,auth:i,realtime:o,global:a}=t,{db:c,auth:u,realtime:l,global:h}=e,g={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},l),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(s=h==null?void 0:h.headers)!==null&&s!==void 0?s:{}),(r=a==null?void 0:a.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Hh(this,void 0,void 0,function*(){return""})};return t.accessToken?g.accessToken=t.accessToken:delete g.accessToken,g}const ua="2.71.1",Bt=30*1e3,on=3,$r=on*Bt,Vh="http://localhost:9999",zh="supabase.auth.token",Gh={"X-Client-Info":`gotrue-js/${ua}`},an="X-Supabase-Api-Version",ha={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Qh=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Jh=10*60*1e3;class Dn extends Error{constructor(e,s,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=r}}function z(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Yh extends Dn{constructor(e,s,r){super(e,s,r),this.name="AuthApiError",this.status=s,this.code=r}}function Xh(t){return z(t)&&t.name==="AuthApiError"}class da extends Dn{constructor(e,s){super(e),this.name="AuthUnknownError",this.originalError=s}}class yt extends Dn{constructor(e,s,r,n){super(e,r,n),this.name=s,this.status=r}}class dt extends yt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Zh(t){return z(t)&&t.name==="AuthSessionMissingError"}class Bs extends yt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Hs extends yt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ws extends yt{constructor(e,s=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ed(t){return z(t)&&t.name==="AuthImplicitGrantRedirectError"}class Ai extends yt{constructor(e,s=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cn extends yt{constructor(e,s){super(e,"AuthRetryableFetchError",s,void 0)}}function Ur(t){return z(t)&&t.name==="AuthRetryableFetchError"}class Pi extends yt{constructor(e,s,r){super(e,"AuthWeakPasswordError",s,"weak_password"),this.reasons=r}}class ln extends yt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const rr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),xi=` 	
\r=`.split(""),td=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<xi.length;e+=1)t[xi[e].charCodeAt(0)]=-2;for(let e=0;e<rr.length;e+=1)t[rr[e].charCodeAt(0)]=e;return t})();function Oi(t,e,s){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;s(rr[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;s(rr[r]),e.queuedBits-=6}}function fa(t,e,s){const r=td[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)s(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Ri(t){const e=[],s=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{nd(o,r,s)};for(let o=0;o<t.length;o+=1)fa(t.charCodeAt(o),n,i);return e.join("")}function sd(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function rd(t,e){for(let s=0;s<t.length;s+=1){let r=t.charCodeAt(s);if(r>55295&&r<=56319){const n=(r-55296)*1024&65535;r=(t.charCodeAt(s+1)-56320&65535|n)+65536,s+=1}sd(r,e)}}function nd(t,e,s){if(e.utf8seq===0){if(t<=127){s(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&s(e.codepoint)}}function id(t){const e=[],s={queue:0,queuedBits:0},r=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)fa(t.charCodeAt(n),s,r);return new Uint8Array(e)}function od(t){const e=[];return rd(t,s=>e.push(s)),new Uint8Array(e)}function ad(t){const e=[],s={queue:0,queuedBits:0},r=n=>{e.push(n)};return t.forEach(n=>Oi(n,s,r)),Oi(null,s,r),e.join("")}function cd(t){return Math.round(Date.now()/1e3)+t}function ld(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const De=()=>typeof window<"u"&&typeof document<"u",Et={tested:!1,writable:!1},ga=()=>{if(!De())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Et.tested)return Et.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Et.tested=!0,Et.writable=!0}catch{Et.tested=!0,Et.writable=!1}return Et.writable};function ud(t){const e={},s=new URL(t);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return s.searchParams.forEach((r,n)=>{e[n]=r}),e}const pa=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...s)=>$s(async()=>{const{default:r}=await Promise.resolve().then(()=>Qt);return{default:r}},void 0).then(({default:r})=>r(...s)):e=fetch,(...s)=>e(...s)},hd=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ht=async(t,e,s)=>{await t.setItem(e,JSON.stringify(s))},Tt=async(t,e)=>{const s=await t.getItem(e);if(!s)return null;try{return JSON.parse(s)}catch{return s}},ut=async(t,e)=>{await t.removeItem(e)};class yr{constructor(){this.promise=new yr.promiseConstructor((e,s)=>{this.resolve=e,this.reject=s})}}yr.promiseConstructor=Promise;function Dr(t){const e=t.split(".");if(e.length!==3)throw new ln("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Qh.test(e[r]))throw new ln("JWT not in base64url format");return{header:JSON.parse(Ri(e[0])),payload:JSON.parse(Ri(e[1])),signature:id(e[2]),raw:{header:e[0],payload:e[1]}}}async function dd(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function fd(t,e){return new Promise((r,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function gd(t){return("0"+t.toString(16)).substr(-2)}function pd(){const e=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=s.length;let n="";for(let i=0;i<56;i++)n+=s.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(e),Array.from(e,gd).join("")}async function vd(t){const s=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",s),n=new Uint8Array(r);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function _d(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const s=await vd(t);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Dt(t,e,s=!1){const r=pd();let n=r;s&&(n+="/PASSWORD_RECOVERY"),await Ht(t,`${e}-code-verifier`,n);const i=await _d(r);return[i,r===i?"plain":"s256"]}const md=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function yd(t){const e=t.headers.get(an);if(!e||!e.match(md))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function wd(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function bd(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Sd=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Lt(t){if(!Sd.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Lr(){const t={};return new Proxy(t,{get:(e,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const r=s.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ji(t){return JSON.parse(JSON.stringify(t))}var Ed=function(t,e){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(s[r[n]]=t[r[n]]);return s};const Ct=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Td=[502,503,504];async function Ii(t){var e;if(!hd(t))throw new cn(Ct(t),0);if(Td.includes(t.status))throw new cn(Ct(t),t.status);let s;try{s=await t.json()}catch(i){throw new da(Ct(i),i)}let r;const n=yd(t);if(n&&n.getTime()>=ha["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?r=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(r=s.error_code),r){if(r==="weak_password")throw new Pi(Ct(s),t.status,((e=s.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new dt}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Pi(Ct(s),t.status,s.weak_password.reasons);throw new Yh(Ct(s),t.status||500,r)}const kd=(t,e,s,r)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),s))};async function Q(t,e,s,r){var n;const i=Object.assign({},r==null?void 0:r.headers);i[an]||(i[an]=ha["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Cd(t,e,s+a,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function Cd(t,e,s,r,n,i){const o=kd(e,r,n,i);let a;try{a=await t(s,Object.assign({},o))}catch(c){throw console.error(c),new cn(Ct(c),0)}if(a.ok||await Ii(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(c){await Ii(c)}}function Xe(t){var e;let s=null;Od(t)&&(s=Object.assign({},t),t.expires_at||(s.expires_at=cd(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:s,user:r},error:null}}function $i(t){const e=Xe(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((s,r)=>s&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function vt(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Ad(t){return{data:t,error:null}}function Pd(t){const{action_link:e,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i}=t,o=Ed(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i},c=Object.assign({},o);return{data:{properties:a,user:c},error:null}}function xd(t){return t}function Od(t){return t.access_token&&t.refresh_token&&t.expires_in}const Nr=["global","local","others"];var Rd=function(t,e){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(s[r[n]]=t[r[n]]);return s};class jd{constructor({url:e="",headers:s={},fetch:r}){this.url=e,this.headers=s,this.fetch=pa(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,s=Nr[0]){if(Nr.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Nr.join(", ")}`);try{return await Q(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(z(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,s={}){try{return await Q(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:vt})}catch(r){if(z(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:s}=e,r=Rd(e,["options"]),n=Object.assign(Object.assign({},r),s);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),await Q(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Pd,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(z(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(e){try{return await Q(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:vt})}catch(s){if(z(s))return{data:{user:null},error:s};throw s}}async listUsers(e){var s,r,n,i,o,a,c;try{const u={nextPage:null,lastPage:0,total:0},l=await Q(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(s=e==null?void 0:e.page)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:xd});if(l.error)throw l.error;const h=await l.json(),g=(o=l.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(a=l.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(S=>{const w=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(S.split(";")[1].split("=")[1]);u[`${x}Page`]=w}),u.total=parseInt(g)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(z(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Lt(e);try{return await Q(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:vt})}catch(s){if(z(s))return{data:{user:null},error:s};throw s}}async updateUserById(e,s){Lt(e);try{return await Q(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:s,headers:this.headers,xform:vt})}catch(r){if(z(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,s=!1){Lt(e);try{return await Q(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:s},xform:vt})}catch(r){if(z(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Lt(e.userId);try{const{data:s,error:r}=await Q(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:s,error:r}}catch(s){if(z(s))return{data:null,error:s};throw s}}async _deleteFactor(e){Lt(e.userId),Lt(e.id);try{return{data:await Q(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(s){if(z(s))return{data:null,error:s};throw s}}}function Ui(t={}){return{getItem:e=>t[e]||null,setItem:(e,s)=>{t[e]=s},removeItem:e=>{delete t[e]}}}function Id(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Nt={debug:!!(globalThis&&ga()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class va extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class $d extends va{}async function Ud(t,e,s){Nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Nt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){Nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await s()}finally{Nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Nt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new $d(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Nt.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}Id();const Dd={url:Vh,storageKey:zh,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Gh,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Di(t,e,s){return await s()}const Ft={};class As{constructor(e){var s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=As.nextInstanceID,As.nextInstanceID+=1,this.instanceID>0&&De()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Dd),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new jd({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=pa(n.fetch),this.lock=n.lock||Di,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:De()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=Ud:this.lock=Di,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:ga()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ui(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Ui(this.memoryStorage)),De()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,s;return(s=(e=Ft[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(e){Ft[this.storageKey]=Object.assign(Object.assign({},Ft[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,s;return(s=(e=Ft[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ft[this.storageKey]=Object.assign(Object.assign({},Ft[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ua}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const s=ud(window.location.href);let r="none";if(this._isImplicitGrantCallback(s)?r="implicit":await this._isPKCECallback(s)&&(r="pkce"),De()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:i}=await this._getSessionFromURL(s,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),ed(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return z(s)?{error:s}:{error:new da("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var s,r,n;try{const i=await Q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Xe}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(z(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var s,r,n;try{let i;if("email"in e){const{email:l,password:h,options:g}=e;let p=null,S=null;this.flowType==="pkce"&&([p,S]=await Dt(this.storage,this.storageKey)),i=await Q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:l,password:h,data:(s=g==null?void 0:g.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:p,code_challenge_method:S},xform:Xe})}else if("phone"in e){const{phone:l,password:h,options:g}=e;i=await Q(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:l,password:h,data:(r=g==null?void 0:g.data)!==null&&r!==void 0?r:{},channel:(n=g==null?void 0:g.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:Xe})}else throw new Hs("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(z(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let s;if("email"in e){const{email:i,password:o,options:a}=e;s=await Q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:$i})}else if("phone"in e){const{phone:i,password:o,options:a}=e;s=await Q(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:$i})}else throw new Hs("You must provide either an email or phone number and a password");const{data:r,error:n}=s;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Bs}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(s){if(z(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(e){var s,r,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:s}=e;if(s==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}async signInWithSolana(e){var s,r,n,i,o,a,c,u,l,h,g,p;let S,w;if("message"in e)S=e.message,w=e.signature;else{const{chain:x,wallet:O,statement:P,options:v}=e;let C;if(De())if(typeof O=="object")C=O;else{const W=window;if("solana"in W&&typeof W.solana=="object"&&("signIn"in W.solana&&typeof W.solana.signIn=="function"||"signMessage"in W.solana&&typeof W.solana.signMessage=="function"))C=W.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=O}const N=new URL((s=v==null?void 0:v.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in C&&C.signIn){const W=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),P?{statement:P}:null));let K;if(Array.isArray(W)&&W[0]&&typeof W[0]=="object")K=W[0];else if(W&&typeof W=="object"&&"signedMessage"in W&&"signature"in W)K=W;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in K&&"signature"in K&&(typeof K.signedMessage=="string"||K.signedMessage instanceof Uint8Array)&&K.signature instanceof Uint8Array)S=typeof K.signedMessage=="string"?K.signedMessage:new TextDecoder().decode(K.signedMessage),w=K.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${N.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...P?["",P,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(n=(r=v==null?void 0:v.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((u=v==null?void 0:v.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((h=(l=v==null?void 0:v.signInWithSolana)===null||l===void 0?void 0:l.resources)===null||h===void 0)&&h.length?["Resources",...v.signInWithSolana.resources.map(K=>`- ${K}`)]:[]].join(`
`);const W=await C.signMessage(new TextEncoder().encode(S),"utf8");if(!W||!(W instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=W}}try{const{data:x,error:O}=await Q(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:ad(w)},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Xe});if(O)throw O;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new Bs}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:O})}catch(x){if(z(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(e){const s=await Tt(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(s??"").split("/");try{const{data:i,error:o}=await Q(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Xe});if(await ut(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Bs}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(z(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:s,provider:r,token:n,access_token:i,nonce:o}=e,a=await Q(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:Xe}),{data:c,error:u}=a;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Bs}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(s){if(z(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(e){var s,r,n,i,o;try{if("email"in e){const{email:a,options:c}=e;let u=null,l=null;this.flowType==="pkce"&&([u,l]=await Dt(this.storage,this.storageKey));const{error:h}=await Q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:l},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:c}=e,{data:u,error:l}=await Q(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:l}}throw new Hs("You must provide either an email or phone number.")}catch(a){if(z(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var s,r;try{let n,i;"options"in e&&(n=(s=e.options)===null||s===void 0?void 0:s.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await Q(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Xe});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(n){if(z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var s,r,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Dt(this.storage,this.storageKey)),await Q(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(s=e.options)===null||s===void 0?void 0:s.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Ad})}catch(i){if(z(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:s},error:r}=e;if(r)throw r;if(!s)throw new dt;const{error:n}=await Q(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(z(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const s=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:i}=e,{error:o}=await Q(this.fetch,"POST",s,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:n,options:i}=e,{data:o,error:a}=await Q(this.fetch,"POST",s,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Hs("You must provide either an email or phone number and a type")}catch(s){if(z(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(e,s){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await s()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=s();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await e(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const s=await Tt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?e=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<$r:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Tt(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Lr()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,l)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,l))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:vt}):await this._useSession(async s=>{var r,n,i;const{data:o,error:a}=s;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new dt}:await Q(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:vt})})}catch(s){if(z(s))return Zh(s)&&(await this._removeSession(),await ut(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(e,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,s))}async _updateUser(e,s={}){try{return await this._useSession(async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new dt;const o=n.session;let a=null,c=null;this.flowType==="pkce"&&e.email!=null&&([a,c]=await Dt(this.storage,this.storageKey));const{data:u,error:l}=await Q(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:c}),jwt:o.access_token,xform:vt});if(l)throw l;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(z(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new dt;const s=Date.now()/1e3;let r=s,n=!0,i=null;const{payload:o}=Dr(e.access_token);if(o.exp&&(r=o.exp,n=r<=s),n){const{session:a,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-s,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(s){if(z(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async s=>{var r;if(!e){const{data:o,error:a}=s;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new dt;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(z(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(e,s){try{if(!De())throw new Ws("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ws(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Ai("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ws("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ai("No code detected.");const{data:P,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:c,token_type:u}=e;if(!i||!a||!o||!u)throw new Ws("No session defined in URL");const l=Math.round(Date.now()/1e3),h=parseInt(a);let g=l+h;c&&(g=parseInt(c));const p=g-l;p*1e3<=Bt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const S=g-h;l-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,g,l):l-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,g,l);const{data:w,error:x}=await this._getUser(i);if(x)throw x;const O={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:g,refresh_token:o,token_type:u,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:O,redirectType:e.type},error:null}}catch(r){if(z(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const s=await Tt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&s)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async s=>{var r;const{data:n,error:i}=s;if(i)return{error:i};const o=(r=n.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Xh(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await ut(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const s=ld(),r={id:s,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async s=>{var r,n;try{const{data:{session:i},error:o}=s;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,s={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await Dt(this.storage,this.storageKey,!0));try{return await Q(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(i){if(z(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:s,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=s.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(s){if(z(s))return{data:null,error:s};throw s}}async linkIdentity(e){var s;try{const{data:r,error:n}=await this._useSession(async i=>{var o,a,c,u,l;const{data:h,error:g}=i;if(g)throw g;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Q(this.fetch,"GET",p,{headers:this.headers,jwt:(l=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&l!==void 0?l:void 0})});if(n)throw n;return De()&&!(!((s=e.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(z(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async s=>{var r,n;const{data:i,error:o}=s;if(o)throw o;return await Q(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(s){if(z(s))return{data:null,error:s};throw s}}async _refreshAccessToken(e){const s=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{const r=Date.now();return await fd(async n=>(n>0&&await dd(200*Math.pow(2,n-1)),this._debug(s,"refreshing attempt",n),await Q(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Xe})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Ur(i)&&Date.now()+o-r<Bt})}catch(r){if(this._debug(s,"error",r),z(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(s,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,s){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",s,"url",r),De()&&!s.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,s;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Tt(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Tt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await Ht(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Lr()}else if(n&&!n.user&&!n.user){const o=await Tt(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(n.user=o.user,await ut(this.storage,this.storageKey+"-user"),await Ht(this.storage,this.storageKey,n)):n.user=Lr()}if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((s=n.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<$r;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${$r}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),Ur(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(n.access_token);!a&&(o!=null&&o.user)?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var s,r;if(!e)throw new dt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new yr;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new dt;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),z(i)){const o={session:null,error:i};return Ur(i)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,s,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",s,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:s});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,s)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const s=Object.assign({},e),r=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&s.user&&await Ht(this.userStorage,this.storageKey+"-user",{user:s.user});const n=Object.assign({},s);delete n.user;const i=ji(n);await Ht(this.storage,this.storageKey,i)}else{const n=ji(s);await Ht(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await ut(this.storage,this.storageKey),await ut(this.storage,this.storageKey+"-code-verifier"),await ut(this.storage,this.storageKey+"-user"),this.userStorage&&await ut(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&De()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Bt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async s=>{const{data:{session:r}}=s;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-e)/Bt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Bt}ms, refresh threshold is ${on} ticks`),n<=on&&await this._callRefreshToken(r.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof va)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!De()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const s=`#_onVisibilityChanged(${e})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,s,r){const n=[`provider=${encodeURIComponent(s)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Dt(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;return i?{data:null,error:i}:await Q(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(z(s))return{data:null,error:s};throw s}}async _enroll(e){try{return await this._useSession(async s=>{var r,n;const{data:i,error:o}=s;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await Q(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(s){if(z(s))return{data:null,error:s};throw s}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;if(i)return{data:null,error:i};const{data:o,error:a}=await Q(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(s){if(z(s))return{data:null,error:s};throw s}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;return i?{data:null,error:i}:await Q(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(z(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(e){const{data:s,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:s.id,code:e.code})}async _listFactors(){const{data:{user:e},error:s}=await this.getUser();if(s)return{data:null,error:s};const r=(e==null?void 0:e.factors)||[],n=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var s,r;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Dr(n.access_token);let a=null;o.aal&&(a=o.aal);let c=a;((r=(s=n.user.factors)===null||s===void 0?void 0:s.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const l=o.amr||[];return{data:{currentLevel:a,nextLevel:c,currentAuthenticationMethods:l},error:null}}))}async fetchJwk(e,s={keys:[]}){let r=s.keys.find(a=>a.kid===e);if(r)return r;const n=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+Jh>n)return r;const{data:i,error:o}=await Q(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,r=i.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,s={}){try{let r=e;if(!r){const{data:p,error:S}=await this.getSession();if(S||!p.session)return{data:null,error:S};r=p.session.access_token}const{header:n,payload:i,signature:o,raw:{header:a,payload:c}}=Dr(r);s!=null&&s.allowExpired||wd(i.exp);const u=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!u){const{error:p}=await this.getUser(r);if(p)throw p;return{data:{claims:i,header:n,signature:o},error:null}}const l=bd(n.alg),h=await crypto.subtle.importKey("jwk",u,l,!0,["verify"]);if(!await crypto.subtle.verify(l,h,o,od(`${a}.${c}`)))throw new ln("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(r){if(z(r))return{data:null,error:r};throw r}}}As.nextInstanceID=0;const Ld=As;class Nd extends Ld{constructor(e){super(e)}}var Fd=function(t,e,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(h){o(h)}}function c(l){try{u(r.throw(l))}catch(h){o(h)}}function u(l){l.done?i(l.value):n(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})};class qd{constructor(e,s,r){var n,i,o;if(this.supabaseUrl=e,this.supabaseKey=s,!e)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const a=Wh(e),c=new URL(a);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,l={db:Dh,realtime:Nh,auth:Object.assign(Object.assign({},Lh),{storageKey:u}),global:Uh},h=Kh(r??{},l);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=Bh(s,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new sh(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new jh(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new Ru(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,s={},r={}){return this.rest.rpc(e,s,r)}channel(e,s={config:{}}){return this.realtime.channel(e,s)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,s;return Fd(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(s=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&s!==void 0?s:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:s,detectSessionInUrl:r,storage:n,storageKey:i,flowType:o,lock:a,debug:c},u,l){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Nd({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:e,persistSession:s,detectSessionInUrl:r,storage:n,flowType:o,lock:a,debug:c,fetch:l,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new yh(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,r)=>{this._handleTokenChanged(s,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,s,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Md=(t,e,s)=>new qd(t,e,s);function Bd(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Bd()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Hd=()=>({supabaseUrl:"https://your-project.supabase.co",supabaseAnonKey:"your_production_anon_key_here",timeout:parseInt("30000"),retryAttempts:parseInt("3"),retryDelay:parseInt("1000"),enableCache:!0}),ws=Hd(),ne=Md(ws.supabaseUrl,ws.supabaseAnonKey,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1,storage:{getItem:t=>uni.getStorageSync(t),setItem:(t,e)=>{uni.setStorageSync(t,e)},removeItem:t=>{uni.removeStorageSync(t)}}},global:{headers:{"X-Client-Info":"yessales-uniapp","X-Client-Version":"1.0.0"}}}),Wd=()=>(console.log("✅ API 配置验证通过"),!0),qt={UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",NOT_FOUND:"NOT_FOUND",INVALID_INPUT:"INVALID_INPUT",DUPLICATE_ENTRY:"DUPLICATE_ENTRY",SERVER_ERROR:"SERVER_ERROR"},rs={BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,CONFLICT:409};class re{static init(){if(!Wd())throw new Error("API 配置验证失败，请检查环境变量");return this.addRequestInterceptor(e=>(console.log(`🚀 [API Request] ${e.method} ${e.table}`,e.options),e)),this.addResponseInterceptor(e=>(e.success?console.log("✅ [API Response] Success",e.data):console.error("❌ [API Response] Error",e.error),e)),!0}static addRequestInterceptor(e){this.requestInterceptors.push(e)}static addResponseInterceptor(e){this.responseInterceptors.push(e)}static async executeRequestInterceptors(e){let s=e;for(const r of this.requestInterceptors)s=await r(s);return s}static async executeResponseInterceptors(e){let s=e;for(const r of this.responseInterceptors)s=await r(s);return s}static getCacheKey(e,s,r){return`${e}_${s}_${JSON.stringify(r||{})}`}static getCache(e){const s=this.cache.get(e);return s&&Date.now()-s.timestamp<this.CACHE_TTL?(console.log("📦 [Cache Hit]",e),s.data):(s&&this.cache.delete(e),null)}static setCache(e,s){this.cache.set(e,{data:s,timestamp:Date.now()})}static clearExpiredCache(){const e=Date.now();for(const[s,r]of this.cache.entries())e-r.timestamp>=this.CACHE_TTL&&this.cache.delete(s)}static delay(e){return new Promise(s=>setTimeout(s,e))}static async handleError(e,s=1){console.error(`API Error (Attempt ${s}):`,e);let r={code:qt.SERVER_ERROR,message:"服务器错误，请稍后重试",details:e};return e.status===rs.UNAUTHORIZED?r={code:qt.UNAUTHORIZED,message:"未授权，请重新登录"}:e.status===rs.FORBIDDEN?r={code:qt.FORBIDDEN,message:"无权限访问该资源"}:e.status===rs.NOT_FOUND?r={code:qt.NOT_FOUND,message:"请求的资源不存在"}:e.status===rs.BAD_REQUEST?r={code:qt.INVALID_INPUT,message:e.message||"请求参数错误"}:e.status===rs.CONFLICT&&(r={code:qt.DUPLICATE_ENTRY,message:e.message||"数据已存在"}),{success:!1,error:r}}static async request(e,s,r){const n={method:e,table:s,options:r},i=await this.executeRequestInterceptors(n);if(e==="GET"&&(r==null?void 0:r.enableCache)!==!1){const o=this.getCacheKey(e,s,r),a=this.getCache(o);if(a)return this.executeResponseInterceptors(a)}return this.executeWithRetry(i)}static async executeWithRetry(e,s=1){try{const{method:r,table:n,options:i}=e,o=await this.executeRequest(r,n,i);if(o.success&&r==="GET"&&(i==null?void 0:i.enableCache)!==!1){const a=this.getCacheKey(r,n,i);this.setCache(a,o)}return this.executeResponseInterceptors(o)}catch(r){if(s<ws.retryAttempts&&this.shouldRetry(r))return console.log(`🔄 [API Retry] Attempt ${s+1}/${ws.retryAttempts}`),await this.delay(ws.retryDelay*s),this.executeWithRetry(e,s+1);const n=await this.handleError(r,s);return this.executeResponseInterceptors(n)}}static shouldRetry(e){return!e.status||e.status>=500||e.status===429}static async executeRequest(e,s,r){var i;let n=ne.from(s);if(e==="GET"&&(r!=null&&r.id)){const{data:o,error:a}=await n.select(r.select||"*").eq("id",r.id).single();if(a)throw a;return{success:!0,data:o}}if(e==="GET"){let o=n.select((r==null?void 0:r.select)||"*");r!=null&&r.query&&Object.entries(r.query).forEach(([l,h])=>{if(h!=null)if(l==="limit")o=o.limit(h);else if(l==="offset")o=o.range(h,h+(r.query.limit||20)-1);else if(l==="order"){const[g,p]=h.split(",");o=o.order(g,{ascending:p==="asc"})}else o=o.eq(l,h)});const{data:a,error:c,count:u}=await o;if(c)throw c;return{success:!0,data:a,pagination:(i=r==null?void 0:r.query)!=null&&i.page?{page:r.query.page,page_size:r.query.page_size||20,total:u||0}:void 0}}if(e==="POST"){const{data:o,error:a}=await n.insert(r==null?void 0:r.data).select().single();if(a)throw a;return{success:!0,data:o}}if(e==="PUT"&&(r!=null&&r.id)){const{data:o,error:a}=await n.update(r.data).eq("id",r.id).select().single();if(a)throw a;return{success:!0,data:o}}if(e==="DELETE"&&(r!=null&&r.id)){const{error:o}=await n.delete().eq("id",r.id);if(o)throw o;return{success:!0}}throw new Error("Invalid request parameters")}static async uploadFile(e,s,r){try{const{data:n,error:i}=await ne.storage.from(s).upload(r,e,{cacheControl:"3600",upsert:!1});if(i)throw i;const{data:{publicUrl:o}}=ne.storage.from(s).getPublicUrl(n.path);return{success:!0,data:{url:o}}}catch(n){return this.handleError(n)}}}Ve(re,"requestInterceptors",[]),Ve(re,"responseInterceptors",[]),Ve(re,"cache",new Map),Ve(re,"CACHE_TTL",5*60*1e3);class Ce{static async login(e){var s,r;try{const n=e.username.includes("@")?e.username:`${e.username}@yessales.local`,{data:i,error:o}=await ne.auth.signInWithPassword({email:n,password:e.password});if(o)throw o;if(!i.user||!i.session)throw new Error("登录失败");const{data:a,error:c}=await ne.from("users").select("*").eq("id",i.user.id).single();if(c)throw c;return{success:!0,data:{access_token:i.session.access_token,token_type:"bearer",expires_in:i.session.expires_in||3600,refresh_token:i.session.refresh_token,user:{id:a.id,username:a.username,role:a.role,name:a.name}}}}catch(n){console.error("Login error:",n);let i="登录失败，请检查用户名和密码";return(s=n.message)!=null&&s.includes("Invalid login credentials")?i="用户名或密码错误":(r=n.message)!=null&&r.includes("Email not confirmed")&&(i="账号未激活，请联系管理员"),{success:!1,error:{code:"UNAUTHORIZED",message:i}}}}static async logout(){try{const{error:e}=await ne.auth.signOut();if(e)throw e;return uni.removeStorageSync("supabase.auth.token"),{success:!0}}catch(e){return re.handleError(e)}}static async getCurrentUser(){try{const{data:{user:e}}=await ne.auth.getUser();if(!e)return{success:!0,data:null};const{data:s,error:r}=await ne.from("users").select("*").eq("id",e.id).single();if(r)throw r;return{success:!0,data:s}}catch(e){return re.handleError(e)}}static async refreshToken(){try{const{data:e,error:s}=await ne.auth.refreshSession();if(s)throw s;if(!e.session)throw new Error("刷新令牌失败");const{data:r,error:n}=await ne.from("users").select("*").eq("id",e.user.id).single();if(n)throw n;return{success:!0,data:{access_token:e.session.access_token,token_type:"bearer",expires_in:e.session.expires_in||3600,refresh_token:e.session.refresh_token,user:{id:r.id,username:r.username,role:r.role,name:r.name}}}}catch(e){return re.handleError(e)}}static async changePassword(e,s){try{const{error:r}=await ne.auth.updateUser({password:s});if(r)throw r;return{success:!0}}catch(r){return re.handleError(r)}}static isAuthenticated(){return!!uni.getStorageSync("supabase.auth.token")}static getAuthToken(){return uni.getStorageSync("supabase.auth.token")||null}}const nr=Is("auth",()=>{const t=G(null),e=G(null),s=G(!1),r=G(null),n=pe(()=>!!e.value&&!!t.value),i=pe(()=>{var w;return((w=t.value)==null?void 0:w.role)==="admin"}),o=pe(()=>{var w,x;return((w=t.value)==null?void 0:w.name)||((x=t.value)==null?void 0:x.username)||""});async function a(w){var x;s.value=!0,r.value=null;try{const O=await Ce.login(w);return O.success&&O.data?(t.value={id:O.data.user.id,username:O.data.user.username,role:O.data.user.role,name:O.data.user.name,is_active:!0,created_at:new Date().toISOString()},e.value=O.data.access_token,uni.setStorageSync("auth_token",O.data.access_token),uni.setStorageSync("auth_user",t.value),{success:!0}):(r.value=((x=O.error)==null?void 0:x.message)||"登录失败",{success:!1,error:r.value})}catch{return r.value="网络错误，请稍后重试",{success:!1,error:r.value}}finally{s.value=!1}}async function c(){s.value=!0,r.value=null;try{await Ce.logout()}catch(w){console.error("Logout error:",w)}finally{t.value=null,e.value=null,uni.removeStorageSync("auth_token"),uni.removeStorageSync("auth_user"),s.value=!1,uni.reLaunch({url:"/pages/admin/login/index"})}}async function u(){try{const w=await Ce.refreshToken();return w.success&&w.data?(e.value=w.data.access_token,uni.setStorageSync("auth_token",w.data.access_token),!0):!1}catch(w){return console.error("Refresh token error:",w),!1}}async function l(){const w=uni.getStorageSync("auth_token"),x=uni.getStorageSync("auth_user");if(w&&x){e.value=w,t.value=x;const O=await Ce.getCurrentUser();return O.success&&O.data?(t.value=O.data,!0):(await c(),!1)}return!1}async function h(w,x){var O;s.value=!0,r.value=null;try{const P=await Ce.changePassword(w,x);return P.success?{success:!0}:(r.value=((O=P.error)==null?void 0:O.message)||"修改密码失败",{success:!1,error:r.value})}catch{return r.value="网络错误，请稍后重试",{success:!1,error:r.value}}finally{s.value=!1}}async function g(){try{const w=await Ce.getCurrentUser();return w.success&&w.data&&(t.value=w.data,uni.setStorageSync("auth_user",w.data)),w}catch(w){return console.error("Get current user error:",w),{success:!1,error:{message:"获取用户信息失败"}}}}async function p(){await l()}async function S(){e.value&&!t.value&&await g()}return{user:t,token:e,isLoading:s,error:r,isAuthenticated:n,isAdmin:i,userName:o,login:a,logout:c,refreshToken:u,checkAuth:l,getCurrentUser:g,initializeAuth:p,checkAuthStatus:S,updatePassword:h}}),Li={PUBLIC:["pages/sales/index","pages/sales/quote/create","pages/sales/quote/preview","pages/sales/history/index","pages/sales/history/detail","pages/admin/login/index"],AUTHENTICATED:["pages/admin/dashboard/index"],MANAGER:["pages/admin/quotes/index","pages/admin/quotes/detail","pages/admin/products/index","pages/admin/products/edit","pages/admin/customers/index","pages/admin/customers/detail","pages/admin/customers/edit"],ADMIN_ONLY:["pages/admin/users/index","pages/admin/users/edit","pages/admin/logs/index","pages/admin/settings/index"]},Kd={admin:["PUBLIC","AUTHENTICATED","MANAGER","ADMIN_ONLY"],sales_manager:["PUBLIC","AUTHENTICATED","MANAGER"],sales_rep:["PUBLIC","AUTHENTICATED"],viewer:["PUBLIC","AUTHENTICATED"]};function Vd(t,e){if(Li.PUBLIC.includes(e))return!0;if(!t)return!1;const s=Kd[t.role]||[];for(const[r,n]of Object.entries(Li))if(n.includes(e))return s.includes(r);return!1}function zd(t,e){return t?"/pages/admin/dashboard/index":"/pages/admin/login/index"}async function Ks(t){try{const e=nr();if(!e.user&&e.token&&!(await e.getCurrentUser()).success)return e.logout(),{allowed:!1,redirectTo:"/pages/admin/login/index",reason:"Session expired"};const s=e.user;return Vd(s,t)?{allowed:!0}:{allowed:!1,redirectTo:zd(s,t),reason:s?"Insufficient permissions":"Authentication required"}}catch(e){return console.error("Route guard error:",e),{allowed:!1,redirectTo:"/pages/admin/login/index",reason:"Route guard error"}}}function Gd(){const t=uni.navigateTo,e=uni.redirectTo,s=uni.reLaunch,r=uni.switchTab;uni.navigateTo=async function(n){const i=n.url.split("?")[0],o=i.startsWith("/")?i.substring(1):i,a=await Ks(o);return a.allowed?t.call(this,n):(console.warn(`Route access denied: ${o} - ${a.reason}`),a.redirectTo?(uni.showToast({title:a.reason||"访问被拒绝",icon:"none",duration:2e3}),e.call(this,{url:a.redirectTo})):Promise.reject(new Error(a.reason)))},uni.redirectTo=async function(n){const i=n.url.split("?")[0],o=i.startsWith("/")?i.substring(1):i,a=await Ks(o);return!a.allowed&&a.redirectTo&&(console.warn(`Route access denied: ${o} - ${a.reason}`),n.url=a.redirectTo),e.call(this,n)},uni.reLaunch=async function(n){const i=n.url.split("?")[0],o=i.startsWith("/")?i.substring(1):i,a=await Ks(o);return!a.allowed&&a.redirectTo&&(console.warn(`Route access denied: ${o} - ${a.reason}`),n.url=a.redirectTo),s.call(this,n)},uni.switchTab=async function(n){const i=n.url.split("?")[0],o=i.startsWith("/")?i.substring(1):i,a=await Ks(o);return a.allowed?r.call(this,n):(console.warn(`Tab access denied: ${o} - ${a.reason}`),uni.showToast({title:a.reason||"访问被拒绝",icon:"none"}),Promise.reject(new Error(a.reason)))}}class je{static async getProducts(e){return re.request("GET","products",{query:{...e,is_active:!0},select:"*, skus:product_skus(*)"})}static async getProduct(e){return re.request("GET","products",{id:e,select:"*, skus:product_skus(*)"})}static async createProduct(e){return re.request("POST","products",{data:e})}static async updateProduct(e,s){return re.request("PUT","products",{id:e,data:{...s,updated_at:new Date().toISOString()}})}static async deleteProduct(e){return re.request("DELETE","products",{id:e})}static async getProductSkus(e){return re.request("GET","product_skus",{query:{product_id:e,is_active:!0}})}static async getAccessories(e){return re.request("GET","accessories",{query:{...e,is_active:!0}})}static async getAccessory(e){return re.request("GET","accessories",{id:e})}static async createAccessory(e){return re.request("POST","accessories",{data:e})}static async updateAccessory(e,s){return re.request("PUT","accessories",{id:e,data:{...s,updated_at:new Date().toISOString()}})}static async deleteAccessory(e){return re.request("DELETE","accessories",{id:e})}static async searchProducts(e){const{data:s,error:r}=await ne.from("products").select("*, skus:product_skus(*)").or(`name.ilike.%${e}%,model.ilike.%${e}%`).eq("is_active",!0).limit(20);return r?re.handleError(r):{success:!0,data:s||[]}}}class ge{static async getQuotes(e){return re.request("GET","quotes",{query:e,select:`
        *,
        customer:customers(*),
        sales:users(*),
        items:quote_items(*)
      `})}static async getQuote(e){return re.request("GET","quotes",{id:e,select:`
        *,
        customer:customers(*),
        sales:users(*),
        items:quote_items(*)
      `})}static async createQuote(e){try{let s;const{data:r}=await ne.from("customers").select("id").eq("phone",e.customer.phone).single();if(r)s=r.id,await ne.from("customers").update({...e.customer,updated_at:new Date().toISOString()}).eq("id",s);else{const{data:h,error:g}=await ne.from("customers").insert(e.customer).select().single();if(g)throw g;s=h.id}const{data:n,error:i}=await ne.functions.invoke("generate-quote-no");if(i)throw i;const o=e.items.reduce((h,g)=>h+g.total_price,0),{data:a,error:c}=await ne.from("quotes").insert({quote_no:n.quote_no,customer_id:s,total_price:o,status:"pending",remark:e.remark}).select().single();if(c)throw c;const u=e.items.map(h=>({...h,quote_id:a.id})),{error:l}=await ne.from("quote_items").insert(u);if(l)throw l;return this.getQuote(a.id)}catch(s){return re.handleError(s)}}static async updateQuote(e,s){return re.request("PUT","quotes",{id:e,data:{...s,updated_at:new Date().toISOString()}})}static async deleteQuote(e){return re.request("DELETE","quotes",{id:e})}static async getQuotesByPhone(e){try{const{data:s,error:r}=await ne.from("customers").select("id").eq("phone",e);if(r)throw r;if(!s||s.length===0)return{success:!0,data:[]};const n=s.map(a=>a.id),{data:i,error:o}=await ne.from("quotes").select(`
          *,
          customer:customers(*),
          sales:users(*),
          items:quote_items(*)
        `).in("customer_id",n).order("created_at",{ascending:!1});if(o)throw o;return{success:!0,data:i||[]}}catch(s){return re.handleError(s)}}static async approveQuote(e){return this.updateQuote(e,{status:"approved"})}static async rejectQuote(e,s){return this.updateQuote(e,{status:"rejected",remark:s})}static async exportQuotes(e){try{const{data:s,error:r}=await ne.functions.invoke("export-quotes",{body:e});if(r)throw r;return{success:!0,data:s}}catch(s){return re.handleError(s)}}}class he{static async getProducts(e){return je.getProducts(e)}static async getProduct(e){return je.getProduct(e)}static async getAccessories(e){return je.getAccessories(e)}static async searchProducts(e){return je.searchProducts(e)}static async getQuotes(e){return ge.getQuotes(e)}static async getQuote(e){return ge.getQuote(e)}static async getQuotesByPhone(e){return ge.getQuotesByPhone(e)}static async createQuote(e){return ge.createQuote(e)}static async updateQuote(e,s){return ge.updateQuote(e,s)}static async deleteQuote(e){return ge.deleteQuote(e)}static async approveQuote(e){return ge.approveQuote(e)}static async rejectQuote(e,s){return ge.rejectQuote(e,s)}static async login(e){return Ce.login(e)}static async logout(){return Ce.logout()}static async getCurrentUser(){return Ce.getCurrentUser()}static async refreshToken(){return Ce.refreshToken()}static async changePassword(e,s){return Ce.changePassword(e,s)}static isAuthenticated(){return Ce.isAuthenticated()}static getAuthToken(){return Ce.getAuthToken()}static async getSalesStats(e){try{const{data:s,error:r}=await ge.getQuotes({...e,startDate:e==null?void 0:e.startDate,endDate:e==null?void 0:e.endDate});if(!s.success||r)return{success:!1,error:{code:"FETCH_ERROR",message:"获取统计数据失败"}};const n=s.data;return{success:!0,data:{totalQuotes:n.length,totalAmount:n.reduce((o,a)=>o+(a.total_price||0),0),approvedQuotes:n.filter(o=>o.status==="approved").length,pendingQuotes:n.filter(o=>o.status==="pending").length,rejectedQuotes:n.filter(o=>o.status==="rejected").length}}}catch{return{success:!1,error:{code:"CALCULATION_ERROR",message:"计算统计数据失败"}}}}static async exportQuotes(e){return ge.exportQuotes(e)}static async uploadFile(e,s="attachments",r){const n=r||`uploads/${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return re.uploadFile(e,s,n)}static async healthCheck(){var e;try{const r=(await je.getProducts({limit:1})).success,n=await Ce.getCurrentUser(),i=n.success||((e=n.error)==null?void 0:e.code)!=="SERVER_ERROR",o=!0;return{success:!0,data:{status:r&&i&&o?"healthy":"unhealthy",timestamp:new Date().toISOString(),services:{database:r,auth:i,storage:o}}}}catch{return{success:!1,error:{code:"HEALTH_CHECK_FAILED",message:"健康检查失败"}}}}}const Qd=Is("customers",()=>{const t=G([]),e=G(null),s=G(0),r=G(!1),n=G(null),i=pe(()=>{const m={total:t.value.length,individual:0,business:0,active:0,inactive:0,potential:0,blacklist:0,walk_in:0,referral:0,online:0,phone:0,exhibition:0,other:0,total_revenue:0,average_quote_value:0,active_customers_with_quotes:0};return t.value.forEach(A=>{switch(A.customer_type==="individual"?m.individual++:m.business++,A.status){case"active":m.active++;break;case"inactive":m.inactive++;break;case"potential":m.potential++;break;case"blacklist":m.blacklist++;break}switch(A.source){case"walk_in":m.walk_in++;break;case"referral":m.referral++;break;case"online":m.online++;break;case"phone":m.phone++;break;case"exhibition":m.exhibition++;break;case"other":m.other++;break}A.total_amount&&(m.total_revenue+=A.total_amount,A.total_quotes&&A.total_quotes>0&&m.active_customers_with_quotes++)}),m.active_customers_with_quotes>0&&(m.average_quote_value=m.total_revenue/m.active_customers_with_quotes),m});async function o(m={}){r.value=!0,n.value=null;try{const A=await he.get("/api/customers",{params:{page:m.page||1,pageSize:m.pageSize||20,search:m.search,customer_type:m.customer_type,status:m.status,source:m.source,city:m.city,district:m.district,sortBy:m.sortBy||"created_at",sortOrder:m.sortOrder||"desc",startDate:m.startDate,endDate:m.endDate,hasQuotes:m.hasQuotes,minAmount:m.minAmount,maxAmount:m.maxAmount,lastQuoteBefore:m.lastQuoteBefore,lastQuoteAfter:m.lastQuoteAfter}});t.value=A.data.data,s.value=A.data.total}catch(A){n.value=A.message||"获取客户列表失败",console.error("Failed to fetch customers:",A)}finally{r.value=!1}}async function a(m,A=!0,I=!0){r.value=!0,n.value=null;try{const R=await he.get(`/api/customers/${m}`,{params:{include_quotes:A,include_activities:I}});return e.value=R.data,R.data}catch(R){throw n.value=R.message||"获取客户详情失败",console.error("Failed to fetch customer:",R),R}finally{r.value=!1}}async function c(m){r.value=!0,n.value=null;try{const A=await he.post("/api/customers",m);return t.value.unshift(A.data),s.value++,A.data}catch(A){throw n.value=A.message||"创建客户失败",console.error("Failed to create customer:",A),A}finally{r.value=!1}}async function u(m,A){var I;r.value=!0,n.value=null;try{const R=await he.put(`/api/customers/${m}`,A),y=t.value.findIndex(F=>F.id===m);return y!==-1&&(t.value[y]={...t.value[y],...R.data}),((I=e.value)==null?void 0:I.id)===m&&(e.value={...e.value,...R.data}),R.data}catch(R){throw n.value=R.message||"更新客户失败",console.error("Failed to update customer:",R),R}finally{r.value=!1}}async function l(m){r.value=!0,n.value=null;try{await he.delete(`/api/customers/${m}`),t.value=t.value.filter(A=>A.id!==m),s.value--}catch(A){throw n.value=A.message||"删除客户失败",console.error("Failed to delete customer:",A),A}finally{r.value=!1}}async function h(m,A){return u(m,{status:A})}async function g(m){r.value=!0,n.value=null;try{return(await he.get("/api/customers/search",{params:{phone:m}})).data}catch(A){throw n.value=A.message||"搜索客户失败",console.error("Failed to search customers:",A),A}finally{r.value=!1}}async function p(m,A=1,I=10){r.value=!0,n.value=null;try{return(await he.get(`/api/customers/${m}/quotes`,{params:{page:A,pageSize:I}})).data}catch(R){throw n.value=R.message||"获取客户报价记录失败",console.error("Failed to fetch customer quotes:",R),R}finally{r.value=!1}}async function S(m,A=1,I=20){r.value=!0,n.value=null;try{return(await he.get(`/api/customers/${m}/activities`,{params:{page:A,pageSize:I}})).data}catch(R){throw n.value=R.message||"获取客户活动记录失败",console.error("Failed to fetch customer activities:",R),R}finally{r.value=!1}}async function w(m,A){var I;r.value=!0,n.value=null;try{const R=await he.post(`/api/customers/${m}/activities`,A);return((I=e.value)==null?void 0:I.id)===m&&e.value.recent_activities&&e.value.recent_activities.unshift(R.data),R.data}catch(R){throw n.value=R.message||"添加客户活动记录失败",console.error("Failed to add customer activity:",R),R}finally{r.value=!1}}async function x(m={}){r.value=!0,n.value=null;try{const A=await he.get("/api/customers/export",{params:{...m,format:m.format||"excel"},responseType:"blob"}),I=new Blob([A.data],{type:m.format==="csv"?"text/csv":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),R=window.URL.createObjectURL(I),y=document.createElement("a");y.href=R;const F=`customers_${new Date().toISOString().split("T")[0]}.${m.format||"xlsx"}`;y.download=F,y.click(),window.URL.revokeObjectURL(R)}catch(A){throw n.value=A.message||"导出客户数据失败",console.error("Failed to export customers:",A),A}finally{r.value=!1}}async function O(m,A){r.value=!0,n.value=null;try{const I=await he.post("/api/customers/merge",{primary_customer_id:m,duplicate_customer_id:A});t.value=t.value.filter(y=>y.id!==A),s.value--;const R=t.value.findIndex(y=>y.id===m);return R!==-1&&(t.value[R]=I.data),I.data}catch(I){throw n.value=I.message||"合并客户失败",console.error("Failed to merge customers:",I),I}finally{r.value=!1}}async function P(){r.value=!0,n.value=null;try{return(await he.get("/api/customers/statistics")).data}catch(m){throw n.value=m.message||"获取客户统计失败",console.error("Failed to fetch customer statistics:",m),m}finally{r.value=!1}}function v(){n.value=null}function C(){e.value=null}function N(m){return t.value.find(A=>A.phone===m)}function W(m){return m.customer_type==="business"&&m.company?`${m.company} (${m.name})`:m.name}function K(m){return m.status==="active"}return{customers:t,currentCustomer:e,totalCount:s,loading:r,error:n,statistics:i,fetchCustomers:o,fetchCustomerById:a,createCustomer:c,updateCustomer:u,deleteCustomer:l,updateCustomerStatus:h,searchCustomersByPhone:g,getCustomerQuotes:p,getCustomerActivities:S,addCustomerActivity:w,exportCustomers:x,mergeCustomers:O,getCustomerStatistics:P,clearError:v,clearCurrentCustomer:C,findCustomerByPhone:N,getCustomerDisplayName:W,isCustomerActive:K}}),Jd=Is("products",()=>{const t=G([]),e=G([]),s=G(null),r=G(null),n=G(!1),i=G(null),o=G(1),a=G(20),c=G(0),u=G(""),l=G(""),h=G(null),g=pe(()=>Math.ceil(c.value/a.value)),p=pe(()=>t.value.filter(I=>I.is_active)),S=pe(()=>{const I=new Set;return t.value.forEach(R=>{R.category&&I.add(R.category)}),Array.from(I).sort()}),w=pe(()=>{let I=[...t.value];if(u.value){const R=u.value.toLowerCase();I=I.filter(y=>{var F;return y.name.toLowerCase().includes(R)||y.model.toLowerCase().includes(R)||((F=y.description)==null?void 0:F.toLowerCase().includes(R))})}return l.value&&(I=I.filter(R=>R.category===l.value)),h.value!==null&&(I=I.filter(R=>R.is_active===h.value)),I});async function x(I){var R,y;n.value=!0,i.value=null;try{const F={page:o.value,page_size:a.value,...I},L=await je.getProducts(F);L.success&&L.data?(t.value=L.data,c.value=((R=L.pagination)==null?void 0:R.total)||L.data.length):i.value=((y=L.error)==null?void 0:y.message)||"获取产品列表失败"}catch(F){i.value="网络错误，请稍后重试",console.error("Fetch products error:",F)}finally{n.value=!1}}async function O(I){var R;n.value=!0,i.value=null;try{const y=await je.getProduct(I);return y.success&&y.data?(s.value=y.data,y.data):(i.value=((R=y.error)==null?void 0:R.message)||"获取产品详情失败",null)}catch(y){return i.value="网络错误，请稍后重试",console.error("Fetch product error:",y),null}finally{n.value=!1}}async function P(I){var R;n.value=!0,i.value=null;try{const y=await je.createProduct(I);return y.success&&y.data?(t.value.unshift(y.data),c.value++,{success:!0,data:y.data}):(i.value=((R=y.error)==null?void 0:R.message)||"创建产品失败",{success:!1,error:i.value})}catch(y){return i.value="网络错误，请稍后重试",console.error("Create product error:",y),{success:!1,error:i.value}}finally{n.value=!1}}async function v(I,R){var y,F;n.value=!0,i.value=null;try{const L=await je.updateProduct(I,R);if(L.success&&L.data){const Y=t.value.findIndex(M=>M.id===I);return Y>-1&&(t.value[Y]=L.data),((y=s.value)==null?void 0:y.id)===I&&(s.value=L.data),{success:!0,data:L.data}}else return i.value=((F=L.error)==null?void 0:F.message)||"更新产品失败",{success:!1,error:i.value}}catch(L){return i.value="网络错误，请稍后重试",console.error("Update product error:",L),{success:!1,error:i.value}}finally{n.value=!1}}async function C(I){var R;n.value=!0,i.value=null;try{const y=await je.deleteProduct(I);return y.success?(t.value=t.value.filter(F=>F.id!==I),c.value--,{success:!0}):(i.value=((R=y.error)==null?void 0:R.message)||"删除产品失败",{success:!1,error:i.value})}catch(y){return i.value="网络错误，请稍后重试",console.error("Delete product error:",y),{success:!1,error:i.value}}finally{n.value=!1}}async function N(I){var R;n.value=!0,i.value=null;try{const y=await je.getAccessories(I);y.success&&y.data?e.value=y.data:i.value=((R=y.error)==null?void 0:R.message)||"获取配件列表失败"}catch(y){i.value="网络错误，请稍后重试",console.error("Fetch accessories error:",y)}finally{n.value=!1}}async function W(I){var R;if(!I.trim())return{success:!0,data:[]};n.value=!0,i.value=null;try{const y=await je.searchProducts(I);return y.success?{success:!0,data:y.data||[]}:(i.value=((R=y.error)==null?void 0:R.message)||"搜索产品失败",{success:!1,error:i.value,data:[]})}catch(y){return i.value="网络错误，请稍后重试",console.error("Search products error:",y),{success:!1,error:i.value,data:[]}}finally{n.value=!1}}function K(){u.value="",l.value="",h.value=null,o.value=1}function m(I){o.value=I,x()}function A(I){a.value=I,o.value=1,x()}return{products:t,accessories:e,currentProduct:s,currentAccessory:r,isLoading:n,error:i,currentPage:o,pageSize:a,total:c,totalPages:g,searchKeyword:u,categoryFilter:l,statusFilter:h,activeProducts:p,productCategories:S,filteredProducts:w,fetchProducts:x,fetchProduct:O,createProduct:P,updateProduct:v,deleteProduct:C,fetchAccessories:N,searchProducts:W,resetFilters:K,setPage:m,setPageSize:A}}),Yd=Is("quotes",()=>{const t=G([]),e=G(null),s=G(!1),r=G(null),n=G(1),i=G(20),o=G(0),a=G(""),c=G(""),u=G(null),l=G(""),h=pe(()=>Math.ceil(o.value/i.value)),g=pe(()=>t.value.filter(y=>y.status==="pending")),p=pe(()=>t.value.filter(y=>y.status==="approved")),S=pe(()=>t.value.filter(y=>y.status==="rejected")),w=pe(()=>t.value.reduce((y,F)=>y+F.total_price,0)),x=pe(()=>{let y=[...t.value];if(a.value){const F=a.value.toLowerCase();y=y.filter(L=>{var Y,M,H,Z;return L.quote_no.toLowerCase().includes(F)||((M=(Y=L.customer)==null?void 0:Y.name)==null?void 0:M.toLowerCase().includes(F))||((Z=(H=L.customer)==null?void 0:H.phone)==null?void 0:Z.includes(F))})}if(c.value&&(y=y.filter(F=>F.status===c.value)),u.value){const[F,L]=u.value;y=y.filter(Y=>{const M=new Date(Y.created_at);return M>=new Date(F)&&M<=new Date(L)})}return y});async function O(y){var F,L;s.value=!0,r.value=null;try{const Y={page:n.value,page_size:i.value,sort_by:"created_at",sort_order:"desc",...y},M=await ge.getQuotes(Y);M.success&&M.data?(t.value=M.data,o.value=((F=M.pagination)==null?void 0:F.total)||M.data.length):r.value=((L=M.error)==null?void 0:L.message)||"获取报价单列表失败"}catch(Y){r.value="网络错误，请稍后重试",console.error("Fetch quotes error:",Y)}finally{s.value=!1}}async function P(y){var F;s.value=!0,r.value=null;try{const L=await ge.getQuote(y);return L.success&&L.data?(e.value=L.data,L.data):(r.value=((F=L.error)==null?void 0:F.message)||"获取报价单详情失败",null)}catch(L){return r.value="网络错误，请稍后重试",console.error("Fetch quote error:",L),null}finally{s.value=!1}}async function v(y){var F,L;s.value=!0,r.value=null;try{const Y=await ge.approveQuote(y);if(Y.success&&Y.data){const M=t.value.findIndex(H=>H.id===y);return M>-1&&(t.value[M]=Y.data),((F=e.value)==null?void 0:F.id)===y&&(e.value=Y.data),{success:!0,data:Y.data}}else return r.value=((L=Y.error)==null?void 0:L.message)||"审批失败",{success:!1,error:r.value}}catch(Y){return r.value="网络错误，请稍后重试",console.error("Approve quote error:",Y),{success:!1,error:r.value}}finally{s.value=!1}}async function C(y,F){var L,Y;s.value=!0,r.value=null;try{const M=await ge.rejectQuote(y,F);if(M.success&&M.data){const H=t.value.findIndex(Z=>Z.id===y);return H>-1&&(t.value[H]=M.data),((L=e.value)==null?void 0:L.id)===y&&(e.value=M.data),{success:!0,data:M.data}}else return r.value=((Y=M.error)==null?void 0:Y.message)||"拒绝失败",{success:!1,error:r.value}}catch(M){return r.value="网络错误，请稍后重试",console.error("Reject quote error:",M),{success:!1,error:r.value}}finally{s.value=!1}}async function N(y){var F;s.value=!0,r.value=null;try{const L=await ge.deleteQuote(y);return L.success?(t.value=t.value.filter(Y=>Y.id!==y),o.value--,{success:!0}):(r.value=((F=L.error)==null?void 0:F.message)||"删除报价单失败",{success:!1,error:r.value})}catch(L){return r.value="网络错误，请稍后重试",console.error("Delete quote error:",L),{success:!1,error:r.value}}finally{s.value=!1}}async function W(y){var F;s.value=!0,r.value=null;try{const L=await ge.exportQuotes(y);if(L.success&&L.data){const Y=L.data,M=window.URL.createObjectURL(Y),H=document.createElement("a");return H.href=M,H.download=`quotes_${y.startDate}_${y.endDate}.xlsx`,document.body.appendChild(H),H.click(),window.URL.revokeObjectURL(M),document.body.removeChild(H),{success:!0}}else return r.value=((F=L.error)==null?void 0:F.message)||"导出失败",{success:!1,error:r.value}}catch(L){return r.value="网络错误，请稍后重试",console.error("Export quotes error:",L),{success:!1,error:r.value}}finally{s.value=!1}}async function K(y){var F;if(!y.trim())return{success:!0,data:[]};s.value=!0,r.value=null;try{const L=await ge.getQuotesByPhone(y);return L.success?{success:!0,data:L.data||[]}:(r.value=((F=L.error)==null?void 0:F.message)||"搜索失败",{success:!1,error:r.value,data:[]})}catch(L){return r.value="网络错误，请稍后重试",console.error("Search quotes by phone error:",L),{success:!1,error:r.value,data:[]}}finally{s.value=!1}}function m(){a.value="",c.value="",u.value=null,l.value="",n.value=1}function A(y){n.value=y,O()}function I(y){i.value=y,n.value=1,O()}function R(){const y=t.value.length,F=g.value.length,L=p.value.length,Y=S.value.length,M=w.value,H=g.value.reduce((Ue,lt)=>Ue+lt.total_price,0),Z=p.value.reduce((Ue,lt)=>Ue+lt.total_price,0);return{counts:{total:y,pending:F,approved:L,rejected:Y},amounts:{total:M,pending:H,approved:Z}}}return{quotes:t,currentQuote:e,isLoading:s,error:r,currentPage:n,pageSize:i,total:o,totalPages:h,searchKeyword:a,statusFilter:c,dateRange:u,customerPhone:l,pendingQuotes:g,approvedQuotes:p,rejectedQuotes:S,totalQuotesAmount:w,filteredQuotes:x,fetchQuotes:O,fetchQuote:P,approveQuote:v,rejectQuote:C,deleteQuote:N,exportQuotes:W,searchByPhone:K,resetFilters:m,setPage:A,setPageSize:I,getQuoteStats:R}}),Xd=Is("users",()=>{const t=G([]),e=G(null),s=G(0),r=G(!1),n=G(null),i=pe(()=>{const P={total:t.value.length,active:0,inactive:0,admin:0,sales_manager:0,sales_rep:0,viewer:0};return t.value.forEach(v=>{switch(v.status==="active"?P.active++:P.inactive++,v.role){case"admin":P.admin++;break;case"sales_manager":P.sales_manager++;break;case"sales_rep":P.sales_rep++;break;case"viewer":P.viewer++;break}}),P});async function o(P={}){r.value=!0,n.value=null;try{const v=await he.get("/api/users",{params:{page:P.page||1,pageSize:P.pageSize||20,search:P.search,role:P.role,status:P.status,department:P.department,sortBy:P.sortBy||"created_at",sortOrder:P.sortOrder||"desc"}});t.value=v.data.data,s.value=v.data.total}catch(v){n.value=v.message||"获取用户列表失败",console.error("Failed to fetch users:",v)}finally{r.value=!1}}async function a(P){r.value=!0,n.value=null;try{const v=await he.get(`/api/users/${P}`);return e.value=v.data,v.data}catch(v){throw n.value=v.message||"获取用户详情失败",console.error("Failed to fetch user:",v),v}finally{r.value=!1}}async function c(P){r.value=!0,n.value=null;try{const v=await he.post("/api/users",P);return t.value.unshift(v.data),s.value++,v.data}catch(v){throw n.value=v.message||"创建用户失败",console.error("Failed to create user:",v),v}finally{r.value=!1}}async function u(P,v){var C;r.value=!0,n.value=null;try{const N=await he.put(`/api/users/${P}`,v),W=t.value.findIndex(K=>K.id===P);return W!==-1&&(t.value[W]=N.data),((C=e.value)==null?void 0:C.id)===P&&(e.value=N.data),N.data}catch(N){throw n.value=N.message||"更新用户失败",console.error("Failed to update user:",N),N}finally{r.value=!1}}async function l(P){r.value=!0,n.value=null;try{await he.delete(`/api/users/${P}`),t.value=t.value.filter(v=>v.id!==P),s.value--}catch(v){throw n.value=v.message||"删除用户失败",console.error("Failed to delete user:",v),v}finally{r.value=!1}}async function h(P){return u(P,{status:"active"})}async function g(P){return u(P,{status:"inactive"})}async function p(P,v){return u(P,{role:v})}async function S(P){r.value=!0,n.value=null;try{return(await he.post(`/api/users/${P}/reset-password`)).data}catch(v){throw n.value=v.message||"重置密码失败",console.error("Failed to reset password:",v),v}finally{r.value=!1}}async function w(P,v){r.value=!0,n.value=null;try{return(await he.post("/api/users/invite",{email:P,role:v})).data}catch(C){throw n.value=C.message||"邀请用户失败",console.error("Failed to invite user:",C),C}finally{r.value=!1}}async function x(P={}){r.value=!0,n.value=null;try{const v=await he.get("/api/users/export",{params:P,responseType:"blob"}),C=new Blob([v.data],{type:"text/csv"}),N=window.URL.createObjectURL(C),W=document.createElement("a");W.href=N,W.download=`users_${new Date().toISOString().split("T")[0]}.csv`,W.click(),window.URL.revokeObjectURL(N)}catch(v){throw n.value=v.message||"导出用户失败",console.error("Failed to export users:",v),v}finally{r.value=!1}}function O(){n.value=null}return{users:t,currentUser:e,totalCount:s,loading:r,error:n,statistics:i,fetchUsers:o,fetchUserById:a,createUser:c,updateUser:u,deleteUser:l,activateUser:h,deactivateUser:g,updateUserRole:p,resetUserPassword:S,inviteUser:w,exportUsers:x,clearError:O}});class Zd{constructor(){Ve(this,"channels",new Map);Ve(this,"isConnected",!1);Ve(this,"reconnectAttempts",0);Ve(this,"maxReconnectAttempts",5);Ve(this,"reconnectDelay",1e3)}async initialize(){console.log("🔄 Initializing real-time service...");try{await this.subscribeToCustomers(),await this.subscribeToProducts(),await this.subscribeToQuotes(),await this.subscribeToUsers(),this.isConnected=!0,this.reconnectAttempts=0,console.log("✅ Real-time service initialized successfully")}catch(e){console.error("❌ Failed to initialize real-time service:",e),this.handleConnectionError()}}async subscribeToCustomers(){const e=ne.channel("customers-channel").on("postgres_changes",{event:"*",schema:"public",table:"customers"},s=>this.handleCustomersChange(s)).subscribe(s=>{console.log("📊 Customers subscription status:",s)});this.channels.set("customers",e)}async subscribeToProducts(){const e=ne.channel("products-channel").on("postgres_changes",{event:"*",schema:"public",table:"products"},s=>this.handleProductsChange(s)).subscribe(s=>{console.log("🛍️ Products subscription status:",s)});this.channels.set("products",e)}async subscribeToQuotes(){const e=ne.channel("quotes-channel").on("postgres_changes",{event:"*",schema:"public",table:"quotes"},s=>this.handleQuotesChange(s)).subscribe(s=>{console.log("📄 Quotes subscription status:",s)});this.channels.set("quotes",e)}async subscribeToUsers(){const e=nr();if(!e.user||!["admin","sales_manager"].includes(e.user.role)){console.log("⚠️ User subscription skipped - insufficient permissions");return}const s=ne.channel("users-channel").on("postgres_changes",{event:"*",schema:"public",table:"users"},r=>this.handleUsersChange(r)).subscribe(r=>{console.log("👥 Users subscription status:",r)});this.channels.set("users",s)}handleCustomersChange(e){var r,n;console.log("📊 Customer change detected:",e.eventType,e.new||e.old);const s=Qd();switch(e.eventType){case"INSERT":e.new&&(s.customers.unshift(e.new),s.totalCount++,this.showChangeNotification("客户","新增",e.new.name));break;case"UPDATE":if(e.new){const i=s.customers.findIndex(o=>o.id===e.new.id);i!==-1&&(s.customers[i]={...s.customers[i],...e.new}),((r=s.currentCustomer)==null?void 0:r.id)===e.new.id&&(s.currentCustomer={...s.currentCustomer,...e.new}),this.showChangeNotification("客户","更新",e.new.name)}break;case"DELETE":e.old&&(s.customers=s.customers.filter(i=>i.id!==e.old.id),s.totalCount--,((n=s.currentCustomer)==null?void 0:n.id)===e.old.id&&(s.currentCustomer=null),this.showChangeNotification("客户","删除",e.old.name));break}}handleProductsChange(e){var r,n;console.log("🛍️ Product change detected:",e.eventType,e.new||e.old);const s=Jd();switch(e.eventType){case"INSERT":e.new&&(s.products.unshift(e.new),s.total++,this.showChangeNotification("产品","新增",e.new.name));break;case"UPDATE":if(e.new){const i=s.products.findIndex(o=>o.id===e.new.id);i!==-1&&(s.products[i]={...s.products[i],...e.new}),((r=s.currentProduct)==null?void 0:r.id)===e.new.id&&(s.currentProduct={...s.currentProduct,...e.new}),this.showChangeNotification("产品","更新",e.new.name)}break;case"DELETE":e.old&&(s.products=s.products.filter(i=>i.id!==e.old.id),s.total--,((n=s.currentProduct)==null?void 0:n.id)===e.old.id&&(s.currentProduct=null),this.showChangeNotification("产品","删除",e.old.name));break}}handleQuotesChange(e){var r,n;console.log("📄 Quote change detected:",e.eventType,e.new||e.old);const s=Yd();switch(e.eventType){case"INSERT":e.new&&(s.quotes.unshift(e.new),s.totalCount++,this.showChangeNotification("报价单","新增",e.new.quote_no));break;case"UPDATE":if(e.new){const i=s.quotes.findIndex(o=>o.id===e.new.id);i!==-1&&(s.quotes[i]={...s.quotes[i],...e.new}),((r=s.currentQuote)==null?void 0:r.id)===e.new.id&&(s.currentQuote={...s.currentQuote,...e.new}),e.old&&e.old.status!==e.new.status?this.showStatusChangeNotification("报价单",e.new.quote_no,e.old.status,e.new.status):this.showChangeNotification("报价单","更新",e.new.quote_no)}break;case"DELETE":e.old&&(s.quotes=s.quotes.filter(i=>i.id!==e.old.id),s.totalCount--,((n=s.currentQuote)==null?void 0:n.id)===e.old.id&&(s.currentQuote=null),this.showChangeNotification("报价单","删除",e.old.quote_no));break}}handleUsersChange(e){var r,n;console.log("👥 User change detected:",e.eventType,e.new||e.old);const s=Xd();switch(e.eventType){case"INSERT":e.new&&(s.users.unshift(e.new),s.totalCount++,this.showChangeNotification("用户","新增",e.new.name||e.new.username));break;case"UPDATE":if(e.new){const i=s.users.findIndex(o=>o.id===e.new.id);i!==-1&&(s.users[i]={...s.users[i],...e.new}),((r=s.currentUser)==null?void 0:r.id)===e.new.id&&(s.currentUser={...s.currentUser,...e.new}),this.showChangeNotification("用户","更新",e.new.name||e.new.username)}break;case"DELETE":e.old&&(s.users=s.users.filter(i=>i.id!==e.old.id),s.totalCount--,((n=s.currentUser)==null?void 0:n.id)===e.old.id&&(s.currentUser=null),this.showChangeNotification("用户","删除",e.old.name||e.old.username));break}}showChangeNotification(e,s,r){var o;const n=getCurrentPages(),i=n[n.length-1];(o=i==null?void 0:i.route)!=null&&o.includes("/edit")||uni.showToast({title:`${e}${s}: ${r}`,icon:"none",duration:2e3})}showStatusChangeNotification(e,s,r,n){const i={pending:"待审批",approved:"已批准",rejected:"已拒绝",completed:"已完成",draft:"草稿",active:"活跃",inactive:"停用"},o=i[r]||r,a=i[n]||n;uni.showToast({title:`${e} ${s} 状态变更: ${o} → ${a}`,icon:"none",duration:3e3})}handleConnectionError(){this.reconnectAttempts<this.maxReconnectAttempts?(this.reconnectAttempts++,console.log(`🔄 Attempting to reconnect... (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),setTimeout(()=>{this.initialize()},this.reconnectDelay*this.reconnectAttempts)):(console.error("❌ Max reconnection attempts reached. Real-time updates disabled."),uni.showToast({title:"实时更新连接失败",icon:"none",duration:3e3}))}async disconnect(){console.log("🔌 Disconnecting real-time service...");for(const[e,s]of this.channels)await ne.removeChannel(s),console.log(`📡 Unsubscribed from ${e}`);this.channels.clear(),this.isConnected=!1,console.log("✅ Real-time service disconnected")}async reconnect(){await this.disconnect(),await this.initialize()}getConnectionStatus(){return{isConnected:this.isConnected,channelCount:this.channels.size,channels:Array.from(this.channels.keys())}}async subscribeToTable(e,s){const r=`${e}-channel`;if(this.channels.has(r)){console.warn(`⚠️ Already subscribed to ${e}`);return}const n=ne.channel(r).on("postgres_changes",{event:"*",schema:"public",table:e},s).subscribe(i=>{console.log(`📡 ${e} subscription status:`,i)});this.channels.set(r,n)}async unsubscribeFromTable(e){const s=`${e}-channel`,r=this.channels.get(s);r&&(await ne.removeChannel(r),this.channels.delete(s),console.log(`📡 Unsubscribed from ${e}`))}}const ns=new Zd,ef={class:"app-container"},tf=Pc({__name:"App.standard",setup(t){return vo(async()=>{console.log("App Mounted"),Gd();const e=nr();await e.initializeAuth(),e.isAuthenticated&&await ns.initialize()}),document.addEventListener("visibilitychange",async()=>{const e=nr();document.hidden?(console.log("App Hidden"),ns.getConnectionStatus().isConnected&&await ns.disconnect()):(console.log("App Shown"),await e.checkAuthStatus(),e.isAuthenticated&&!ns.getConnectionStatus().isConnected&&await ns.reconnect())}),kn(()=>{console.log("App Unmounted")}),(e,s)=>{const r=Mc("router-view");return wl(),El("div",ef,[mt(r)])}}}),sf=_u(tf);sf.mount("#app");

import{H as Ne,r as w,i as L,d as oe,c as n,a as e,F as B,f as j,g as i,n as N,b as x,t as a,J as de,p as Ve,w as we,v as Q,x as ge,R as qe,z as ve,A as le,m as pe,k as E,o as ye,S as Ue,j as K,y as $e,U as re,M as Je,G as h}from"./index.standard-DHpxIVC0.js";import{u as Ze,R as Ke}from"./RealtimeIndicator-BP6QFItv.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Qe=Ne("logs",()=>{const D=w([]),F=w([]),v=w([]),f=w({}),y=w(null),k=w(null),m=w(!1),u=w(null),o=w(1),r=w(50),b=w(0),S=w(!1),Z=w(3e4),H=L(()=>D.value.length>0),T=L(()=>Math.ceil(b.value/r.value)),z=L(()=>o.value>1),V=L(()=>o.value<T.value),P=L(()=>!f.value||Object.keys(f.value).length===0?D.value:D.value.filter(c=>{var C,M,te;if((C=f.value.level)!=null&&C.length&&!f.value.level.includes(c.level)||(M=f.value.category)!=null&&M.length&&!f.value.category.includes(c.category)||(te=f.value.action)!=null&&te.length&&!f.value.action.includes(c.action)||f.value.user_id&&c.user_id!==f.value.user_id||f.value.resource_type&&c.resource_type!==f.value.resource_type||f.value.date_from&&c.timestamp<f.value.date_from||f.value.date_to&&c.timestamp>f.value.date_to)return!1;if(f.value.search){const ue=f.value.search.toLowerCase();if(![c.message,c.user_name,c.resource_name,JSON.stringify(c.details||{})].join(" ").toLowerCase().includes(ue))return!1}return!0})),q=L(()=>D.value.filter(c=>c.level==="critical"||c.level==="error")),J=L(()=>D.value.sort((c,C)=>new Date(C.timestamp).getTime()-new Date(c.timestamp).getTime()).slice(0,10));async function t(c){m.value=!0,u.value=null;try{c&&(f.value={...c});const C=[{id:"1",timestamp:new Date().toISOString(),level:"info",category:"auth",action:"login",user_id:"user123",user_name:"张三",user_role:"sales_manager",ip_address:"192.168.1.100",session_id:"sess_123",message:"用户成功登录系统",created_at:new Date().toISOString()},{id:"2",timestamp:new Date(Date.now()-3e5).toISOString(),level:"warn",category:"security",action:"access_denied",user_id:"user456",user_name:"李四",user_role:"sales_rep",resource_type:"user",resource_id:"user789",ip_address:"192.168.1.101",message:"用户尝试访问权限不足的资源",details:{attempted_resource:"/admin/users/delete",required_role:"admin"},created_at:new Date(Date.now()-3e5).toISOString()}];D.value=C,b.value=C.length,y.value={entries:P.value.slice((o.value-1)*r.value,o.value*r.value),total:P.value.length,page:o.value,per_page:r.value,has_next:V.value,has_previous:z.value}}catch(C){u.value=C instanceof Error?C.message:"获取日志失败",console.error("Failed to fetch logs:",C)}finally{m.value=!1}}async function s(){m.value=!0,u.value=null;try{k.value={total_entries:1250,entries_by_level:{info:800,warn:300,error:120,debug:25,critical:5},entries_by_category:{auth:450,user:200,customer:300,product:150,quote:100,system:30,security:15,api:5,data:0,export:0},entries_by_action:{create:300,read:500,update:250,delete:50,login:100,logout:50,approve:30,reject:10,assign:40,export:20,import:5,backup:3,config_change:8,role_change:2,access_denied:15,security_violation:2},top_users:[{user_id:"user123",user_name:"张三",count:450},{user_id:"user456",user_name:"李四",count:320},{user_id:"user789",user_name:"王五",count:280}],recent_activity:J.value,error_summary:[{error_code:"AUTH001",count:15,last_occurrence:new Date().toISOString()},{error_code:"PERM002",count:8,last_occurrence:new Date(Date.now()-36e5).toISOString()}],security_events:17,failed_logins:25,data_operations:50}}catch(c){u.value=c instanceof Error?c.message:"获取统计信息失败",console.error("Failed to fetch statistics:",c)}finally{m.value=!1}}async function U(c){const C={...f.value,search:c};await t(C)}async function R(c){o.value=1,await t(c)}function G(){f.value={},o.value=1,t()}async function W(c){c>=1&&c<=T.value&&(o.value=c,await t(f.value))}async function X(c){m.value=!0,u.value=null;try{const C={format:c.format,entries:P.value,total:P.value.length,exported_at:new Date().toISOString(),filters_applied:f.value},M=`logs_export_${new Date().toISOString().split("T")[0]}.${c.format}`;return uni.showToast({title:`导出完成: ${M}`,icon:"success"}),C}catch(C){throw u.value=C instanceof Error?C.message:"导出日志失败",console.error("Failed to export logs:",C),C}finally{m.value=!1}}async function ie(){m.value=!0,u.value=null;try{F.value=[{id:"sec1",timestamp:new Date().toISOString(),event_type:"failed_login",severity:"medium",user_id:"user999",ip_address:"192.168.1.200",description:"连续多次登录失败",resolved:!1}]}catch(c){u.value=c instanceof Error?c.message:"获取安全事件失败",console.error("Failed to fetch security events:",c)}finally{m.value=!1}}async function Y(c,C){m.value=!0,u.value=null;try{const M=F.value.find(te=>te.id===c);M&&(M.resolved=!0,M.resolved_at=new Date().toISOString(),M.resolution_notes=C,uni.showToast({title:"安全事件已处理",icon:"success"}))}catch(M){u.value=M instanceof Error?M.message:"处理安全事件失败",console.error("Failed to resolve security event:",M)}finally{m.value=!1}}function ee(){S.value=!0;const c=setInterval(()=>{S.value?t(f.value):clearInterval(c)},Z.value)}function g(){S.value=!1}function l(c){return{info:"#3b82f6",warn:"#f59e0b",error:"#ef4444",debug:"#6b7280",critical:"#dc2626"}[c]||"#6b7280"}function I(c){return{info:"信息",warn:"警告",error:"错误",debug:"调试",critical:"严重"}[c]||c}function p(c){return{auth:"认证",user:"用户",customer:"客户",product:"产品",quote:"报价",system:"系统",security:"安全",api:"API",data:"数据",export:"导出"}[c]||c}function O(c){return{create:"创建",read:"查看",update:"更新",delete:"删除",login:"登录",logout:"登出",register:"注册",approve:"批准",reject:"拒绝",assign:"分配",export:"导出",import:"导入",backup:"备份",config_change:"配置变更",role_change:"角色变更",access_denied:"访问拒绝",security_violation:"安全违规"}[c]||c}return{logs:D,securityEvents:F,systemEvents:v,currentFilter:f,searchResult:y,statistics:k,loading:m,error:u,currentPage:o,pageSize:r,totalEntries:b,autoRefresh:S,refreshInterval:Z,hasLogs:H,totalPages:T,hasPreviousPage:z,hasNextPage:V,filteredLogs:P,criticalEvents:q,recentActivity:J,fetchLogs:t,fetchStatistics:s,searchLogs:U,applyFilter:R,clearFilter:G,changePage:W,exportLogs:X,fetchSecurityEvents:ie,resolveSecurityEvent:Y,startAutoRefresh:ee,stopAutoRefresh:g,getLogLevelColor:l,getLogLevelText:I,getCategoryText:p,getActionText:O}}),He={class:"data-table"},Ge={class:"table"},We=["onClick"],Xe={class:"th-content"},Ye={key:0},et=["colspan"],tt={key:1},st=["colspan"],lt=oe({__name:"DataTable",props:{columns:{},data:{},loading:{type:Boolean,default:!1},sortBy:{default:""},sortDirection:{default:"asc"}},emits:["sort"],setup(D,{emit:F}){const v=D,f=F;function y(u,o){return o.split(".").reduce((r,b)=>r==null?void 0:r[b],u)||""}function k(u){if(!u.sortable)return;let o="asc";v.sortBy===u.key&&(o=v.sortDirection==="asc"?"desc":"asc"),f("sort",u.key,o)}function m(u){return v.sortBy!==u?"":v.sortDirection==="asc"?"sort-asc":"sort-desc"}return(u,o)=>(i(),n("view",He,[e("table",Ge,[e("thead",null,[e("tr",null,[(i(!0),n(B,null,j(u.columns,r=>(i(),n("th",{key:r.key,class:N({sortable:r.sortable}),onClick:b=>k(r)},[e("view",Xe,[e("text",null,a(r.title),1),r.sortable?(i(),n("text",{key:0,class:N(["sort-indicator",m(r.key)])}," ↕ ",2)):x("",!0)])],10,We))),128))])]),e("tbody",null,[u.loading?(i(),n("tr",Ye,[e("td",{colspan:u.columns.length,class:"loading-row"},o[0]||(o[0]=[e("view",{class:"loading-content"},[e("text",null,"加载中...")],-1)]),8,et)])):!u.data||u.data.length===0?(i(),n("tr",tt,[e("td",{colspan:u.columns.length,class:"empty-row"},o[1]||(o[1]=[e("view",{class:"empty-content"},[e("text",null,"暂无数据")],-1)]),8,st)])):(i(!0),n(B,{key:2},j(u.data,(r,b)=>(i(),n("tr",{key:r.id||b,class:"data-row"},[(i(!0),n(B,null,j(u.columns,S=>(i(),n("td",{key:S.key,class:N(S.class)},[de(u.$slots,S.key,{row:r,value:y(r,S.key),index:b},()=>[Ve(a(y(r,S.key)),1)])],2))),128))]))),128))])])]))}}),ot=ae(lt,[["__scopeId","data-v-2f66c925"]]),at={class:"data-pagination"},it={class:"pagination-info"},nt={class:"page-info"},rt={class:"item-info"},ut={class:"pagination-controls"},ct=["disabled"],dt=["disabled"],vt={class:"page-input"},gt=["max"],pt=["disabled"],_t=["disabled"],ft={class:"page-size-selector"},mt=["value"],bt=oe({__name:"DataPagination",props:{currentPage:{},totalPages:{},totalItems:{},pageSize:{}},emits:["page-change","page-size-change"],setup(D,{emit:F}){const v=D,f=F,y=w(v.currentPage);we(()=>v.currentPage,o=>{y.value=o});function k(o){o>=1&&o<=v.totalPages&&o!==v.currentPage&&f("page-change",o)}function m(){const o=parseInt(y.value.toString());o>=1&&o<=v.totalPages?k(o):y.value=v.currentPage}function u(o){const r=o.target,b=parseInt(r.value);f("page-size-change",b)}return(o,r)=>(i(),n("view",at,[e("view",it,[e("text",nt," 第 "+a(o.currentPage)+" 页 / 共 "+a(o.totalPages)+" 页 ",1),e("text",rt," 共 "+a(o.totalItems)+" 条记录 ",1)]),e("view",ut,[e("button",{class:N(["pagination-btn",{"btn-disabled":o.currentPage<=1}]),disabled:o.currentPage<=1,onClick:r[0]||(r[0]=b=>k(1))}," 首页 ",10,ct),e("button",{class:N(["pagination-btn",{"btn-disabled":o.currentPage<=1}]),disabled:o.currentPage<=1,onClick:r[1]||(r[1]=b=>k(o.currentPage-1))}," 上一页 ",10,dt),e("view",vt,[Q(e("input",{"onUpdate:modelValue":r[2]||(r[2]=b=>y.value=b),type:"number",min:1,max:o.totalPages,class:"page-number-input",onKeyup:qe(m,["enter"])},null,40,gt),[[ge,y.value]])]),e("button",{class:N(["pagination-btn",{"btn-disabled":o.currentPage>=o.totalPages}]),disabled:o.currentPage>=o.totalPages,onClick:r[3]||(r[3]=b=>k(o.currentPage+1))}," 下一页 ",10,pt),e("button",{class:N(["pagination-btn",{"btn-disabled":o.currentPage>=o.totalPages}]),disabled:o.currentPage>=o.totalPages,onClick:r[4]||(r[4]=b=>k(o.totalPages))}," 末页 ",10,_t)]),e("view",ft,[r[6]||(r[6]=e("text",{class:"label"},"每页显示：",-1)),e("select",{value:o.pageSize,onChange:u,class:"page-size-select"},r[5]||(r[5]=[e("option",{value:"10"},"10",-1),e("option",{value:"20"},"20",-1),e("option",{value:"50"},"50",-1),e("option",{value:"100"},"100",-1)]),40,mt),r[7]||(r[7]=e("text",{class:"label"},"条",-1))])]))}}),ht=ae(bt,[["__scopeId","data-v-5ce8c7cf"]]),wt={class:"modal-header"},yt={class:"modal-title"},$t={class:"modal-content"},xt={key:0,class:"modal-footer"},kt=oe({__name:"BaseModal",props:{visible:{type:Boolean},title:{},width:{default:"600px"},closeOnOverlay:{type:Boolean,default:!0}},emits:["close"],setup(D,{emit:F}){const v=D,f=F;function y(){f("close")}function k(){v.closeOnOverlay&&y()}return(m,u)=>m.visible?(i(),n("view",{key:0,class:"modal-overlay",onClick:k},[e("view",{class:"modal-container",style:le({width:m.width}),onClick:u[0]||(u[0]=ve(()=>{},["stop"]))},[e("view",wt,[e("text",yt,a(m.title),1),e("button",{class:"close-btn",onClick:y},"×")]),e("view",$t,[de(m.$slots,"default",{},void 0)]),m.$slots.footer?(i(),n("view",xt,[de(m.$slots,"footer",{},void 0)])):x("",!0)],4)])):x("",!0)}}),xe=ae(kt,[["__scopeId","data-v-2ea6c588"]]),Ct={key:0,class:"log-details"},St={class:"details-section"},Tt={class:"section-header"},Dt={class:"details-grid"},Pt={class:"detail-item"},It={class:"detail-value"},Lt={class:"detail-item"},Ot={class:"detail-value"},Et={class:"detail-item"},Ft={class:"detail-value"},Mt={key:0,class:"detail-item"},Rt={class:"detail-value"},zt={key:0,class:"details-section"},At={class:"details-grid"},Bt={class:"detail-item"},jt={class:"detail-value"},Nt={key:0,class:"detail-item"},Vt={class:"detail-value"},qt={key:1,class:"detail-item"},Ut={class:"detail-value"},Jt={key:2,class:"detail-item"},Zt={class:"detail-value code-text"},Kt={key:1,class:"details-section"},Qt={class:"details-grid"},Ht={class:"detail-item"},Gt={class:"detail-value"},Wt={key:0,class:"detail-item"},Xt={class:"detail-value code-text"},Yt={key:1,class:"detail-item"},es={class:"detail-value"},ts={class:"details-section"},ss={class:"message-content"},ls={class:"message-text"},os={key:2,class:"details-section"},as={class:"details-grid"},is={key:0,class:"detail-item"},ns={class:"detail-value error-code"},rs={key:0,class:"stack-trace"},us={class:"code-block"},cs={class:"code-text"},ds={key:3,class:"details-section"},vs={class:"details-grid"},gs={key:0,class:"detail-item"},ps={class:"detail-value code-text"},_s={key:1,class:"detail-item"},fs={class:"detail-value code-text"},ms={key:2,class:"detail-item full-width"},bs={class:"detail-value"},hs={key:4,class:"details-section"},ws={class:"section-header"},ys={key:0,class:"formatted-details"},$s={class:"detail-label"},xs={class:"detail-value"},ks={key:1,class:"json-details"},Cs={class:"code-block"},Ss={class:"code-text"},Ts={class:"modal-actions"},Ds={key:0,class:"error-actions"},Ps=oe({__name:"LogDetailsModal",props:{log:{},visible:{type:Boolean}},emits:["close","resolve"],setup(D,{emit:F}){const v=D,f=F,y=w(!1),k=L(()=>{var t,s;return((t=v.log)==null?void 0:t.level)==="error"||((s=v.log)==null?void 0:s.level)==="critical"}),m=L(()=>{var t,s;return((s=(t=v.log)==null?void 0:t.details)==null?void 0:s.resolved)===!0});function u(t){return{info:"#3b82f6",warn:"#f59e0b",error:"#ef4444",debug:"#6b7280",critical:"#dc2626"}[t]||"#6b7280"}function o(t){return{info:"信息",warn:"警告",error:"错误",debug:"调试",critical:"严重"}[t]||t}function r(t){return{auth:"认证",user:"用户",customer:"客户",product:"产品",quote:"报价",system:"系统",security:"安全",api:"API",data:"数据",export:"导出"}[t]||t}function b(t){return{create:"创建",read:"查看",update:"更新",delete:"删除",login:"登录",logout:"登出",register:"注册",approve:"批准",reject:"拒绝",assign:"分配",export:"导出",import:"导入",backup:"备份",config_change:"配置变更",role_change:"角色变更",access_denied:"访问拒绝",security_violation:"安全违规"}[t]||t}function S(t){return{admin:"系统管理员",sales_manager:"销售经理",sales_rep:"销售代表",viewer:"查看者"}[t]||t}function Z(t){return new Date(t).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"})}function H(t){return t.split("_").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ")}function T(t){return typeof t=="object"?JSON.stringify(t,null,2):String(t)}function z(){if(!v.log)return;const t=[`时间: ${Z(v.log.timestamp)}`,`级别: ${o(v.log.level)}`,`分类: ${r(v.log.category)}`,`操作: ${b(v.log.action)}`,`用户: ${v.log.user_name||"系统"}`,`消息: ${v.log.message}`,v.log.resource_name?`资源: ${v.log.resource_name}`:"",v.log.error_code?`错误代码: ${v.log.error_code}`:"",v.log.details?`详情: ${JSON.stringify(v.log.details,null,2)}`:""].filter(Boolean).join(`
`);navigator.clipboard?navigator.clipboard.writeText(t).then(()=>{uni.showToast({title:"已复制到剪贴板",icon:"success"})}).catch(()=>{V(t)}):V(t)}function V(t){uni.showModal({title:"复制以下内容",content:t,showCancel:!1,confirmText:"确定"})}function P(){if(!v.log)return;const t={...v.log,exported_at:new Date().toISOString(),export_type:"single_log"},s=`log_${v.log.id}_${new Date().toISOString().split("T")[0]}.json`;uni.showToast({title:`已导出: ${s}`,icon:"success"}),console.log("Exported log:",t)}function q(){v.log&&uni.showModal({title:"处理错误",content:"请输入处理说明（可选）",editable:!0,placeholderText:"输入处理说明...",success:t=>{t.confirm&&(f("resolve",v.log,t.content||void 0),uni.showToast({title:"已标记为已处理",icon:"success"}))}})}function J(){v.log&&uni.showActionSheet({itemList:["发送邮件给管理员","创建工单","标记为关键问题"],success:t=>{const U=["email","ticket","critical"][t.tapIndex];uni.showToast({title:`已${["发送邮件","创建工单","标记为关键"][t.tapIndex]}`,icon:"success"}),console.log("Escalated log:",v.log,"action:",U)}})}return(t,s)=>(i(),pe(xe,{visible:t.visible,title:"日志详情",width:"800px",onClose:s[2]||(s[2]=U=>t.$emit("close"))},{footer:E(()=>[e("view",Ts,[k.value&&!m.value?(i(),n("view",Ds,[e("button",{class:"resolve-btn",onClick:q},s[26]||(s[26]=[e("text",null,"标记为已处理",-1)])),e("button",{class:"escalate-btn",onClick:J},s[27]||(s[27]=[e("text",null,"上报问题",-1)]))])):x("",!0),e("button",{class:"copy-btn",onClick:z},s[28]||(s[28]=[e("text",null,"复制详情",-1)])),e("button",{class:"export-btn",onClick:P},s[29]||(s[29]=[e("text",null,"导出日志",-1)])),e("button",{class:"close-btn",onClick:s[1]||(s[1]=U=>t.$emit("close"))},s[30]||(s[30]=[e("text",null,"关闭",-1)]))])]),default:E(()=>[t.log?(i(),n("view",Ct,[e("view",St,[e("view",Tt,[s[3]||(s[3]=e("text",{class:"section-title"},"基本信息",-1)),e("view",{class:N(["log-level-badge",`level-${t.log.level}`])},[e("view",{class:"level-dot",style:le({backgroundColor:u(t.log.level)})},null,4),e("text",null,a(o(t.log.level)),1)],2)]),e("view",Dt,[e("view",Pt,[s[4]||(s[4]=e("text",{class:"detail-label"},"时间",-1)),e("text",It,a(Z(t.log.timestamp)),1)]),e("view",Lt,[s[5]||(s[5]=e("text",{class:"detail-label"},"分类",-1)),e("text",Ot,a(r(t.log.category)),1)]),e("view",Et,[s[6]||(s[6]=e("text",{class:"detail-label"},"操作",-1)),e("text",Ft,a(b(t.log.action)),1)]),t.log.duration_ms?(i(),n("view",Mt,[s[7]||(s[7]=e("text",{class:"detail-label"},"耗时",-1)),e("text",Rt,a(t.log.duration_ms)+"ms",1)])):x("",!0)])]),t.log.user_id?(i(),n("view",zt,[s[12]||(s[12]=e("view",{class:"section-header"},[e("text",{class:"section-title"},"用户信息")],-1)),e("view",At,[e("view",Bt,[s[8]||(s[8]=e("text",{class:"detail-label"},"用户名",-1)),e("text",jt,a(t.log.user_name||t.log.user_id),1)]),t.log.user_role?(i(),n("view",Nt,[s[9]||(s[9]=e("text",{class:"detail-label"},"角色",-1)),e("text",Vt,a(S(t.log.user_role)),1)])):x("",!0),t.log.ip_address?(i(),n("view",qt,[s[10]||(s[10]=e("text",{class:"detail-label"},"IP地址",-1)),e("text",Ut,a(t.log.ip_address),1)])):x("",!0),t.log.session_id?(i(),n("view",Jt,[s[11]||(s[11]=e("text",{class:"detail-label"},"会话ID",-1)),e("text",Zt,a(t.log.session_id),1)])):x("",!0)])])):x("",!0),t.log.resource_type?(i(),n("view",Kt,[s[16]||(s[16]=e("view",{class:"section-header"},[e("text",{class:"section-title"},"资源信息")],-1)),e("view",Qt,[e("view",Ht,[s[13]||(s[13]=e("text",{class:"detail-label"},"资源类型",-1)),e("text",Gt,a(t.log.resource_type),1)]),t.log.resource_id?(i(),n("view",Wt,[s[14]||(s[14]=e("text",{class:"detail-label"},"资源ID",-1)),e("text",Xt,a(t.log.resource_id),1)])):x("",!0),t.log.resource_name?(i(),n("view",Yt,[s[15]||(s[15]=e("text",{class:"detail-label"},"资源名",-1)),e("text",es,a(t.log.resource_name),1)])):x("",!0)])])):x("",!0),e("view",ts,[s[17]||(s[17]=e("view",{class:"section-header"},[e("text",{class:"section-title"},"消息内容")],-1)),e("view",ss,[e("text",ls,a(t.log.message),1)])]),t.log.error_code||t.log.stack_trace?(i(),n("view",os,[s[20]||(s[20]=e("view",{class:"section-header"},[e("text",{class:"section-title"},"错误信息")],-1)),e("view",as,[t.log.error_code?(i(),n("view",is,[s[18]||(s[18]=e("text",{class:"detail-label"},"错误代码",-1)),e("text",ns,a(t.log.error_code),1)])):x("",!0)]),t.log.stack_trace?(i(),n("view",rs,[s[19]||(s[19]=e("text",{class:"stack-label"},"堆栈跟踪",-1)),e("view",us,[e("text",cs,a(t.log.stack_trace),1)])])):x("",!0)])):x("",!0),t.log.request_id||t.log.correlation_id||t.log.user_agent?(i(),n("view",ds,[s[24]||(s[24]=e("view",{class:"section-header"},[e("text",{class:"section-title"},"请求详情")],-1)),e("view",vs,[t.log.request_id?(i(),n("view",gs,[s[21]||(s[21]=e("text",{class:"detail-label"},"请求ID",-1)),e("text",ps,a(t.log.request_id),1)])):x("",!0),t.log.correlation_id?(i(),n("view",_s,[s[22]||(s[22]=e("text",{class:"detail-label"},"关联ID",-1)),e("text",fs,a(t.log.correlation_id),1)])):x("",!0),t.log.user_agent?(i(),n("view",ms,[s[23]||(s[23]=e("text",{class:"detail-label"},"用户代理",-1)),e("text",bs,a(t.log.user_agent),1)])):x("",!0)])])):x("",!0),t.log.details&&Object.keys(t.log.details).length>0?(i(),n("view",hs,[e("view",ws,[s[25]||(s[25]=e("text",{class:"section-title"},"详细信息",-1)),e("button",{class:"toggle-json",onClick:s[0]||(s[0]=U=>y.value=!y.value)},[e("text",null,a(y.value?"格式化视图":"JSON视图"),1)])]),y.value?(i(),n("view",ks,[e("view",Cs,[e("text",Ss,a(JSON.stringify(t.log.details,null,2)),1)])])):(i(),n("view",ys,[(i(!0),n(B,null,j(t.log.details,(U,R)=>(i(),n("view",{key:R,class:"detail-item"},[e("text",$s,a(H(R)),1),e("text",xs,a(T(U)),1)]))),128))]))])):x("",!0)])):x("",!0)]),_:1},8,["visible"]))}}),Is=ae(Ps,[["__scopeId","data-v-e4b405eb"]]),Ls={class:"export-form"},Os={class:"form-section"},Es={class:"format-options"},Fs=["value"],Ms={class:"format-info"},Rs={class:"format-name"},zs={class:"format-desc"},As={class:"format-icon"},Bs={class:"form-section"},js={class:"date-range-options"},Ns={class:"quick-ranges"},Vs=["onClick"],qs={class:"custom-range"},Us={class:"range-inputs"},Js={class:"date-input"},Zs={class:"date-picker"},Ks={class:"date-input"},Qs={class:"date-picker"},Hs={class:"form-section"},Gs={class:"filter-options"},Ws={class:"filter-row"},Xs={class:"filter-group"},Ys={class:"checkbox-group"},el=["value"],tl={class:"checkbox-content"},sl={class:"filter-group"},ll={class:"checkbox-group"},ol=["value"],al={class:"form-section"},il={class:"export-options"},nl={class:"option-item"},rl={class:"option-item"},ul={class:"option-item"},cl={class:"max-entries"},dl={class:"form-section"},vl={class:"preview-info"},gl={class:"preview-item"},pl={class:"preview-value"},_l={class:"preview-item"},fl={class:"preview-value"},ml={class:"preview-item"},bl={class:"preview-value"},hl={key:0,class:"applied-filters"},wl={class:"filter-tags"},yl={class:"modal-actions"},$l=["disabled"],xl=["disabled"],kl=["disabled"],Cl=oe({__name:"LogExportModal",props:{visible:{type:Boolean},filters:{}},emits:["close","export"],setup(D,{emit:F}){const v=D,f=F,y=w(!1),k=w("json"),m=w("last_7_days"),u=w(""),o=w(""),r=w(["info","warn","error","critical"]),b=w([]),S=w(!0),Z=w(!0),H=w(!1),T=w(1e4),z=[{value:"json",label:"JSON",description:"结构化数据格式，适合程序处理",icon:"📄"},{value:"csv",label:"CSV",description:"逗号分隔值，适合Excel处理",icon:"📊"},{value:"xlsx",label:"Excel",description:"Excel工作簿格式",icon:"📈"}],V=[{value:"last_hour",label:"最近1小时"},{value:"last_24_hours",label:"最近24小时"},{value:"last_7_days",label:"最近7天"},{value:"last_30_days",label:"最近30天"},{value:"custom",label:"自定义时间"}],P=[{value:"debug",label:"调试",color:"#6b7280"},{value:"info",label:"信息",color:"#3b82f6"},{value:"warn",label:"警告",color:"#f59e0b"},{value:"error",label:"错误",color:"#ef4444"},{value:"critical",label:"严重",color:"#dc2626"}],q=[{value:"auth",label:"认证"},{value:"user",label:"用户"},{value:"customer",label:"客户"},{value:"product",label:"产品"},{value:"quote",label:"报价"},{value:"system",label:"系统"},{value:"security",label:"安全"},{value:"api",label:"API"},{value:"data",label:"数据"},{value:"export",label:"导出"}],J=L(()=>{let g=1e3;m.value==="last_hour"?g=50:m.value==="last_24_hours"?g=200:m.value==="last_7_days"?g=800:m.value==="last_30_days"&&(g=1500);const l=r.value.length/P.length;if(g=Math.floor(g*l),b.value.length>0){const I=b.value.length/q.length;g=Math.floor(g*I)}return T.value&&g>T.value&&(g=T.value),Math.max(0,g)}),t=L(()=>{const g=k.value==="json"?800:k.value==="csv"?300:500,l=J.value*g;return l<1024?`${l} B`:l<1024*1024?`${(l/1024).toFixed(1)} KB`:`${(l/(1024*1024)).toFixed(1)} MB`}),s=L(()=>{const g=new Date().toISOString().split("T")[0];return`logs_${m.value==="custom"?`${u.value}_${o.value}`:m.value}_${g}.${k.value}${H.value?".zip":""}`}),U=L(()=>r.value.length<P.length||b.value.length>0||u.value||o.value),R=L(()=>{const g=[];if(r.value.length<P.length){const l=r.value.map(I=>{var p;return(p=P.find(O=>O.value===I))==null?void 0:p.label}).join(", ");g.push({key:"levels",label:"级别",value:l})}if(b.value.length>0){const l=b.value.map(I=>{var p;return(p=q.find(O=>O.value===I))==null?void 0:p.label}).join(", ");g.push({key:"categories",label:"分类",value:l})}if(u.value||o.value){const l=`${u.value||"开始"} - ${o.value||"结束"}`;g.push({key:"date",label:"时间",value:l})}return g});function G(g){m.value=g;const l=new Date,I=l.toISOString().split("T")[0];switch(g){case"last_hour":u.value=new Date(l.getTime()-60*60*1e3).toISOString().split("T")[0],o.value=I;break;case"last_24_hours":u.value=new Date(l.getTime()-24*60*60*1e3).toISOString().split("T")[0],o.value=I;break;case"last_7_days":u.value=new Date(l.getTime()-7*24*60*60*1e3).toISOString().split("T")[0],o.value=I;break;case"last_30_days":u.value=new Date(l.getTime()-30*24*60*60*1e3).toISOString().split("T")[0],o.value=I;break}}function W(g){u.value=g.detail.value,m.value="custom"}function X(g){o.value=g.detail.value,m.value="custom"}function ie(){ee(),uni.showModal({title:"导出预览",content:`格式: ${k.value.toUpperCase()}
预计条目: ${J.value}
文件大小: ${t.value}
文件名: ${s.value}`,showCancel:!1,confirmText:"确定"})}function Y(){y.value=!0;const g=ee();setTimeout(()=>{y.value=!1,f("export",g),uni.showToast({title:"导出完成",icon:"success"}),f("close")},2e3)}function ee(){const g={};return r.value.length<P.length&&(g.level=r.value),b.value.length>0&&(g.category=b.value),u.value&&(g.date_from=u.value+"T00:00:00Z"),o.value&&(g.date_to=o.value+"T23:59:59Z"),{format:k.value,filters:Object.keys(g).length>0?g:void 0,include_details:S.value,date_range:u.value&&o.value?{start:u.value+"T00:00:00Z",end:o.value+"T23:59:59Z"}:void 0,max_entries:T.value||void 0}}return ye(()=>{v.filters&&(v.filters.level&&(r.value=v.filters.level),v.filters.category&&(b.value=v.filters.category),v.filters.date_from&&(u.value=v.filters.date_from.split("T")[0]),v.filters.date_to&&(o.value=v.filters.date_to.split("T")[0]))}),we([u,o],()=>{V.some(l=>l.value==="custom"?!1:(G(l.value),u.value===u.value&&o.value===o.value))||(m.value="custom")}),(g,l)=>{const I=$e("picker");return i(),pe(xe,{visible:g.visible,title:"导出日志",width:"600px",onClose:l[8]||(l[8]=p=>g.$emit("close"))},{footer:E(()=>[e("view",yl,[e("button",{class:"preview-btn",onClick:ie,disabled:y.value},l[27]||(l[27]=[e("text",null,"预览",-1)]),8,$l),e("button",{class:"export-btn",onClick:Y,disabled:y.value||J.value===0},[e("text",null,a(y.value?"导出中...":"导出"),1)],8,xl),e("button",{class:"cancel-btn",onClick:l[7]||(l[7]=p=>g.$emit("close")),disabled:y.value},l[28]||(l[28]=[e("text",null,"取消",-1)]),8,kl)])]),default:E(()=>[e("view",Ls,[e("view",Os,[l[9]||(l[9]=e("text",{class:"section-title"},"导出格式",-1)),e("view",Es,[(i(),n(B,null,j(z,p=>e("label",{key:p.value,class:N(["format-option",{active:k.value===p.value}])},[Q(e("input",{type:"radio",value:p.value,"onUpdate:modelValue":l[0]||(l[0]=O=>k.value=O),class:"format-radio"},null,8,Fs),[[Ue,k.value]]),e("view",Ms,[e("text",Rs,a(p.label),1),e("text",zs,a(p.description),1)]),e("text",As,a(p.icon),1)],2)),64))])]),e("view",Bs,[l[12]||(l[12]=e("text",{class:"section-title"},"时间范围",-1)),e("view",js,[e("view",Ns,[(i(),n(B,null,j(V,p=>e("button",{key:p.value,class:N(["quick-range",{active:m.value===p.value}]),onClick:O=>G(p.value)},[e("text",null,a(p.label),1)],10,Vs)),64))]),e("view",qs,[e("view",Us,[e("view",Js,[l[10]||(l[10]=e("text",{class:"input-label"},"开始时间",-1)),K(I,{mode:"date",value:u.value,onChange:W},{default:E(()=>[e("view",Zs,a(u.value||"选择开始日期"),1)]),_:1},8,["value"])]),e("view",Ks,[l[11]||(l[11]=e("text",{class:"input-label"},"结束时间",-1)),K(I,{mode:"date",value:o.value,onChange:X},{default:E(()=>[e("view",Qs,a(o.value||"选择结束日期"),1)]),_:1},8,["value"])])])])])]),e("view",Hs,[l[15]||(l[15]=e("text",{class:"section-title"},"筛选条件",-1)),e("view",Gs,[e("view",Ws,[e("view",Xs,[l[13]||(l[13]=e("text",{class:"filter-label"},"日志级别",-1)),e("view",Ys,[(i(),n(B,null,j(P,p=>e("label",{key:p.value,class:"checkbox-item"},[Q(e("input",{type:"checkbox",value:p.value,"onUpdate:modelValue":l[1]||(l[1]=O=>r.value=O)},null,8,el),[[re,r.value]]),e("view",tl,[e("view",{class:"level-dot",style:le({backgroundColor:p.color})},null,4),e("text",null,a(p.label),1)])])),64))])]),e("view",sl,[l[14]||(l[14]=e("text",{class:"filter-label"},"分类",-1)),e("view",ll,[(i(),n(B,null,j(q,p=>e("label",{key:p.value,class:"checkbox-item"},[Q(e("input",{type:"checkbox",value:p.value,"onUpdate:modelValue":l[2]||(l[2]=O=>b.value=O)},null,8,ol),[[re,b.value]]),e("text",null,a(p.label),1)])),64))])])])])]),e("view",al,[l[21]||(l[21]=e("text",{class:"section-title"},"导出选项",-1)),e("view",il,[e("label",nl,[Q(e("input",{type:"checkbox","onUpdate:modelValue":l[3]||(l[3]=p=>S.value=p)},null,512),[[re,S.value]]),l[16]||(l[16]=e("view",{class:"option-content"},[e("text",{class:"option-title"},"包含详细信息"),e("text",{class:"option-desc"},"导出日志的完整详细信息和元数据")],-1))]),e("label",rl,[Q(e("input",{type:"checkbox","onUpdate:modelValue":l[4]||(l[4]=p=>Z.value=p)},null,512),[[re,Z.value]]),l[17]||(l[17]=e("view",{class:"option-content"},[e("text",{class:"option-title"},"包含堆栈跟踪"),e("text",{class:"option-desc"},"对于错误日志，包含完整的堆栈跟踪信息")],-1))]),e("label",ul,[Q(e("input",{type:"checkbox","onUpdate:modelValue":l[5]||(l[5]=p=>H.value=p)},null,512),[[re,H.value]]),l[18]||(l[18]=e("view",{class:"option-content"},[e("text",{class:"option-title"},"压缩文件"),e("text",{class:"option-desc"},"将导出文件压缩为ZIP格式")],-1))])]),e("view",cl,[l[19]||(l[19]=e("text",{class:"input-label"},"最大条目数",-1)),Q(e("input",{type:"number","onUpdate:modelValue":l[6]||(l[6]=p=>T.value=p),min:"1",max:"100000",placeholder:"10000",class:"number-input"},null,512),[[ge,T.value,void 0,{number:!0}]]),l[20]||(l[20]=e("text",{class:"input-hint"},"留空表示导出所有匹配的日志",-1))])]),e("view",dl,[l[26]||(l[26]=e("text",{class:"section-title"},"导出预览",-1)),e("view",vl,[e("view",gl,[l[22]||(l[22]=e("text",{class:"preview-label"},"预计条目数",-1)),e("text",pl,a(J.value)+" 条",1)]),e("view",_l,[l[23]||(l[23]=e("text",{class:"preview-label"},"文件大小",-1)),e("text",fl,"约 "+a(t.value),1)]),e("view",ml,[l[24]||(l[24]=e("text",{class:"preview-label"},"文件名",-1)),e("text",bl,a(s.value),1)])]),U.value?(i(),n("view",hl,[l[25]||(l[25]=e("text",{class:"filters-title"},"应用的筛选条件:",-1)),e("view",wl,[(i(!0),n(B,null,j(R.value,p=>(i(),n("view",{key:p.key,class:"filter-tag"},[e("text",null,a(p.label)+": "+a(p.value),1)]))),128))])])):x("",!0)])])]),_:1},8,["visible"])}}}),Sl=ae(Cl,[["__scopeId","data-v-8a8dd58d"]]),Tl={class:"logs-page"},Dl={class:"page-header"},Pl={class:"header-left"},Il={key:0,class:"stats-summary"},Ll={class:"stat-item"},Ol={class:"stat-item error-count"},El={class:"stat-item security-count"},Fl={class:"header-actions"},Ml={class:"refresh-text"},Rl=["disabled"],zl={class:"filters-section"},Al={class:"filter-row"},Bl={class:"search-container"},jl={class:"quick-filters"},Nl=["onClick"],Vl={class:"toggle-icon"},ql={key:0,class:"advanced-filters"},Ul={class:"filter-group"},Jl={class:"picker-display"},Zl={class:"filter-group"},Kl={class:"picker-display"},Ql={class:"filter-group"},Hl={class:"date-range"},Gl={class:"date-picker"},Wl={class:"date-picker"},Xl={key:0,class:"stats-cards"},Yl={class:"stat-card"},eo={class:"level-stats"},to={class:"level-name"},so={class:"level-count"},lo={class:"stat-card"},oo={class:"user-stats"},ao={class:"user-name"},io={class:"user-count"},no={class:"stat-card"},ro={class:"error-stats"},uo={class:"error-code"},co={class:"error-count"},vo={class:"error-time"},go={key:1,class:"loading-container"},po={key:2,class:"error-container"},_o={class:"error-text"},fo={key:3,class:"logs-table-container"},mo={key:0,class:"user-info"},bo={class:"user-name"},ho={class:"user-role"},wo={key:1,class:"system-user"},yo={class:"action-info"},$o={class:"category"},xo={class:"action"},ko={key:0,class:"resource-info"},Co={class:"resource-name"},So={class:"resource-type"},To={key:1,class:"no-resource"},Do={class:"time-info"},Po={class:"time"},Io={class:"date"},Lo={class:"row-actions"},Oo=["onClick"],Eo=["onClick"],Fo={key:4,class:"pagination-container"},Mo=oe({__name:"index",setup(D){const F=Qe(),{checkPermission:v}=Ze(),f=w(""),y=w(!1),k=w(null),m=w(!1),u=w(!1),o=w([]),r=w([]),b=w(""),S=w(""),Z=["critical","error","warn","info"],{logs:H,statistics:T,loading:z,error:V,currentPage:P,pageSize:q,totalEntries:J,totalPages:t,hasLogs:s,filteredLogs:U,currentFilter:R,autoRefresh:G,fetchLogs:W,fetchStatistics:X,searchLogs:ie,applyFilter:Y,clearFilter:ee,changePage:g,exportLogs:l,startAutoRefresh:I,stopAutoRefresh:p,getLogLevelColor:O,getLogLevelText:c,getCategoryText:C,getActionText:M}=F,te=L(()=>{const $=(P.value-1)*q.value,d=$+q.value;return U.value.slice($,d)}),ue=L(()=>[{value:"auth",label:"认证"},{value:"user",label:"用户"},{value:"customer",label:"客户"},{value:"product",label:"产品"},{value:"quote",label:"报价"},{value:"system",label:"系统"},{value:"security",label:"安全"},{value:"api",label:"API"},{value:"data",label:"数据"},{value:"export",label:"导出"}]),ce=L(()=>[{value:"create",label:"创建"},{value:"read",label:"查看"},{value:"update",label:"更新"},{value:"delete",label:"删除"},{value:"login",label:"登录"},{value:"logout",label:"登出"},{value:"approve",label:"批准"},{value:"reject",label:"拒绝"},{value:"export",label:"导出"}]),ke=[{key:"level",title:"级别",width:"80px",slot:!0},{key:"timestamp",title:"时间",width:"150px",slot:!0},{key:"user",title:"用户",width:"120px",slot:!0},{key:"action",title:"操作",width:"120px",slot:!0},{key:"resource",title:"资源",width:"150px",slot:!0},{key:"message",title:"消息",flex:1},{key:"actions",title:"操作",width:"120px",slot:!0}];function Ce($){var d;return((d=R.value.level)==null?void 0:d.includes($))||!1}function Se($){const d=R.value.level||[];let A;d.includes($)?A=d.filter(_=>_!==$):A=[...d,$],Y({...R.value,level:A.length?A:void 0})}function Te(){ne&&clearTimeout(ne),ne=setTimeout(()=>{ie(f.value)},500)}let ne=null;function De($){const d=$.detail.value;o.value=d.map(A=>ue.value[A].value)}function Pe($){const d=$.detail.value;r.value=d.map(A=>ce.value[A].value)}function Ie($){b.value=$.detail.value}function Le($){S.value=$.detail.value}function Oe(){const $={...R.value,category:o.value.length?o.value:void 0,action:r.value.length?r.value:void 0,date_from:b.value||void 0,date_to:S.value||void 0};Y($),y.value=!1}function Ee(){o.value=[],r.value=[],b.value="",S.value="",f.value="",ee()}function _e(){W(R.value),X()}function Fe(){G.value?p():I()}function Me($){fe($)}function fe($){k.value=$,m.value=!0}function Re(){m.value=!1,k.value=null}function me($){uni.showModal({title:"处理错误",content:"确认要将此错误标记为已处理吗？",success:d=>{d.confirm&&uni.showToast({title:"错误已标记为已处理",icon:"success"})}})}function be(){u.value=!0}function ze(){u.value=!1}function Ae($){g($)}function Be($){q.value=$,P.value=1,W(R.value)}function he($){return new Date($).toLocaleTimeString("zh-CN")}function je($){return new Date($).toLocaleDateString("zh-CN")}return ye(async()=>{if(!v.canPerformAction("read","logs")){uni.showToast({title:"权限不足",icon:"none"}),uni.navigateBack();return}await Promise.all([W(),X()])}),Je(()=>{p(),ne&&clearTimeout(ne)}),uni.setNavigationBarTitle({title:"操作日志"}),($,d)=>{const A=$e("picker");return i(),n("view",Tl,[e("view",Dl,[e("view",Pl,[d[2]||(d[2]=e("text",{class:"page-title"},"操作日志",-1)),h(T)?(i(),n("view",Il,[e("text",Ll,"总计: "+a(h(T).total_entries),1),e("text",Ol,"错误: "+a(h(T).entries_by_level.error+h(T).entries_by_level.critical),1),e("text",El,"安全事件: "+a(h(T).security_events),1)])):x("",!0)]),e("view",Fl,[K(Ke),e("view",{class:N(["refresh-toggle",{active:h(G)}]),onClick:Fe},[d[3]||(d[3]=e("text",{class:"refresh-icon"},"🔄",-1)),e("text",Ml,a(h(G)?"自动刷新":"手动刷新"),1)],2),e("button",{class:"export-btn",onClick:be},d[4]||(d[4]=[e("text",null,"导出日志",-1)])),e("button",{class:"refresh-btn",onClick:_e,disabled:h(z)},[e("text",null,a(h(z)?"刷新中...":"刷新"),1)],8,Rl)])]),e("view",zl,[e("view",Al,[e("view",Bl,[Q(e("input",{"onUpdate:modelValue":d[0]||(d[0]=_=>f.value=_),placeholder:"搜索日志内容、用户、资源...",class:"search-input",onInput:Te},null,544),[[ge,f.value]]),d[5]||(d[5]=e("text",{class:"search-icon"},"🔍",-1))]),e("view",jl,[(i(),n(B,null,j(Z,_=>e("button",{key:_,class:N(["quick-filter",{active:Ce(_)}]),onClick:se=>Se(_)},[e("view",{class:"filter-dot",style:le({backgroundColor:h(O)(_)})},null,4),e("text",null,a(h(c)(_)),1)],10,Nl)),64))]),e("button",{class:"advanced-toggle",onClick:d[1]||(d[1]=_=>y.value=!y.value)},[d[6]||(d[6]=e("text",null,"高级筛选",-1)),e("text",Vl,a(y.value?"▼":"▶"),1)])]),y.value?(i(),n("view",ql,[e("view",Ul,[d[7]||(d[7]=e("text",{class:"filter-label"},"分类",-1)),K(A,{mode:"multiSelector",range:ue.value,"range-key":"label",onChange:De},{default:E(()=>[e("view",Jl,a(o.value.length?`已选择 ${o.value.length} 个分类`:"选择分类"),1)]),_:1},8,["range"])]),e("view",Zl,[d[8]||(d[8]=e("text",{class:"filter-label"},"操作",-1)),K(A,{mode:"multiSelector",range:ce.value,"range-key":"label",onChange:Pe},{default:E(()=>[e("view",Kl,a(r.value.length?`已选择 ${r.value.length} 个操作`:"选择操作"),1)]),_:1},8,["range"])]),e("view",Ql,[d[10]||(d[10]=e("text",{class:"filter-label"},"时间范围",-1)),e("view",Hl,[K(A,{mode:"date",value:b.value,onChange:Ie},{default:E(()=>[e("view",Gl,a(b.value||"开始日期"),1)]),_:1},8,["value"]),d[9]||(d[9]=e("text",{class:"date-separator"},"至",-1)),K(A,{mode:"date",value:S.value,onChange:Le},{default:E(()=>[e("view",Wl,a(S.value||"结束日期"),1)]),_:1},8,["value"])])]),e("view",{class:"filter-actions"},[e("button",{class:"clear-btn",onClick:Ee},d[11]||(d[11]=[e("text",null,"清除筛选",-1)])),e("button",{class:"apply-btn",onClick:Oe},d[12]||(d[12]=[e("text",null,"应用筛选",-1)]))])])):x("",!0)]),h(T)&&!y.value?(i(),n("view",Xl,[e("view",Yl,[d[13]||(d[13]=e("view",{class:"stat-header"},[e("text",{class:"stat-title"},"日志级别分布")],-1)),e("view",eo,[(i(!0),n(B,null,j(h(T).entries_by_level,(_,se)=>(i(),n("view",{key:se,class:"level-stat"},[e("view",{class:"level-dot",style:le({backgroundColor:h(O)(se)})},null,4),e("text",to,a(h(c)(se)),1),e("text",so,a(_),1)]))),128))])]),e("view",lo,[d[14]||(d[14]=e("view",{class:"stat-header"},[e("text",{class:"stat-title"},"活跃用户")],-1)),e("view",oo,[(i(!0),n(B,null,j(h(T).top_users.slice(0,5),_=>(i(),n("view",{key:_.user_id,class:"user-stat"},[e("text",ao,a(_.user_name),1),e("text",io,a(_.count),1)]))),128))])]),e("view",no,[d[15]||(d[15]=e("view",{class:"stat-header"},[e("text",{class:"stat-title"},"错误摘要")],-1)),e("view",ro,[(i(!0),n(B,null,j(h(T).error_summary,_=>(i(),n("view",{key:_.error_code,class:"error-stat"},[e("text",uo,a(_.error_code),1),e("text",co,a(_.count),1),e("text",vo,a(he(_.last_occurrence)),1)]))),128))])])])):x("",!0),h(z)?(i(),n("view",go,d[16]||(d[16]=[e("text",{class:"loading-text"},"加载日志中...",-1)]))):x("",!0),h(V)?(i(),n("view",po,[e("text",_o,a(h(V)),1),e("button",{class:"retry-btn",onClick:_e},d[17]||(d[17]=[e("text",null,"重试",-1)]))])):x("",!0),!h(z)&&!h(V)?(i(),n("view",fo,[K(ot,{columns:ke,data:te.value,loading:h(z),"empty-text":h(s)?"没有找到匹配的日志":"暂无日志数据",onRowClick:Me},{level:E(({row:_})=>[e("view",{class:N(["level-badge",`level-${_.level}`])},[e("view",{class:"level-dot",style:le({backgroundColor:h(O)(_.level)})},null,4),e("text",null,a(h(c)(_.level)),1)],2)]),user:E(({row:_})=>[_.user_name?(i(),n("view",mo,[e("text",bo,a(_.user_name),1),e("text",ho,a(_.user_role),1)])):(i(),n("text",wo,"系统"))]),action:E(({row:_})=>[e("view",yo,[e("text",$o,a(h(C)(_.category)),1),e("text",xo,a(h(M)(_.action)),1)])]),resource:E(({row:_})=>[_.resource_name?(i(),n("view",ko,[e("text",Co,a(_.resource_name),1),e("text",So,a(_.resource_type),1)])):(i(),n("text",To,"-"))]),timestamp:E(({row:_})=>[e("view",Do,[e("text",Po,a(he(_.timestamp)),1),e("text",Io,a(je(_.timestamp)),1)])]),actions:E(({row:_})=>[e("view",Lo,[e("button",{class:"action-btn view",onClick:ve(se=>fe(_),["stop"])},d[18]||(d[18]=[e("text",null,"详情",-1)]),8,Oo),_.level==="error"||_.level==="critical"?(i(),n("button",{key:0,class:"action-btn resolve",onClick:ve(se=>me(_),["stop"])},d[19]||(d[19]=[e("text",null,"处理",-1)]),8,Eo)):x("",!0)])]),_:1},8,["data","loading","empty-text"])])):x("",!0),!h(z)&&h(s)?(i(),n("view",Fo,[K(ht,{"current-page":h(P),"total-pages":h(t),"total-items":h(J),"page-size":h(q),onPageChange:Ae,onPageSizeChange:Be},null,8,["current-page","total-pages","total-items","page-size"])])):x("",!0),k.value?(i(),pe(Is,{key:5,log:k.value,visible:m.value,onClose:Re,onResolve:me},null,8,["log","visible"])):x("",!0),K(Sl,{visible:be,filters:h(R),onClose:ze,onExport:$.exportLogs},null,8,["filters","onExport"])])}}}),Bo=ae(Mo,[["__scopeId","data-v-6102e2dd"]]);export{Bo as default};

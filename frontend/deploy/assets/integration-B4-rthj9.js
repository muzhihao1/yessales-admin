const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-DqkBhIqL.js","assets/index.standard-DHpxIVC0.js","assets/index-CIRSQFo7.css"])))=>i.map(i=>d[i]);
import{d as Q,r as m,Y as l,_ as R,i as u,o as q,c as n,j as d,a as e,n as v,t as o,F as k,f as T,g as r,b as _}from"./index.standard-DHpxIVC0.js";import{u as B}from"./app-DqkBhIqL.js";import{a as M,S as L}from"./SalesButton-Bck0Vs7e.js";import{L as E}from"./LoadingSkeleton-DpDZhGq1.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"integration-test-page"},J={class:"test-container"},U={class:"test-overview"},Y={class:"stat-number"},G={class:"test-stat-card success"},K={class:"stat-number"},W={class:"test-stat-card error"},X={class:"stat-number"},Z={class:"test-controls"},tt={class:"test-results"},st={class:"test-section"},et={class:"test-info"},at={class:"test-name"},ot={class:"test-description"},nt={class:"test-status"},rt={class:"status-icon"},it={class:"status-text"},ct={key:0,class:"test-error"},lt={class:"error-message"},ut={key:1,class:"test-result"},dt={class:"result-data"},pt={class:"test-section"},ht={class:"test-info"},mt={class:"test-name"},vt={class:"test-description"},_t={class:"test-status"},wt={class:"status-icon"},gt={class:"status-text"},ft={key:0,class:"test-error"},yt={class:"error-message"},St={class:"test-section"},xt={class:"test-info"},kt={class:"test-name"},Tt={class:"test-description"},Et={class:"test-status"},At={class:"status-icon"},bt={class:"status-text"},Pt={key:0,class:"test-error"},Ft={class:"error-message"},It={class:"test-section"},Ct={class:"component-showcase"},Bt={class:"showcase-item"},Lt={class:"showcase-item"},Vt={class:"showcase-item"},$t=Q({__name:"integration",setup(Ht){const p=m(!1),i=B(),A=m([{name:"API服务导入",description:"验证ApiService能够正确导入",status:"pending",async testFn(){if(typeof l!="object")throw new Error("ApiService导入失败");if(typeof l.getProducts!="function")throw new Error("getProducts方法不存在");if(typeof l.getSalesStats!="function")throw new Error("getSalesStats方法不存在");this.result={importSuccess:!0,methods:["getProducts","getSalesStats","getQuotes"]}}},{name:"产品数据获取",description:"测试产品API数据获取功能",status:"pending",async testFn(){var s,a;try{const t=await l.getProducts({limit:3});if(this.result={success:t.success,hasData:!!t.data,dataLength:((s=t.data)==null?void 0:s.length)||0,errorCode:(a=t.error)==null?void 0:a.code},!t.success&&!t.error)throw new Error("API响应格式异常");if(t.success&&t.data&&t.data.length>0){const S=t.data[0],x=["id","name","model","price","unit"];for(const h of x)if(!(h in S))throw new Error(`产品数据缺少必需字段: ${h}`)}}catch(t){throw this.result={networkError:!0,message:t.message},t}}},{name:"统计数据获取",description:"测试销售统计API功能",status:"pending",async testFn(){var s,a;try{const t=await l.getSalesStats();if(this.result={success:t.success,hasStats:!!t.data,hasTotalQuotes:((s=t.data)==null?void 0:s.totalQuotes)!==void 0,errorCode:(a=t.error)==null?void 0:a.code},!t.success&&!t.error)throw new Error("统计API响应格式异常")}catch(t){throw this.result={networkError:!0,message:t.message},t}}},{name:"健康检查",description:"测试API健康检查功能",status:"pending",async testFn(){var a,t;if(typeof l.healthCheck!="function"){const{checkApiHealth:S}=await R(async()=>{const{checkApiHealth:h}=await import("./app-DqkBhIqL.js").then(j=>j.i);return{checkApiHealth:h}},__vite__mapDeps([0,1,2])),x=await S();this.result={healthy:x,method:"checkApiHealth (fallback)"};return}const s=await l.healthCheck();this.result={success:s.success,status:(a=s.data)==null?void 0:a.status,services:(t=s.data)==null?void 0:t.services}}}]),b=m([{name:"Store导入",description:"验证useAppStore能够正确导入和初始化",status:"pending",async testFn(){if(typeof B!="function")throw new Error("useAppStore导入失败");if(!i)throw new Error("appStore实例化失败");const s=["updateSettings","loadSettings"];for(const a of s)if(typeof i[a]!="function")throw new Error(`Store缺少方法: ${a}`);this.result={storeInstance:!!i,methods:s,hasSettings:"settings"in i}}},{name:"设置读取",description:"测试设置数据的读取功能",status:"pending",async testFn(){try{i.loadSettings(),this.result={settingsLoaded:!0,settingsType:typeof i.settings,hasAutoSave:"autoSave"in i.settings}}catch(s){throw new Error(`设置读取失败: ${s.message}`)}}},{name:"设置更新",description:"测试设置数据的更新功能",status:"pending",async testFn(){try{const s={testValue:`test_${Date.now()}`};i.updateSettings(s),this.result={updateSuccess:!0,settingsUpdated:i.settings.testValue===s.testValue}}catch(s){throw new Error(`设置更新失败: ${s.message}`)}}}]),P=m([{name:"LoadingSkeleton组件",description:"验证LoadingSkeleton组件能够正确导入和使用",status:"pending",async testFn(){this.result={componentImported:!0,variants:["product","list","stats","card","form"]}}},{name:"动画样式",description:"验证animations.scss样式文件能够正确导入",status:"pending",async testFn(){const s=document.createElement("div");s.className="fade-enter-active",document.body.appendChild(s);const a=window.getComputedStyle(s),t=a.transitionProperty!=="none";if(document.body.removeChild(s),this.result={animationStylesLoaded:t,transitionProperty:a.transitionProperty},!t)throw new Error("动画样式未正确加载")}},{name:"Sales组件集成",description:"验证Sales系列组件能够正确导入",status:"pending",async testFn(){this.result={salesHeaderImported:!0,salesButtonImported:!0}}}]),c=u(()=>[...A.value,...b.value,...P.value]),w=u(()=>c.value.length),F=u(()=>c.value.filter(s=>s.status!=="pending"&&s.status!=="running").length),I=u(()=>c.value.filter(s=>s.status==="passed").length),g=u(()=>c.value.filter(s=>s.status==="failed").length),C=u(()=>F.value===w.value&&g.value===0),V=u(()=>g.value>0);async function $(){if(!p.value){p.value=!0;try{c.value.forEach(s=>{s.status="pending",s.result=void 0,s.error=void 0});for(const s of c.value){s.status="running";try{await s.testFn.call(s),s.status="passed"}catch(a){s.status="failed",s.error=a.message}await new Promise(a=>setTimeout(a,100))}uni.showToast({title:`测试完成: ${I.value}/${w.value} 通过`,icon:C.value?"success":"none",duration:3e3})}finally{p.value=!1}}}function H(){c.value.forEach(s=>{s.status="pending",s.result=void 0,s.error=void 0})}function f(s){switch(s){case"pending":return"⏳";case"running":return"⚡";case"passed":return"✅";case"failed":return"❌";default:return"❓"}}function y(s){switch(s){case"pending":return"等待中";case"running":return"运行中";case"passed":return"通过";case"failed":return"失败";default:return"未知"}}function N(s){return typeof s=="object"?JSON.stringify(s,null,2):String(s)}function D(){uni.navigateBack()}return q(()=>{uni.setNavigationBarTitle({title:"Terminal 2 集成测试"})}),(s,a)=>(r(),n("view",z,[d(M,{title:"集成测试页面","show-back":!0,onBack:D}),e("view",J,[a[11]||(a[11]=e("view",{class:"test-header"},[e("text",{class:"test-title"},"Terminal 2 集成测试"),e("text",{class:"test-subtitle"},"验证与Terminal 1基础设施的集成")],-1)),e("view",U,[e("view",{class:v(["test-stat-card",{success:C.value,error:V.value}])},[e("text",Y,o(F.value)+"/"+o(w.value),1),a[0]||(a[0]=e("text",{class:"stat-label"},"测试完成",-1))],2),e("view",G,[e("text",K,o(I.value),1),a[1]||(a[1]=e("text",{class:"stat-label"},"通过",-1))]),e("view",W,[e("text",X,o(g.value),1),a[2]||(a[2]=e("text",{class:"stat-label"},"失败",-1))])]),e("view",Z,[d(L,{text:"运行所有测试",type:"primary",loading:p.value,onClick:$},null,8,["loading"]),d(L,{text:"清除结果",type:"outline",onClick:H})]),e("view",tt,[e("view",st,[a[4]||(a[4]=e("text",{class:"section-title"},"🔗 API服务集成测试",-1)),(r(!0),n(k,null,T(A.value,t=>(r(),n("view",{key:t.name,class:v(["test-item",t.status])},[e("view",et,[e("text",at,o(t.name),1),e("text",ot,o(t.description),1)]),e("view",nt,[e("text",rt,o(f(t.status)),1),e("text",it,o(y(t.status)),1)]),t.error?(r(),n("view",ct,[e("text",lt,o(t.error),1)])):_("",!0),t.result?(r(),n("view",ut,[a[3]||(a[3]=e("text",{class:"result-label"},"结果:",-1)),e("text",dt,o(N(t.result)),1)])):_("",!0)],2))),128))]),e("view",pt,[a[5]||(a[5]=e("text",{class:"section-title"},"🗂️ Store状态管理测试",-1)),(r(!0),n(k,null,T(b.value,t=>(r(),n("view",{key:t.name,class:v(["test-item",t.status])},[e("view",ht,[e("text",mt,o(t.name),1),e("text",vt,o(t.description),1)]),e("view",_t,[e("text",wt,o(f(t.status)),1),e("text",gt,o(y(t.status)),1)]),t.error?(r(),n("view",ft,[e("text",yt,o(t.error),1)])):_("",!0)],2))),128))]),e("view",St,[a[6]||(a[6]=e("text",{class:"section-title"},"🧩 组件依赖测试",-1)),(r(!0),n(k,null,T(P.value,t=>(r(),n("view",{key:t.name,class:v(["test-item",t.status])},[e("view",xt,[e("text",kt,o(t.name),1),e("text",Tt,o(t.description),1)]),e("view",Et,[e("text",At,o(f(t.status)),1),e("text",bt,o(y(t.status)),1)]),t.error?(r(),n("view",Pt,[e("text",Ft,o(t.error),1)])):_("",!0)],2))),128))])]),e("view",It,[a[10]||(a[10]=e("text",{class:"section-title"},"🎨 组件展示测试",-1)),e("view",Ct,[e("view",Bt,[a[7]||(a[7]=e("text",{class:"showcase-label"},"产品骨架屏:",-1)),d(E,{variant:"product","item-count":3,"custom-class":"showcase-skeleton"})]),e("view",Lt,[a[8]||(a[8]=e("text",{class:"showcase-label"},"列表骨架屏:",-1)),d(E,{variant:"list","item-count":2,"custom-class":"showcase-skeleton"})]),e("view",Vt,[a[9]||(a[9]=e("text",{class:"showcase-label"},"统计骨架屏:",-1)),d(E,{variant:"stats","item-count":2,"custom-class":"showcase-skeleton"})])])])])]))}}),qt=O($t,[["__scopeId","data-v-97dae0d6"]]);export{qt as default};
